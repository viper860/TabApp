var Fashion;!function(Fashion){function apply(target,source){if(target=target||{},source)for(var name in source)target[name]=source[name];return target}function merge(destination,object){destination=destination||{};var key,value,sourceKey;if(object)for(key in object)value=object[key],value&&value.constructor===Object?(sourceKey=destination[key],sourceKey&&sourceKey.constructor===Object?merge(sourceKey,value):destination[key]=value):destination[key]=value;return destination}function _chainFunc(){}function createMessage(message,source){return source&&source.isFashionScanner?message+=": "+source.currentFile+":"+source.lineNumber:source&&(message+=": "+source.file+":"+source.lineNumber),message}function isFunction(obj){return obj&&"function"==typeof obj}function debug(message,source){console.log(createMessage("[DBG] "+message,source))}function log(message,source){console.log(createMessage("[LOG] "+message,source))}function info(message,source){console.info(createMessage("[INF] "+message,source))}function warn(message,source){console.warn(createMessage("[WRN] "+message,source))}function error(message,source){console.error(createMessage("[ERR] "+message,source))}function raise(message,extra){throw"string"!=typeof message&&(extra=message,message=extra.message,delete extra.message),apply(Error(message),extra)}function raiseAt(message,source){var extra;source&&(message=createMessage(message,source),extra=source.isFashionScanner?{file:source.currentFile,lineNumber:source.lineNumber}:{node:source,lineNumber:source.lineNumber,file:source.currentFile}),raise(message,extra)}function filter(array,func){for(var result=[],i=0;i<array.length;i++){var item=array[i];func(item,i)&&result.push(item)}return result}function convert(array,func){for(var converted=[],i=0;i<array.length;i++)converted.push(func(array[i]));return converted}function first(array){return array.length&&array[0]}function last(array){return array.length&&array[array.length-1]}function tail(array){return array.length>2?array.slice(1):[]}function mixin(target,bases){Array.isArray(bases)||(bases=Array.prototype.slice.call(arguments,1));for(var proto=target.prototype,b=0;b<bases.length;b++){var base=bases[b],baseProto=base.prototype;for(var name in baseProto)baseProto.hasOwnProperty(name)&&!proto[name]&&(proto[name]=baseProto[name])}}function flatten(array,level,output){output=output||[],level=void 0===level?1e3:level;for(var i=0;i<array.length;i++){var item=array[i];Array.isArray(item)&&level?flatten(item,level-1,output):output.push(item)}return output}"undefined"!=typeof module&&(module.exports=Fashion),"undefined"!=typeof window&&(window.Fashion=Fashion);var Base=function(){function Base(config){config&&merge(this,config)}return Base}();Fashion.Base=Base,Fashion.apply=apply,Fashion.merge=merge,Fashion.chain=Object.create||function(Parent){return _chainFunc.prototype=Parent,new _chainFunc},Fashion.createMessage=createMessage,Fashion.isFunction=isFunction,Fashion.debug=debug,Fashion.log=log,Fashion.info=info,Fashion.warn=warn,Fashion.error=error,Fashion.raise=raise,Fashion.raiseAt=raiseAt,Fashion.filter=filter,Fashion.convert=convert,Fashion.first=first,Fashion.last=last,Fashion.tail=tail;var BaseSet=function(){function BaseSet(){}return BaseSet.prototype.first=function(){return first(this.items)},BaseSet.prototype.last=function(){return last(this.items)},BaseSet.prototype.tail=function(){return tail(this.items)},BaseSet}();Fashion.BaseSet=BaseSet,Fashion.mixin=mixin,Fashion.flatten=flatten,Fashion.EmptyArray=[]}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var Env;!function(Env){function exists(path){try{if(Env.isRhino&&!Env.isPhantom)return new java.io.File(path).exists();if(Env.isPhantom){var fs=require("fs");return fs.exists(path)}return readFile(path),!0}catch(e){return!1}}function join(dir,subpath){return dir+"/"+subpath}function readFileRhino(file){Fashion.raise("function 'Fashion.Env.readFileRhino' has no default implementation")}function readFile(file){if(Env.isRhino)return Fashion.Env.readFileRhino(file);if(Env.isNode){var fs=require("fs");return fs.readFileSync(file)}return doRequest({url:file,async:!1,method:"GET"})}function loadFileRhino(file,success,error){Fashion.raise("function 'Fashion.Env.readFileRhino' has no default implementation")}function loadFile(file,success,error,options,retries){if(Env.isBrowser)retries=retries||0,doRequest(Fashion.merge({url:file,async:!0,params:{_dc:(new Date).getTime()},onComplete:function(options,xhr){success&&success(xhr.responseText,xhr)},onError:function(){3>retries?Fashion.Env.loadFile(file,success,error,options,retries+1):error&&error.apply(error,arguments)}},options));else if(Env.isNode){var fs=require("fs");fs.readFile(file,function(err,data){err&&error?error(err):success(data+"")})}else Env.isRhino&&Fashion.Env.loadFileRhino(file,success,error)}function doRequest(options){var queryParamStr,xhr,content,sep,url=options.url,method=options.method||"GET",data=options.data||null,async=options.async!==!1,onComplete=options.onComplete,onError=options.onError,scope=options.scope||this,params=options.params,queryParams=[],arrayBufferSupported=!1;if(params){for(var name in params)queryParams.push(name+"="+params[name]);queryParamStr=queryParams.join("&"),""!==queryParamStr&&(sep=url.indexOf("?")>-1?"&":"?",url=url+sep+queryParamStr)}return"undefined"!=typeof XMLHttpRequest?(xhr=new XMLHttpRequest,arrayBufferSupported="string"==typeof xhr.responseType):xhr=new ActiveXObject("Microsoft.XMLHTTP"),xhr.open(method,url,async),async&&(xhr.timeout=5e3),options.binary&&(arrayBufferSupported?(xhr.responseType="arraybuffer",xhr.getBinaryData=function(){return new Uint8Array(this.response)}):(xhr.overrideMimeType("text/plain; charset=x-user-defined"),xhr.getBinaryData=function(){return this.responseText})),xhr.onreadystatechange=function(){if(4===xhr.readyState)try{200===xhr.status?onComplete&&onComplete.call(scope,options,xhr):onError&&onError.call(scope,options,xhr)}catch(err){Fashion.error((err.stack||err)+""),onError&&onError.call(scope,options,xhr,err)}finally{}},xhr.onerror=onError,"function"==typeof data&&(data=data()),"string"!=typeof data&&(data=JSON.stringify(data)),xhr.send(data),async?void 0:content=xhr.responseText}Env.isNode="object"==typeof process&&process+""=="[object process]",Env.isPhantom="undefined"!=typeof phantom,Env.isRhino="undefined"!=typeof importPackage,Env.isBrowser=!(Env.isNode||Env.isRhino||Env.isPhantom),Env.canSetPrototype=function(){var a={x:42},b={};try{b.__proto__=a}catch(e){}return 42===b.x}(),Env.exists=exists,Env.join=join,Env.readFileRhino=readFileRhino,Env.readFile=readFile,Env.loadFileRhino=loadFileRhino,Env.loadFile=loadFile,Env.doRequest=doRequest}(Env=Fashion.Env||(Fashion.Env={}))}(Fashion||(Fashion={}));var __extends=this&&this.__extends||function(d,b){function __(){this.constructor=d}for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p]);d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)},Fashion;!function(Fashion){var Visitor=function(_super){function Visitor(config){_super.call(this,config),this.nodeStack=[]}return __extends(Visitor,_super),Visitor.prototype.visitComments=function(docs){for(var d=0;d<docs.length;d++)this.Comment(docs[d])},Visitor.prototype.visitItem=function(obj){obj.docs&&obj.docs.length&&this.visitComments(obj.docs),obj.doVisit(this)},Visitor.prototype.visit=function(obj){for(;obj&&void 0!==obj.visitTarget;)obj=obj.visitTarget;if(obj){if(Array.isArray(obj)){for(var i=0;i<obj.length;i++)this.visit(obj[i]);return}this.nodeStack.push(obj),this.visitItem(obj),this.nodeStack.pop()}},Visitor.prototype.Comment=function(comment){},Visitor.prototype.Each=function(obj){obj.descend(this)},Visitor.prototype.For=function(obj){obj.descend(this)},Visitor.prototype.While=function(obj){obj.descend(this)},Visitor.prototype.Charset=function(obj){obj.descend(this)},Visitor.prototype.Function=function(obj){obj.descend(this)},Visitor.prototype.Ruleset=function(obj){obj.descend(this)},Visitor.prototype.Mixin=function(obj){obj.descend(this)},Visitor.prototype.Block=function(obj){obj.descend(this)},Visitor.prototype.Include=function(obj){obj.descend(this)},Visitor.prototype.Declaration=function(obj){obj.descend(this)},Visitor.prototype.VariableAssignment=function(obj){obj.descend(this)},Visitor.prototype.Assignment=function(obj){obj.descend(this)},Visitor.prototype.If=function(obj){obj.descend(this)},Visitor.prototype.Else=function(obj){obj.descend(this)},Visitor.prototype.Return=function(obj){obj.descend(this)},Visitor.prototype.ParentheticalExpression=function(obj){obj.descend(this)},Visitor.prototype.SelectorPart=function(obj){obj.descend(this)},Visitor.prototype.SelectorProperty=function(obj){obj.descend(this)},Visitor.prototype.CompoundSelector=function(obj){obj.descend(this)},Visitor.prototype.MultiPartSelector=function(obj){obj.descend(this)},Visitor.prototype.SelectorList=function(obj){obj.descend(this)},Visitor.prototype.BinaryExpression=function(obj){obj.descend(this)},Visitor.prototype.UnaryExpression=function(obj){obj.descend(this)},Visitor.prototype.Variable=function(obj){obj.descend(this)},Visitor.prototype.Constant=function(obj){obj.descend(this)},Visitor.prototype.FunctionCall=function(obj){obj.descend(this)},Visitor.prototype.Extend=function(obj){obj.descend(this)},Visitor.prototype.List=function(obj){obj.descend(this)},Visitor.prototype.Warn=function(obj){obj.descend(this)},Visitor.prototype.Import=function(obj){obj.descend(this)},Visitor.prototype.Require=function(obj){obj.descend(this)},Visitor.prototype.Content=function(obj){obj.descend(this)},Visitor.prototype.Debugger=function(obj){obj.descend(this)},Visitor.prototype.Debug=function(obj){obj.descend(this)},Visitor}(Fashion.Base);Fashion.Visitor=Visitor}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var Output=function(_super){function Output(){_super.call(this),this.indentation="",this.isCompressed=!1,this.indentstr="    ",this.splitThreshold=1e6,this.selectorCount=0,this.output=""}return __extends(Output,_super),Output.prototype.space=function(){this.add(" ")},Output.prototype.add=function(text){this.output+=text},Output.prototype.addComment=function(text){this.output+=text},Output.prototype.indent=function(){this.indentation+=this.indentstr},Output.prototype.unindent=function(){this.indentation=this.indentation.substr(this.indentstr.length)},Output.prototype.addln=function(ln){this.output+="\n"+this.indentation+(ln||"")},Output.prototype.addCommentLn=function(ln){ln&&0===ln.indexOf("//")||this.addln(ln)},Output.prototype.get=function(){return this.output},Output.prototype.indentln=function(ln){this.addln(ln),this.indent()},Output.prototype.unindentln=function(ln){this.unindent(),this.addln(ln)},Output.prototype.reset=function(){this.indentation="",this.output=""},Output}(Fashion.Base);Fashion.Output=Output}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var Type=function(){function Type(){this.value=void 0,this.unit=void 0}return Type.prototype.coerce=function(obj){var converted=this.tryCoerce(obj);return converted||obj},Type.prototype.getHash=function(){return this.visitTarget?""+this.visitTarget:""+this},Type.prototype.tryCoerce=function(obj){var me=this;return me.constructor===obj.constructor?obj:me.constructor.tryCoerce?me.constructor.tryCoerce(obj):void 0},Type.prototype.supports=function(prefix){return!1},Type.prototype.operate=function(operation,right){return this.performOperation(operation,this.coerce(right))},Type.prototype.performOperation=function(operation,right){var method=this[operation+"."+right.type]||this[operation];return method||Fashion.raise("Failed to find method for operation "+operation+" on type "+right.type+" with value "+right+"."),Fashion.Type.box(method.call(this,right))},Type.prototype["=="]=function(right){return this.getHash()===right.getHash()},Type.prototype["!="]=function(right){return this.getHash()!==right.getHash()},Type.prototype[">="]=function(right){return this.getHash()>=right.getHash()},Type.prototype["<="]=function(right){return this.getHash()<=right.getHash()},Type.prototype[">"]=function(right){return this.getHash()>right.getHash()},Type.prototype["<"]=function(right){return this.getHash()<right.getHash()},Type.prototype["+"]=function(right){return this.getHash()+right.getHash()},Type.prototype.clone=function(match,replace){return this},Type.prototype.unquote=function(){return this},Type.prototype.toPrefixedString=function(prefix){return""+this},Type.prototype.doVisit=function(visitor){},Type.prototype.descend=function(visitoir){},Type.prototype.hasTag=function(tag,prefix,enable,disable){prefix=prefix||"fashion",enable=enable||RegExp("^\\s*//#\\s*"+prefix+"\\s*\\+?"+tag+"s*$"),disable=disable||RegExp("^\\s*//#\\s*"+prefix+"\\s*\\-"+tag+"\\s*$");var docs=this.docs;if(docs&&docs.length)for(var d=0;d<this.docs.length;d++){var doc=docs[d];if(enable.test(doc))return!0;if(disable.test(doc))return!1}return this.parentNode?this.parentNode.hasTag(tag,prefix,enable,disable):null},Type}();Fashion.Type=Type,Fashion.apply(Type.prototype,{visitTarget:void 0,$isFashionType:!0,$canUnbox:!0})}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var Literal=function(_super){function Literal(value){_super.call(this),this.value=value}return __extends(Literal,_super),Literal.prototype.doVisit=function(visitor){visitor.literal(this)},Literal.prototype.getHash=function(){return this.value},Literal.prototype.toString=function(){return this.value||""},Literal.prototype.toBoolean=function(){return this.value.length},Literal.prototype.clone=function(match,replace){return match&&match===""+this?replace.clone():new Fashion.Literal(this.value)},Literal.prototype["+"]=function(right){return new Fashion.Literal(this.value+right.getHash())},Literal.prototype["+.number"]=function(right){return null===this.value?right:new Fashion.Literal(this.value+(""+right))},Literal.prototype["/"]=function(right){return new Fashion.Literal(this.value+"/"+right.getHash())},Literal.prototype["-"]=function(right){return new Fashion.Literal(this.value+"-"+right.getHash())},Literal.prototype["%"]=function(right){return new Fashion.Literal(this.value+"%"+right.getHash())},Literal.tryCoerce=function(obj){return obj.$isFashionNumber?void 0:obj.$isFashionString?new Fashion.Literal(obj.value):obj.$isFashionLiteral?obj:new Fashion.Literal(obj.getHash())},Literal.prototype.normalizeStart=function(startVal){var start=Fashion.Type.unbox(startVal)||0;return start>0&&(start-=1),0>start&&(start=this.value.length+start),0>start&&(start=0),start},Literal.prototype.normalizeEnd=function(endVal){var end=Fashion.Type.unbox(endVal)||-1;return end>0&&(end-=1),0>end&&(end=this.value.length+end),0>end&&(end=0),end>0&&(end+=1),end},Literal.prototype.slice=function(start,end){return start=this.normalizeStart(start),end=this.normalizeEnd(end),new Fashion.Literal(this.value.slice(start,end))},Literal.prototype.toUpperCase=function(){return new Fashion.Literal(this.value.toUpperCase())},Literal.prototype.toLowerCase=function(){return new Fashion.Literal(this.value.toLowerCase())},Literal.prototype.indexOf=function(str){var idx=this.value.indexOf(str.value);if(-1!==idx)return new Fashion.Numeric(idx+1)},Literal.prototype.insert=function(str,startVal){var start=Fashion.Type.unbox(startVal)||0,inserted=this.value;return start>0&&(start=Math.min(start-1,inserted.length)),0>start&&(start=inserted.length+start+1,start=Math.max(start,0)),inserted=inserted.substring(0,start)+str.value+inserted.substring(start),new Fashion.Literal(Fashion.Literal.deEscape(inserted))},Literal.deEscape=function(str){var i,ch,buff="";for(i=0;i<str.length;i++)ch=str.charAt(i),"\\"===ch&&(i++,ch=str.charAt(i)),buff+=ch;return buff},Literal}(Fashion.Type);Fashion.Literal=Literal;var ParentheticalExpression=function(_super){function ParentheticalExpression(value){_super.call(this),this.type="parenthetical",this.value=value}return __extends(ParentheticalExpression,_super),ParentheticalExpression.prototype.toString=function(){return"("+this.value+")"},ParentheticalExpression.prototype.doVisit=function(visitor){visitor.parenthetical(this)},ParentheticalExpression}(Fashion.Type);Fashion.ParentheticalExpression=ParentheticalExpression,Fashion.apply(Literal.prototype,{type:"literal",$isFashionLiteral:!0}),Fashion.Null=new Literal(null),Fashion.None=new Literal("none")}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var Bool=function(_super){function Bool(value){_super.call(this),this.value=!!value}return __extends(Bool,_super),Bool.prototype.doVisit=function(visitor){visitor.bool(this)},Bool.prototype.toString=function(){return this.value?"true":"false"},Bool.prototype.clone=function(){return new Fashion.Bool(this.value)},Bool}(Fashion.Type);Fashion.Bool=Bool,Fashion.apply(Bool.prototype,{type:"bool",$isFashionBool:!0}),Fashion.True=new Bool(!0),Fashion.False=new Bool(!1)}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var Numeric=function(_super){function Numeric(value,unit,numeratorUnits,denominatorUnits){_super.call(this),this.value=value,this.unit=unit,unit&&!numeratorUnits?this.numeratorUnits=[unit]:this.numeratorUnits=numeratorUnits||[],this.denominatorUnits=denominatorUnits||[]}return __extends(Numeric,_super),Numeric.prototype.doVisit=function(visitor){visitor.number(this)},Numeric.prototype.unitless=function(){return this.numeratorUnits&&this.numeratorUnits.length?!1:!this.denominatorUnits||!this.denominatorUnits.length},Numeric.prototype.getUnitStr=function(){this.normalizeUnits();var unitStr=this.numeratorUnits.join("*");return this.denominatorUnits.length&&(unitStr+="/"+this.denominatorUnits.join("*")),unitStr},Numeric.prototype.getHash=function(){return this.value},Numeric.prototype.stringify=function(){this.normalizeUnits();var valStr,value=this.value;return valStr=Math.round(1e5*value)/1e5+"",valStr+this.getUnitStr()},Numeric.prototype.toString=function(){return this.stringify()},Numeric.prototype.toBoolean=function(){return this.unit?!0:!!this.value},Numeric.prototype.clone=function(){return new Fashion.Numeric(this.value,this.unit)},Numeric.prototype["-.literal"]=function(right){return 0===this.value&&this.unitless()?new Fashion.Literal("-"+right):new Fashion.Literal(""+this+"-"+right)},Numeric.prototype["-.string"]=function(right){return 0===this.value&&this.unitless()?new Fashion.Literal("-"+right):new Fashion.Literal(""+this+"-"+right)},Numeric.prototype["-.number"]=function(right){var value=right.value;return"%"==right.unit&&right.unit!==this.unit&&(value=this.value*(right.value/100)),new Fashion.Numeric(this.value-value,this.unit||right.unit)},Numeric.prototype["+.literal"]=function(right){return right.$isFashionString?new Fashion.Literal(""+this+right.value):new Fashion.Literal(""+this+(""+right))},Numeric.prototype["+.number"]=function(right){var value=right.value;return"%"==right.unit&&right.unit!==this.unit&&(value=this.value*(right.value/100)),new Fashion.Numeric(this.value+value,this.unit||right.unit)},Numeric.prototype["/"]=function(right){return new Fashion.Numeric(this.value/right.value,this.unit==right.unit?null:this.unit||right.unit)},Numeric.prototype["*"]=function(right){return new Fashion.Numeric(this.value*right.value,this.unit||right.unit)},Numeric.prototype["%"]=function(right){return new Fashion.Numeric(this.value%right.value,this.unit||right.unit)},Numeric.prototype["**"]=function(right){return new Fashion.Numeric(Math.pow(this.value,right.value),this.unit||right.unit)},Numeric.prototype.operate=function(operation,right){var normalized,unit=this.unit||right.unit;right.unit||unit;return right.$isFashionRGBA||right.$isFashionHSLA?new Fashion.Literal(this+operation+right):right.$isFashionNumber?this.numericOperate(operation,right):right.$isFashionLiteral&&(normalized=this.tryCoerce(right))?this.performOperation(operation,normalized):Fashion.Type.prototype.operate.call(this,operation,right)},Numeric.prototype.tryNormalize=function(other){var value=other.value,unit=other.unit;if(other.$isFashionNumber)switch(this.unit){case"mm":switch(unit){case"in":return new Fashion.Numeric(25.4*value,"mm");case"cm":return new Fashion.Numeric(2.54*value,"mm")}break;case"cm":switch(unit){case"in":return new Fashion.Numeric(2.54*value,"cm");case"mm":return new Fashion.Numeric(value/10,"cm")}break;case"in":switch(unit){case"mm":return new Fashion.Numeric(value/25.4,"in");case"cm":return new Fashion.Numeric(value/2.54,"in")}break;case"ms":switch(unit){case"s":return new Fashion.Numeric(1e3*value,"ms")}break;case"s":switch(unit){case"ms":return new Fashion.Numeric(value/1e3,"s")}break;case"Hz":switch(unit){case"kHz":return new Fashion.Numeric(1e3*value,"Hz")}break;case"kHz":switch(unit){case"Hz":return new Fashion.Numeric(value/1e3,"kHz")}break;case"%":switch(unit){default:return new Fashion.Numeric(value)}}},Numeric.prototype.normalize=function(other){var norm=this.tryNormalize(other);return void 0===norm&&Fashion.raise("Could not normalize "+this+" with "+other),norm},Numeric.prototype.comparable=function(other){var unit1=this.unit,unit2=other.unit;return other.$isFashionNumber?unit1===unit2||"mm"===unit1&&("in"===unit2||"cm"===unit2)||"cm"===unit1&&("in"===unit2||"mm"===unit2)||"in"===unit1&&("mm"===unit2||"cm"===unit2)||"ms"===unit1&&"s"===unit2||"s"===unit1&&"ms"===unit2||"Hz"===unit1&&"kHz"===unit2||"kHz"===unit1&&"Hz"===unit2:!1},Numeric.prototype.normalizeUnits=function(){if(!this.normalized&&(this.normalized=!0,!this.unitless())){var clean=this.removeCommonUnits(this.numeratorUnits,this.denominatorUnits);clean.num=Fashion.filter(clean.num,function(val){return!!val}),clean.den=Fashion.filter(clean.den,function(val){return!!val}),this.numeratorUnits=clean.num,this.denominatorUnits=clean.den}},Numeric.prototype.numericOperate=function(operation,right){this.normalizeUnits(),right.normalizeUnits();var result,me=this,other=right,ops=Fashion.Numeric.OPERATIONS,moreOps=Fashion.Numeric.NON_COERCE_OPERATIONS,op=ops[operation];if(op)try{me.unitless()?me=me.coerceUnits(other.numeratorUnits,other.denominatorUnits):other=other.coerceUnits(me.numeratorUnits,me.denominatorUnits)}catch(e){if("=="==operation)return Fashion.False;if("!="==operation)return Fashion.True;throw e}else op=moreOps[operation];if(op&&(result=op(me.value,other.value)),"number"==typeof result){var units=this.computeUnits(me,other,operation);return new Numeric(result,units.num.length?units.num[0]:null,units.num,units.den)}return new Fashion.Bool(result)},Numeric.prototype.computeUnits=function(left,right,op){switch(op){case"*":return{num:left.numeratorUnits.slice().concat(right.numeratorUnits),den:left.denominatorUnits.slice().concat(right.denominatorUnits)};case"/":return{num:left.numeratorUnits.slice().concat(right.denominatorUnits),den:left.denominatorUnits.slice().concat(right.numeratorUnits)};default:return{num:left.numeratorUnits,den:left.denominatorUnits}}},Numeric.prototype.coerceUnits=function(units,denominatorUnits){var value=this.value;return this.unitless()||(value=value*this.coercionFactor(this.numeratorUnits,units)/this.coercionFactor(this.denominatorUnits,denominatorUnits)),new Numeric(value,units&&units[0],units,denominatorUnits)},Numeric.prototype.coercionFactor=function(units,otherUnits){var res=this.removeCommonUnits(units,otherUnits),fromUnits=res.num,toUnits=res.den;fromUnits.length===toUnits.length&&this.convertable(fromUnits||toUnits)||Fashion.raise("Incompatible units: "+fromUnits.join("*")+" and "+toUnits.join("*"));for(var i=0;i<fromUnits.length;i++)for(var fromUnit=fromUnits[i],j=0;j<toUnits.length;j++){var toUnit=toUnits[j],factor=this.conversionFactor(fromUnit,toUnit);if(null!==factor)return factor}return 1},Numeric.prototype.conversionFactor=function(fromUnit,toUnit){var cUnits=Fashion.Numeric.CONVERTABLE_UNITS,cTable=Fashion.Numeric.CONVERSION_TABLE,factor=null;return cUnits[fromUnit]&&cUnits[toUnit]&&(factor=cTable[cUnits[fromUnit]][cUnits[toUnit]]),null===factor&&cUnits[toUnit]&&cUnits[fromUnit]&&(factor=1/cTable[cUnits[toUnit]][cUnits[fromUnit]]),factor},Numeric.prototype.convertable=function(units){if(units&&!Array.isArray(units)&&(units=[units]),units&&units.length)for(var convertableUnits=Fashion.Numeric.CONVERTABLE_UNITS,i=0;i<units.length;i++)if(void 0===convertableUnits[units[i]])return!1;return!0},Numeric.prototype.removeCommonUnits=function(numUnits,denUnits){var i,unit,unit,map={},num=[],den=[];for(i=0;i<numUnits.length;i++)unit=numUnits[i],map[unit]=(map[unit]||0)+1;for(i=0;i<denUnits.length;i++)unit=denUnits[i],map[unit]=(map[unit]||0)-1;for(i=0;i<numUnits.length;i++)unit=numUnits[i],map[unit]>0&&(num.push(unit),map[unit]--);for(i=0;i<denUnits.length;i++)unit=denUnits[i],map[unit]<0&&(den.push(unit),map[unit]++);return{num:num,den:den}},Numeric.tryGetNumber=function(value){return/^\d*$/.test(value)&&(value=parseFloat(value)),isNaN(value)?void 0:new Fashion.Numeric(value)},Numeric.tryCoerce=function(obj){return obj.$isFashionNumber?obj:obj.$isFashionLiteral?this.tryGetNumber(obj.value):void 0},Numeric.OPERATIONS={"!=":function(l,r){return l!=r},"+":function(l,r){return l+r},"-":function(l,r){return l-r},"<=":function(l,r){return r>=l},"<":function(l,r){return r>l},">":function(l,r){return l>r},">=":function(l,r){return l>=r},"==":function(l,r){return l==r},"%":function(l,r){return Math.abs(l%r)}},Numeric.NON_COERCE_OPERATIONS={"*":function(l,r){return l*r},"**":function(l,r){return Math.pow(l,r)},"/":function(l,r){return l/r}},Numeric.CONVERTABLE_UNITS={"in":0,cm:1,pc:2,mm:3,pt:4,px:5},Numeric.CONVERSION_TABLE=[[1,2.54,6,25.4,72,96],[null,1,2.36220473,10,28.3464567,37.795276],[null,null,1,4.23333333,12,16],[null,null,null,1,2.83464567,3.7795276],[null,null,null,null,1,1.3333333],[null,null,null,null,null,1]],Numeric}(Fashion.Type);Fashion.Numeric=Numeric,Fashion.apply(Numeric.prototype,{type:"number",$isFashionNumber:!0})}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var Color=function(_super){function Color(){_super.apply(this,arguments)}return __extends(Color,_super),Color.prototype.toBoolean=function(){return Fashion.True},Color.prototype.getRGBA=function(){return this},Color.prototype.getHSLA=function(){return this},Color.prototype.clone=function(){return new Fashion.ColorRGBA(0,0,0,1)},Color.component=function(color,component){var targetColor,unit=Fashion.Color.units[component],type=Fashion.Color.types[component],prop=Fashion.Color.comps[component];return targetColor="hsla"==type?color.getHSLA():color.getRGBA(),new Fashion.Numeric(targetColor[prop],unit)},Color.adjust=function(color,component,amount){var hsl=color.getHSLA().clone(),prop=Fashion.Color.comps[component],value=amount.value;return hsl[prop]+=value,hsl.h=Fashion.Color.constrainDegrees(hsl.h),hsl.s=Fashion.Color.constrainPercentage(hsl.s),hsl.l=Fashion.Color.constrainPercentage(hsl.l),hsl.getRGBA()},Color.constrainChannel=function(channel){return Math.max(0,Math.min(channel,255))},Color.constrainPercentage=function(per){return Math.max(0,Math.min(per,100))},Color.constrainDegrees=function(deg){return deg%=360,0>deg?360+deg:deg},Color.constrainAlpha=function(alpha){return void 0===alpha?1:Math.max(0,Math.min(alpha,1))},Color.units={lightness:"%",saturation:"%",hue:"deg"},Color.types={red:"rgba",blue:"rgba",green:"rgba",alpha:"rgba",hue:"hsla",saturation:"hsla",lightness:"hsla"},Color.comps={red:"r",green:"g",blue:"b",alpha:"a",hue:"h",saturation:"s",lightness:"l"},Color.map={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5],transparent:[0,0,0,0]},Color}(Fashion.Type);Fashion.Color=Color,Fashion.apply(Color.prototype,{type:"color",$isFashionColor:!0,$isFashionRGBA:!1,$isFashionHSLA:!1,$canUnbox:!1})}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var ColorHSLA=function(_super){function ColorHSLA(h,s,l,a){_super.call(this),this.type="hsla",this.$isFashionHSLA=!0,this.h=Fashion.Color.constrainDegrees(h),this.s=s,this.l=l,this.a=void 0!==a?a:1}return __extends(ColorHSLA,_super),ColorHSLA.prototype.doVisit=function(visitor){visitor.hsla(this)},ColorHSLA.prototype.operate=function(operation,right){return this.getRGBA().operate(operation,right)},ColorHSLA.prototype.clone=function(){return new Fashion.ColorHSLA(this.h,this.s,this.l,this.a)},ColorHSLA.prototype.getRGBA=function(){return Fashion.ColorRGBA.fromHSLA(this)},ColorHSLA.prototype.toString=function(){return""+this.getRGBA()},ColorHSLA.prototype.add=function(h,s,l,a){return new Fashion.ColorHSLA(Fashion.Color.constrainDegrees(this.h+h),Fashion.Color.constrainPercentage(this.s+s),Fashion.Color.constrainPercentage(this.l+l),Fashion.Color.constrainAlpha(this.a*a))},ColorHSLA.prototype.subtract=function(h,s,l){return this.add(-h,-s,-l)},ColorHSLA.prototype.adjustLightness=function(percent){return this.l=Fashion.Color.constrainPercentage(this.l+percent),
this},ColorHSLA.prototype.adjustHue=function(deg){return this.h=Fashion.Color.constrainDegrees(this.h+deg),this},ColorHSLA.fromRGBA=function(rgba){if(rgba.$isFashionHSLA)return rgba.clone();var r=rgba.r/255,g=rgba.g/255,b=rgba.b/255,a=rgba.a,max=Math.max(r,g,b),min=Math.min(r,g,b),delta=max-min,h=0,s=0,l=.5*(max+min);return min!=max&&(s=.5>l?delta/(max+min):delta/(2-max-min),h=r==max?60*(g-b)/delta:g==max?120+60*(b-r)/delta:240+60*(r-g)/delta,0>h&&(h+=360),h>=360&&(h-=360)),new Fashion.ColorHSLA(Fashion.Color.constrainDegrees(h),Fashion.Color.constrainPercentage(100*s),Fashion.Color.constrainPercentage(100*l),a)},ColorHSLA}(Fashion.Color);Fashion.ColorHSLA=ColorHSLA}(Fashion||(Fashion={}));var Fashion;!function(Fashion){function hex2(v){var s=v.toString(16);return s.length<2&&(s="0"+s),s}Fashion.hex2=hex2;var ColorRGBA=function(_super){function ColorRGBA(r,g,b,a){_super.call(this),this["+.number"]=function(right){var value=right.value,unit=right.unit;switch(unit){case"%":return this.getHSLA().adjustLightness(value).getRGBA();case"deg":return this.getHSLA().adjustHue(value).getRGBA();default:return this.add(value,value,value,1)}},this["+.rgba"]=function(right){return this.add(right.r,right.g,right.b,right.a)},this["+.hsla"]=function(right){return this.getHSLA().add(right.h,right.s,right.l)},this["-.number"]=function(right){var value=right.value,unit=right.unit;switch(unit){case"%":return this.getHSLA().adjustLightness(-value).getRGBA();case"deg":return this.getHSLA().adjustHue(-value).getRGBA();default:return this.subtract(value,value,value)}},this["-.rgba"]=function(right){return this.subtract(right.r,right.g,right.b)},this["-.hsla"]=function(right){return this.getHSLA().subtract(right.h,right.s,right.l)},this["*.number"]=function(right){return this.multiply(right.value)},this["/.number"]=function(right){return this.divide(right.value)},this["*.rgba"]=function(right){return new Fashion.ColorRGBA(this.r*right.r,this.g*right.g,this.b*right.b,this.a*right.a)},this["/.rgba"]=function(right){return new Fashion.ColorRGBA(Math.floor(this.r/right.r),Math.floor(this.g/right.g),Math.floor(this.b/right.b),Math.floor(this.a/right.a))},this.r=Math.min(255,Math.max(0,r)),this.g=Math.min(255,Math.max(0,g)),this.b=Math.min(255,Math.max(0,b)),this.a=void 0!==a?Math.min(1,Math.max(0,a)):1}return __extends(ColorRGBA,_super),ColorRGBA.prototype.doVisit=function(visitor){visitor.rgba(this)},ColorRGBA.prototype.clone=function(){return new Fashion.ColorRGBA(this.r,this.g,this.b,this.a)},ColorRGBA.prototype.getHSLA=function(){return Fashion.ColorHSLA.fromRGBA(this)},ColorRGBA.prototype.stringify=function(){var me=this,round=Math.round,r=round(me.r),g=round(me.g),b=round(me.b),a=me.a,stringified="";return stringified=1===a?"#"+hex2(r)+hex2(g)+hex2(b):"rgba("+r+", "+g+", "+b+", "+a+")",stringified=stringified.toLowerCase()},ColorRGBA.prototype.getCompressedValue=function(lowerVal){var name=Fashion.ColorRGBA.stringifiedMap[lowerVal],shortName=Fashion.ColorRGBA.shortFormMap[lowerVal];return name&&(lowerVal=lowerVal.length>name.length?name:lowerVal),Fashion.ColorRGBA.useShortValues&&shortName&&(lowerVal=lowerVal.length>shortName.length?shortName:lowerVal),lowerVal},ColorRGBA.prototype.toString=function(){return this.stringified||(this.stringified=this.getCompressedValue(this.stringify())),this.stringified},ColorRGBA.prototype.toIeHexStr=function(){var me=this,round=Math.round,r=round(me.r),g=round(me.g),b=round(me.b),a=round(255*me.a);return"#"+hex2(a)+hex2(r)+hex2(g)+hex2(b)},ColorRGBA.prototype.add=function(r,g,b,a){return new Fashion.ColorRGBA(this.r+r,this.g+g,this.b+b,this.a*a)},ColorRGBA.prototype.subtract=function(r,g,b){return new Fashion.ColorRGBA(this.r-r,this.g-g,this.b-b,this.a)},ColorRGBA.prototype.multiply=function(number){return new Fashion.ColorRGBA(this.r*number,this.g*number,this.b*number,this.a)},ColorRGBA.prototype.divide=function(number){return new Fashion.ColorRGBA(this.r/number,this.g/number,this.b/number,this.a)},ColorRGBA.fromHex=function(value){"#"==value.charAt(0)&&(value=value.substr(1));var r,g,b;3===value.length?(r=parseInt(value.charAt(0),16),g=parseInt(value.charAt(1),16),b=parseInt(value.charAt(2),16),r=(r<<4)+r,g=(g<<4)+g,b=(b<<4)+b):(r=parseInt(value.substring(0,2),16),g=parseInt(value.substring(2,4),16),b=parseInt(value.substring(4,6),16));var result=new Fashion.ColorRGBA(r,g,b);return Fashion.ColorRGBA.preserveInputStrings&&(result.stringified="#"+value),result},ColorRGBA.fromHSLA=function(color){function hue(h){return 0>h&&++h,h>1&&--h,1>6*h?m1+(m2-m1)*h*6:1>2*h?m2:2>3*h?m1+(m2-m1)*(2/3-h)*6:m1}if(color.$isFashionRGBA)return color.clone();var hsla=color,h=hsla.h/360,s=hsla.s/100,l=hsla.l/100,a=hsla.a,m2=.5>=l?l*(s+1):l+s-l*s,m1=2*l-m2,r=Fashion.Color.constrainChannel(255*hue(h+1/3)),g=Fashion.Color.constrainChannel(255*hue(h)),b=Fashion.Color.constrainChannel(255*hue(h-1/3));return new Fashion.ColorRGBA(r,g,b,a)},ColorRGBA.stringifiedMap={"rgba(0, 0, 0, 0)":"transparent"},ColorRGBA.shortFormMap={},ColorRGBA.useShortValues=!0,ColorRGBA.preserveInputStrings=!1,ColorRGBA}(Fashion.Color);Fashion.ColorRGBA=ColorRGBA,Fashion.apply(ColorRGBA.prototype,{type:"rgba",$isFashionRGBA:!0})}(Fashion||(Fashion={})),function(ColorRGBA,stringifiedMap,colorMap,shortMap){var i,colorChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],names=Object.keys(colorMap);for(names.sort(),i=0;i<names.length;i++){var name=names[i],val=colorMap[name],color=new ColorRGBA(val[0],val[1],val[2],val[3]),str=color.stringify();stringifiedMap[str]=name}colorChars.forEach(function(short1){var long1=short1+short1;colorChars.forEach(function(short2){var long2=short2+short2;colorChars.forEach(function(short3){var long3=short3+short3,short="#"+short1+short2+short3,long="#"+long1+long2+long3;if(shortMap[long]){var curr=shortMap[long];short=curr.length>short.length?short:curr}shortMap[long]=short})})})}(Fashion.ColorRGBA,Fashion.ColorRGBA.stringifiedMap,Fashion.Color.map,Fashion.ColorRGBA.shortFormMap);var Fashion;!function(Fashion){var Text=function(_super){function Text(value,quoteChar){_super.call(this,value),Fashion.Text.preferDoubleQuotes?this.quoteChar=""===quoteChar?"":'"':this.quoteChar=void 0===quoteChar?'"':quoteChar}return __extends(Text,_super),Text.prototype.doVisit=function(visitor){visitor.string(this)},Text.prototype.toString=function(){return this.quoteChar+this.value+this.quoteChar},Text.prototype.unquote=function(){return new Fashion.Literal(this.value)},Text.prototype.clone=function(){return new Fashion.Text(this.value,this.quoteChar)},Text.prototype["+"]=function(right){return new Fashion.Text(this.value+right.getHash())},Text.prototype["+.number"]=function(right){return new Fashion.Text(this.value+(""+right))},Text.prototype["/"]=function(right){return new Fashion.Text(this.value+"/"+right.getHash())},Text.prototype.slice=function(start,end){return new Fashion.Text(_super.prototype.slice.call(this,start,end).value,this.quoteChar)},Text.prototype.toUpperCase=function(){return new Fashion.Text(this.value.toUpperCase(),this.quoteChar)},Text.prototype.toLowerCase=function(){return new Fashion.Text(this.value.toLowerCase(),this.quoteChar)},Text.prototype.insert=function(str,startVal){return new Fashion.Text(_super.prototype.insert.call(this,str,startVal).value,this.quoteChar)},Text.tryCoerce=function(obj){return obj.$isFashionNumber?void 0:obj.$isFashionLiteral?new Fashion.Text(obj.value):new Fashion.Text(obj.getHash())},Text.preferDoubleQuotes=!1,Text}(Fashion.Literal);Fashion.Text=Text,Fashion.apply(Text.prototype,{type:"string",$isFashionString:!0})}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var List=function(_super){function List(items,separator){_super.call(this),this.items=items||[],this.separator=void 0===separator?" ":separator}return __extends(List,_super),List.prototype.doVisit=function(visitor){visitor.list(this)},List.prototype.descend=function(visitor){for(var i=0;i<this.items.length;i++)visitor.visit(this.items[i])},List.prototype.clone=function(){return new Fashion.List(this.items.slice(0),this.separator)},List.prototype.add=function(item){return this.items.push(item)},List.prototype.get=function(index){return this.items[index-1]||null},List.prototype.operate=function(operation,right){switch(operation){case"!=":if(right.$isFashionLiteral&&("null"===right.value||"none"===right.value))return!0;break;case"==":if(right.$isFashionLiteral&&("null"===right.value||"none"===right.value))return!1}return Fashion.Type.prototype.operate.call(this,operation,right)},List.prototype.supports=function(prefix){for(var i=0;i<this.items.length;i++){var item=this.items[i];if(item.supports(prefix))return!0}return!1},List.prototype.toBoolean=function(){return!!this.items.length},List.prototype.getItems=function(){return Fashion.filter(this.items,function(item){var unboxed=Fashion.Type.unbox(item);return null!==unboxed&&void 0!==unboxed})},List.prototype.toString=function(){return this.items.join(this.separator)},List.prototype.unquote=function(){for(var items=[],i=0;i<this.items.length;i++)this.items[i]&&items.push(this.items[i].unquote());return new List(items,this.separator)},List.prototype.toPrefixedString=function(prefix){for(var items=[],i=0;i<this.items.length;i++){var item=this.items[i];item&&items.push(item.toPrefixedString(prefix))}return items.join(this.separator)},List.prototype["==.list"]=function(right){for(var equals=this.separator==right.separator&&this.items.length==right.items.length,i=0;equals&&i<this.items.length;++i)equals=this.items[i].operate("==",right.items[i]);return equals},List}(Fashion.Type);Fashion.List=List,Fashion.apply(List.prototype,{type:"list",$isFashionList:!0})}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var Declaration=function(_super){function Declaration(cfg){_super.call(this),cfg&&Fashion.apply(this,cfg)}return __extends(Declaration,_super),Declaration.prototype.doVisit=function(visitor){visitor.declaration(this)},Declaration.prototype.descend=function(visitor){visitor.visit(this.value)},Declaration}(Fashion.Type);Fashion.Declaration=Declaration,Fashion.apply(Declaration.prototype,{type:"declaration",$isFashionDeclaration:!0,$canUnbox:!1})}(Fashion||(Fashion={}));var Fashion;!function(Fashion){function getJsName(name){return name.replace(/\-/g,"_").replace(/\//g,"_fs_").replace(/\\/g,"_bs_")}Fashion.VariableNameMap={};var NameConverter=function(_super){function NameConverter(){_super.apply(this,arguments)}return __extends(NameConverter,_super),NameConverter.prototype.convertName=function(name){return Fashion.VariableNameMap.hasOwnProperty(name)||(Fashion.VariableNameMap[name]=getJsName(name)),Fashion.VariableNameMap[name]},NameConverter}(Fashion.Base);Fashion.NameConverter=NameConverter,Fashion.getJsName=getJsName}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var SassVariable=function(_super){function SassVariable(cfg){_super.call(this,cfg),this.references=this.references||[]}return __extends(SassVariable,_super),SassVariable.prototype.elevateDynamics=function(variables,elevator){var me=this,dynamicWas=me.dynamic;me.dynamic=!0,dynamicWas||(this.enableElevationWarning&&(Fashion.warn("Elevating variable '"+me.name+"' to dynamic",me.node),Fashion.warn("	caused by",elevator.node)),me.elevationCause=elevator,variables.push(me)),me.references.forEach(function(ref){var variable=me.map[ref];variable&&!variable.dynamic&&variable.elevateDynamics(variables,me)})},SassVariable.prototype.verify=function(){return this.dynamic&&this.previous&&!this.previous.dynamic?(Fashion.error("Cannot redefine "+this.name+" as dynamic"),Fashion.error("	from ",this.previous.getNode()),Fashion.error("	  at ",this.getNode()),this.preprocessor.errors+=1,!1):!0},SassVariable.prototype.elevated=function(){return this.dynamic&&!this.attributes.dynamic},SassVariable.prototype.getNode=function(){var node=this.node;return node},SassVariable}(Fashion.Base);Fashion.SassVariable=SassVariable;var Preprocessor=function(_super){function Preprocessor(cfg){_super.call(this,cfg),this.errors=0,this.enableElevationWarning=!0}return __extends(Preprocessor,_super),Preprocessor.prototype.reset=function(){this.variables={},this.functions=[],this.currentVariable=null,this.functionDeclarations={},this.mixinDeclarations={},this.registeredDeclarations=null},Preprocessor.prototype.handleFunc=function(func,collection){var name=Fashion.getJsName(func.id||func.value),parameters=Preprocessor.getFunctionCallArgs(func);collection[name]={parameters:parameters}},Preprocessor.prototype.Mixin=function(node){this.handleFunc(node.name,this.mixinDeclarations),node.descend(this)},Preprocessor.prototype.Function=function(node){var isGlobal=1==this.nodeStack.length;isGlobal&&this.functions.push(node),this.handleFunc(node.func,this.functionDeclarations),node.descend(this)},Preprocessor.prototype.Variable=function(node){this.currentVariable&&this.currentVariable.references.push(Fashion.getJsName(node.name))},Preprocessor.prototype.Comment=function(comment){"//# fashion warn -elevation"===comment?this.enableElevationWarning=!1:"//# fashion warn +elevation"===comment&&(this.enableElevationWarning=!0)},Preprocessor.prototype.VariableAssignment=function(node){var variable,value,funcName,name=Fashion.getJsName(node.name),currVariable=this.variables[name],varWas=this.currentVariable,bangGlobal=!!node.global,bangDynamic=!!node.dynamic,bangDefault=!!node["default"],isGlobalVar=1===this.nodeStack.length;return isGlobalVar||bangGlobal?(node.dynamic&&(Fashion.warn("Use of !dynamic has been deprecated",node),Fashion.warn("Use dynamic() function instead.")),value=node.value,"FunctionCall"===value.type&&(funcName=value.id||value.value,"dynamic"===funcName&&(bangDynamic=!0,value.visitTarget=value.args,value.args.items&&1===value.args.items.length&&(value.visitTarget=value.args.items[0]))),variable=this.variables[name]=new SassVariable({name:name,node:node,previous:currVariable,attributes:{global:bangGlobal,"default":bangDefault,dynamic:bangDynamic},isGlobal:isGlobalVar,dynamic:currVariable&&currVariable.dynamic||bangDynamic,map:this.variables,preprocessor:this,enableElevationWarning:this.enableElevationWarning}),variable.verify(),this.currentVariable=variable,node.descend(this),void(this.currentVariable=varWas)):!1},Preprocessor.prototype.getRuntime=function(){return this.runtime},Preprocessor.prototype.getRegisteredFunctions=function(){return this.registeredFunctions||(this.registeredFunctions=this.runtime&&this.runtime.getRegisteredFunctions()||{}),this.registeredFunctions},Preprocessor.prototype.loadRegisteredFunctionArgs=function(){if(!this.registeredDeclarations){var name,func,src,params,match,args,i,argName,registered=this.getRegisteredFunctions(),funcArgsRx=/function\s*?(.*?)\((.*?)\)\s*?\{/,paramsMap={};for(name in registered)if(func=registered[name],Fashion.isFunction(func)){if(src=func+"",params=[],funcArgsRx.test(src))for(match=funcArgsRx.exec(src),args=match[2]&&match[2].split(/,/g)||[],i=0;i<args.length;i++)argName=args[i].trim(),params.push({name:argName,position:i});paramsMap[name]=params}this.registeredDeclarations=paramsMap}},Preprocessor.prototype.preprocess=function(node,skipRegistrations){this.reset(),this.visit(node),skipRegistrations||this.loadRegisteredFunctionArgs(),this.errors&&Fashion.raise("Encountered "+this.errors+" error(s) during preprocessing.")},Preprocessor.prototype.getVariables=function(){return this.variables},Preprocessor.prototype.generateCycleError=function(stack,variables){var r,trace,referenceTrace=[];for(r=0;r<stack.length;r++)trace=stack[r]+" => "+variables[stack[r]].node.file+":"+variables[stack[r]].node.lineNumber,referenceTrace.push(trace);var msg=["Variable Cycle detected in variable : ",referenceTrace.join("\n")].join("\n");Fashion.error(msg),Fashion.raise(msg)},Preprocessor.prototype.topoSort=function(variable,variables,sorted,processed,stack){processed=processed||{},sorted=sorted||[],stack=stack||[];var refs,ref,r,refVariable,name=variable.name;if(processed[name]!==!0){for(stack.push(name),"processing"===processed[name]&&this.generateCycleError(stack,variables),processed[name]="processing",refs=variable.references,r=0;r<refs.length;r++)ref=refs[r],refVariable=variables[ref],refVariable||Fashion.raiseAt("Reference to undeclared variable : "+ref+" at ",variable.node),this.topoSort(refVariable,variables,sorted,processed,stack);sorted.push(variable),processed[name]=!0,stack.pop()}},Preprocessor.prototype.getDynamics=function(){var variable,name,dynamic,d,n,variables=this.getVariables(),variableNames=Object.keys(variables),dynamics=[],sorted=[];for(n=0;n<variableNames.length;n++)name=variableNames[n],variable=variables[name],variable.dynamic&&(variable.elevateDynamics(dynamics),dynamics.push(variable));for(d=0;d<dynamics.length;d++)dynamic=dynamics[d],this.topoSort(dynamic,variables,sorted);return sorted},Preprocessor.prototype.getDynamicsMap=function(){var i,variable,dynamicVariables=this.getDynamics(),map={};for(i=0;i<dynamicVariables.length;i++)variable=dynamicVariables[i],map[variable.name]=variable;return map},Preprocessor.prototype.getSortedDynamicAstNodes=function(){var i,sortedVariables=this.getDynamics(),sortedAst=[];for(i=0;i<sortedVariables.length;i++)sortedAst.push(sortedVariables[i].getNode());return sortedAst},Preprocessor.prototype.loadPreprocessorCache=function(preprocessor){this.functionDeclarations=preprocessor.functionDeclarations,this.mixinDeclarations=preprocessor.mixinDeclarations,this.registeredDeclarations=preprocessor.registeredDeclarations,this.registeredFunctions=preprocessor.registeredFunctions},Preprocessor.loadArgsArray=function(args){return!args||"SelectorList"!==args.type&&"List"!==args.type||(args=args.items),Array.isArray(args)||(args=[args]),args},Preprocessor.getFunctionCallArgs=function(func){var arg,a,args=this.loadArgsArray(func.args),parameters=[];for(a=0;a<args.length;a++)arg=args[a],arg&&parameters.push({name:arg.variable||arg.name,value:arg,position:a,varArgs:arg.varArgs});return parameters},Preprocessor}(Fashion.Visitor);Fashion.Preprocessor=Preprocessor}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var parse;!function(parse){var BaseNode=function(){function BaseNode(cfg){cfg&&Fashion.apply(this,cfg)}return BaseNode.prototype.doVisit=function(visitor){},BaseNode.prototype.descend=function(visitor){},BaseNode}();parse.BaseNode=BaseNode,Fashion.apply(BaseNode.prototype,{visitTarget:void 0})}(parse=Fashion.parse||(Fashion.parse={}))}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var parse;!function(parse){var Each=function(_super){function Each(cfg){_super.call(this,cfg)}return __extends(Each,_super),Each.prototype.doVisit=function(visitor){visitor.Each(this)},Each.prototype.descend=function(visitor){visitor.visit(this.list),visitor.visit(this.statements)},Each}(parse.BaseNode);parse.Each=Each,Fashion.apply(Each.prototype,{type:"Each"});var For=function(_super){function For(cfg){_super.call(this,cfg)}return __extends(For,_super),For.prototype.doVisit=function(visitor){visitor.For(this)},For.prototype.descend=function(visitor){visitor.visit(this.start),visitor.visit(this.end),visitor.visit(this.statements)},For}(parse.BaseNode);parse.For=For,Fashion.apply(For.prototype,{type:"For"});var While=function(_super){function While(cfg){_super.call(this,cfg)}return __extends(While,_super),While.prototype.doVisit=function(visitor){visitor.While(this)},While.prototype.descend=function(visitor){visitor.visit(this.condition),visitor.visit(this.statements)},While}(parse.BaseNode);parse.While=While,Fashion.apply(While.prototype,{type:"While"});var Charset=function(_super){function Charset(cfg){_super.call(this,cfg)}return __extends(Charset,_super),Charset.prototype.doVisit=function(visitor){visitor.Charset(this)},Charset}(parse.BaseNode);parse.Charset=Charset,Fashion.apply(Charset.prototype,{type:"Charset"});var Function=function(_super){function Function(cfg){_super.call(this,cfg)}return __extends(Function,_super),Function.prototype.doVisit=function(visitor){visitor.Function(this)},Function.prototype.descend=function(visitor){visitor.visit(this.func),visitor.visit(this.statements)},Function}(parse.BaseNode);parse.Function=Function,Fashion.apply(Function.prototype,{type:"Function"});var Ruleset=function(_super){function Ruleset(cfg){_super.call(this,cfg)}return __extends(Ruleset,_super),Ruleset.prototype.doVisit=function(visitor){visitor.Ruleset(this)},Ruleset.prototype.descend=function(visitor){visitor.visit(this.selectors),visitor.visit(this.statements)},Ruleset}(parse.BaseNode);parse.Ruleset=Ruleset,Fashion.apply(Ruleset.prototype,{type:"Ruleset"});var Mixin=function(_super){function Mixin(cfg){_super.call(this,cfg)}return __extends(Mixin,_super),Mixin.prototype.doVisit=function(visitor){visitor.Mixin(this)},Mixin.prototype.descend=function(visitor){visitor.visit(this.name),visitor.visit(this.statements)},Mixin}(parse.BaseNode);parse.Mixin=Mixin,Fashion.apply(Mixin.prototype,{type:"Mixin"});var Block=function(_super){function Block(cfg){_super.call(this,cfg)}return __extends(Block,_super),Block.prototype.doVisit=function(visitor){visitor.Block(this)},Block.prototype.descend=function(visitor){visitor.visit(this.statements)},Block}(parse.BaseNode);parse.Block=Block,Fashion.apply(Block.prototype,{type:"Block"});var Include=function(_super){function Include(cfg){_super.call(this,cfg)}return __extends(Include,_super),Include.prototype.doVisit=function(visitor){visitor.Include(this)},Include.prototype.descend=function(visitor){visitor.visit(this.include),this.content&&visitor.visit(this.content)},Include}(parse.BaseNode);parse.Include=Include,Fashion.apply(Include.prototype,{type:"Include"});var Assignment=function(_super){function Assignment(cfg){_super.call(this,cfg)}return __extends(Assignment,_super),Assignment.prototype.doVisit=function(visitor){visitor.Assignment(this)},Assignment.prototype.descend=function(visitor){visitor.visit(this.expr)},Assignment}(parse.BaseNode);parse.Assignment=Assignment,Fashion.apply(Assignment.prototype,{type:"Assignment"});var Declaration=function(_super){function Declaration(cfg){_super.call(this,cfg)}return __extends(Declaration,_super),Declaration.prototype.doVisit=function(visitor){visitor.Declaration(this)},Declaration.prototype.descend=function(visitor){visitor.visit(this.value)},Declaration}(parse.BaseNode);parse.Declaration=Declaration,Fashion.apply(Declaration.prototype,{type:"Declaration"});var VariableAssignment=function(_super){function VariableAssignment(cfg){_super.call(this,cfg)}return __extends(VariableAssignment,_super),VariableAssignment.prototype.doVisit=function(visitor){visitor.VariableAssignment(this)},VariableAssignment.prototype.descend=function(visitor){visitor.visit(this.value)},VariableAssignment}(parse.BaseNode);parse.VariableAssignment=VariableAssignment,Fashion.apply(VariableAssignment.prototype,{type:"VariableAssignment"});var If=function(_super){function If(cfg){_super.call(this,cfg)}return __extends(If,_super),If.prototype.doVisit=function(visitor){visitor.If(this)},If.prototype.descend=function(visitor){visitor.visit(this.condition),visitor.visit(this.statements)},If}(parse.BaseNode);parse.If=If,Fashion.apply(If.prototype,{type:"If"});var Else=function(_super){function Else(cfg){_super.call(this,cfg)}return __extends(Else,_super),Else.prototype.doVisit=function(visitor){visitor.Else(this)},Else.prototype.descend=function(visitor){visitor.visit(this.condition),visitor.visit(this.statements)},Else}(parse.BaseNode);parse.Else=Else,Fashion.apply(Else.prototype,{type:"Else"});var Return=function(_super){function Return(cfg){_super.call(this,cfg)}return __extends(Return,_super),Return.prototype.doVisit=function(visitor){visitor.Return(this)},Return.prototype.descend=function(visitor){visitor.visit(this.expr)},Return}(parse.BaseNode);parse.Return=Return,Fashion.apply(Return.prototype,{type:"Return"});var Parenthetical=function(_super){function Parenthetical(cfg){_super.call(this,cfg)}return __extends(Parenthetical,_super),Parenthetical.prototype.doVisit=function(visitor){visitor.ParentheticalExpression(this)},Parenthetical.prototype.descend=function(visitor){visitor.visit(this.expr)},Parenthetical}(parse.BaseNode);parse.Parenthetical=Parenthetical,Fashion.apply(Parenthetical.prototype,{type:"Parenthetical"});var SelectorPart=function(_super){function SelectorPart(cfg){_super.call(this,cfg)}return __extends(SelectorPart,_super),SelectorPart.prototype.doVisit=function(visitor){visitor.SelectorPart(this)},SelectorPart.prototype.descend=function(visitor){visitor.visit(this.value)},SelectorPart}(parse.BaseNode);parse.SelectorPart=SelectorPart,Fashion.apply(SelectorPart.prototype,{type:"SelectorPart"});var SelectorProperty=function(_super){function SelectorProperty(cfg){_super.call(this,cfg)}return __extends(SelectorProperty,_super),SelectorProperty.prototype.doVisit=function(visitor){visitor.SelectorProperty(this)},SelectorProperty.prototype.descend=function(visitor){visitor.visit(this.property),visitor.visit(this.value)},SelectorProperty}(parse.BaseNode);parse.SelectorProperty=SelectorProperty,Fashion.apply(SelectorProperty.prototype,{type:"SelectorProperty"});var CompoundSelector=function(_super){function CompoundSelector(cfg){_super.call(this,cfg)}return __extends(CompoundSelector,_super),CompoundSelector.prototype.doVisit=function(visitor){visitor.CompoundSelector(this)},CompoundSelector.prototype.descend=function(visitor){visitor.visit(this.items)},CompoundSelector}(parse.BaseNode);parse.CompoundSelector=CompoundSelector,Fashion.apply(CompoundSelector.prototype,{type:"CompoundSelector"});var MultiPartSelector=function(_super){function MultiPartSelector(cfg){_super.call(this,cfg)}return __extends(MultiPartSelector,_super),MultiPartSelector.prototype.doVisit=function(visitor){visitor.MultiPartSelector(this)},MultiPartSelector.prototype.descend=function(visitor){visitor.visit(this.items)},MultiPartSelector}(parse.BaseNode);parse.MultiPartSelector=MultiPartSelector,Fashion.apply(MultiPartSelector.prototype,{type:"MultiPartSelector"});var SelectorList=function(_super){function SelectorList(cfg){_super.call(this,cfg)}return __extends(SelectorList,_super),SelectorList.prototype.doVisit=function(visitor){visitor.SelectorList(this)},SelectorList.prototype.descend=function(visitor){visitor.visit(this.items)},SelectorList}(parse.BaseNode);parse.SelectorList=SelectorList,Fashion.apply(SelectorList.prototype,{type:"SelectorList"});var BinaryExpression=function(_super){function BinaryExpression(cfg){_super.call(this,cfg)}return __extends(BinaryExpression,_super),BinaryExpression.prototype.doVisit=function(visitor){visitor.BinaryExpression(this)},BinaryExpression.prototype.descend=function(visitor){visitor.visit(this.left),visitor.visit(this.right)},BinaryExpression}(parse.BaseNode);parse.BinaryExpression=BinaryExpression,Fashion.apply(BinaryExpression.prototype,{type:"BinaryExpression"});var UnaryExpression=function(_super){function UnaryExpression(cfg){_super.call(this,cfg)}return __extends(UnaryExpression,_super),UnaryExpression.prototype.doVisit=function(visitor){visitor.UnaryExpression(this)},UnaryExpression.prototype.descend=function(visitor){visitor.visit(this.expr)},UnaryExpression}(parse.BaseNode);parse.UnaryExpression=UnaryExpression,Fashion.apply(UnaryExpression.prototype,{type:"UnaryExpression"});var Variable=function(_super){function Variable(cfg){_super.call(this,cfg)}return __extends(Variable,_super),Variable.prototype.doVisit=function(visitor){visitor.Variable(this)},Variable}(parse.BaseNode);parse.Variable=Variable,Fashion.apply(Variable.prototype,{type:"Variable"});var Constant=function(_super){function Constant(cfg){_super.call(this,cfg)}return __extends(Constant,_super),Constant.prototype.doVisit=function(visitor){visitor.Constant(this)},Constant}(parse.BaseNode);parse.Constant=Constant,Fashion.apply(Constant.prototype,{type:"Constant"});var FunctionCall=function(_super){function FunctionCall(cfg){_super.call(this,cfg)}return __extends(FunctionCall,_super),FunctionCall.prototype.doVisit=function(visitor){visitor.FunctionCall(this)},FunctionCall.prototype.descend=function(visitor){visitor.visit(this.args)},FunctionCall}(parse.BaseNode);parse.FunctionCall=FunctionCall,Fashion.apply(FunctionCall.prototype,{type:"FunctionCall"});var Extend=function(_super){function Extend(cfg){_super.call(this,cfg)}return __extends(Extend,_super),Extend.prototype.doVisit=function(visitor){visitor.Extend(this)},Extend}(parse.BaseNode);parse.Extend=Extend,Fashion.apply(Extend.prototype,{type:"Extend"});var List=function(_super){function List(cfg){_super.call(this,cfg)}return __extends(List,_super),List.prototype.doVisit=function(visitor){visitor.List(this)},List.prototype.descend=function(visitor){visitor.visit(this.items)},List}(parse.BaseNode);parse.List=List,Fashion.apply(List.prototype,{type:"List"});var Warn=function(_super){function Warn(cfg){_super.call(this,cfg)}return __extends(Warn,_super),Warn.prototype.doVisit=function(visitor){visitor.Warn(this)},Warn}(parse.BaseNode);parse.Warn=Warn,Fashion.apply(Warn.prototype,{type:"Warn"});var Debug=function(_super){function Debug(cfg){_super.call(this,cfg)}return __extends(Debug,_super),Debug.prototype.doVisit=function(visitor){visitor.Debug(this)},Debug.prototype.descend=function(visitor){visitor.visit(this.expr)},Debug}(parse.BaseNode);parse.Debug=Debug,Fashion.apply(Debug.prototype,{type:"Debug"});var Import=function(_super){function Import(cfg){_super.call(this,cfg)}return __extends(Import,_super),Import.prototype.doVisit=function(visitor){visitor.Import(this)},Import}(parse.BaseNode);parse.Import=Import,Fashion.apply(Import.prototype,{type:"Import"});var Require=function(_super){function Require(cfg){_super.call(this,cfg)}return __extends(Require,_super),Require.prototype.doVisit=function(visitor){visitor.Require(this)},Require.prototype.descend=function(visitor){visitor.visit(this.source)},Require}(parse.BaseNode);parse.Require=Require,Fashion.apply(Require.prototype,{type:"Require"});var Content=function(_super){function Content(cfg){_super.call(this,cfg)}return __extends(Content,_super),Content.prototype.doVisit=function(visitor){visitor.Content(this)},Content}(parse.BaseNode);parse.Content=Content,Fashion.apply(Content.prototype,{type:"Content"});var Debugger=function(_super){function Debugger(cfg){_super.call(this,cfg)}return __extends(Debugger,_super),Debugger.prototype.doVisit=function(visitor){visitor.Debugger(this)},Debugger}(parse.BaseNode);parse.Debugger=Debugger,Fashion.apply(Debugger.prototype,{type:"Debugger"})}(parse=Fashion.parse||(Fashion.parse={}))}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var StringCache=function(){function StringCache(){this.array=[],this.map={}}return StringCache.prototype.addString=function(string){var idx=this.map[string];return void 0===idx&&(idx=this.array.length,this.array.push(string),this.map[string]=idx),idx},StringCache.prototype.get=function(id){return this.array[id]},StringCache}();Fashion.StringCache=StringCache;var DocCache=function(){function DocCache(){this.array=[]}return DocCache.prototype.addDocs=function(docs){var idx=this.array.length;return this.array.push(docs),idx},DocCache.prototype.get=function(id){return this.array[id]},DocCache}();Fashion.DocCache=DocCache;var Transpiler=function(_super){function Transpiler(){_super.apply(this,arguments),this.errors=0,this.warnings=0,this.loadArgsArray=Fashion.Preprocessor.loadArgsArray,this.colors=Fashion.Color.map,this.booleans={"true":!0,"false":!0},this.nativeCssMethods={url:!0,translate3d:!0,rotate:!0,scale:!0,"-webkit-gradient":!0,from:!0,skew:!0,"color-stop":!0,rect:!0,calc:!0}}return __extends(Transpiler,_super),Transpiler.prototype.reset=function(){this.output=new Fashion.Output,this.currentScope={__suffix:""},this.globalScope=this.currentScope,this.globalVars={},this.errors=0,this.warnings=0,this.stringCache=new StringCache,this.docCache=new DocCache},Transpiler.prototype.createScope=function(parent){parent=parent||this.currentScope;
var scope=Fashion.chain(parent);return scope.__suffix=scope.__suffix+"$",scope},Transpiler.prototype.getScopeName=function(name,scope){return Fashion.getJsName(name)},Transpiler.prototype.getVariableName=function(node){return node.variable||node.name||node.value||node},Transpiler.prototype.handleInlineExpression=function(expr){try{var tree,outwas=this.output,output=new Fashion.Output,parser=new Fashion.parse.Parser;return this.isSelector?(parser.scanner=new Fashion.parse.Scanner(expr),tree=parser.parseSequence()):(tree=parser.parse("$foobar: "+expr+";"),tree=tree[0].value),this.output=output,this.handleStatement(tree),this.output=outwas,output.get().trim()}catch(error){throw Fashion.log("failed to evaluate inline expression : "+expr),error}},Transpiler.prototype.handleInlineExpressions=function(text,start){text+="",start=start||0;var outwas,i,ch,ch2,out=[],level=0;for(i=start;i<text.length;i++)switch(ch=text.charAt(i),ch2=i<text.length-1?text.charAt(i+1):void 0,ch){case"\\":outwas?out.push(ch):out.push("\\\\");break;case'"':outwas?out.push(ch):out.push('\\"');break;case"#":"{"===ch2?(level++,2>level?(outwas=out,out=[],i++):out.push(ch)):out.push(ch);break;case"}":level--,level?out.push(ch):(outwas.push('" + __rt.unquote('),outwas.push(this.handleInlineExpression(out.join(""))),outwas.push(') + "'),out=outwas,outwas=void 0);break;default:out.push(ch)}return out.join("")},Transpiler.prototype.handleStatements=function(statements){this.visit(statements)},Transpiler.prototype.handleStatement=function(statement){statement&&statement.hasOwnProperty("visitTarget")&&(statement=statement.visitTarget,statement&&Array.isArray(statement)&&this.handleStatements(statement)),statement&&(statement instanceof Array&&(statement=new Fashion.parse.List({items:statement,separator:","})),this.visit(statement))},Transpiler.prototype.createDefaultScopeMap=function(args,isMixin){args=this.loadArgsArray(args);var arg,a,varName,jsName,name,output=this.output,defaulted=0;for(this.isSignatureDeclaration=!0,this.generateGets=!0,a=0;a<args.length;a++)arg=args[a],arg&&(varName=arg.variable||arg.name,name=varName,jsName=this.getScopeName(varName),this.currentScope[jsName]=jsName,varName=jsName,arg.varArgs?(output.addln(varName+" = __rt.sliceArgs(arguments, "+(isMixin?a+1:a)+");"),defaulted++):"Variable"!==arg.type||void 0!==arg.variable?(output.addln("var "+varName+" = "+varName+" || "),this.handleStatement(arg),output.add(";"),defaulted++):output.addln("var "+varName+" = "+varName+" || Fashion.Null;"),output.addln('__rt.set("'+jsName+'", '+varName+", true);"));return this.generateGets=!1,this.isSignatureDeclaration=!1,defaulted},Transpiler.prototype.getRegisteredDeclarationsMap=function(declaredParameters){for(var param,map={},d=0;d<declaredParameters.length;d++)param=declaredParameters[d],map[param.name]=param;return map},Transpiler.prototype.createCallArray=function(args,defaults,id,convertName,addComma){args=this.loadArgsArray(args),defaults.parameters&&(defaults=defaults.parameters);for(var arg,a,position,me=this,output=me.output,len=args.length>defaults.length?args.length:defaults.length,declaredMap=me.getRegisteredDeclarationsMap(defaults),actual=Array(len),a=0;a<args.length;a++){if(arg=args[a],position=a,arg&&arg.variable){var argName=arg.variable;if(convertName&&(0==argName.indexOf("$")&&(argName=argName.substr(1)),argName=argName.replace(/\-/g,"_")),declaredMap[argName])position=declaredMap[argName].position;else{var params=[];for(var pName in declaredMap)params.push(pName);Fashion.warn("function or mixin '"+id+"' had no parameter named "+argName+" : params were : "+params.join(", "))}}actual[position]=arg}for(a=0;a<actual.length;a++)arg=actual[a],(addComma||a>0)&&(output.add(","),output.space()),arg?(output.addln(),arg.varArgs?(output.add("__rt.applySplat("),me.handleStatement(arg),output.add(")")):me.handleStatement(arg)):output.addln("__udf");return actual.length},Transpiler.prototype.escapeString=function(str){return str&&str.replace(/\\/g,"\\\\").replace(/"/g,'\\"')},Transpiler.prototype.Each=function(statement){var _this=this;if(statement.isMap){var me=this,output=me.output,arg=statement.variable,names=statement.variable.items;me.eachCount=me.eachCount||1;var jsNames=Fashion.convert(names,function(name){return me.getScopeName(name)}),jsItrName="__each_itr_"+me.eachCount,jsListName="__each__list";names.forEach(function(name,i){return _this.currentScope[jsNames[i]]=jsNames[i]}),output.addln("var "+jsListName+" = "),me.handleStatement(statement.list),output.add(";"),output.addln("for(var "+jsItrName+" = 0; "+jsItrName+" < "+jsListName+".items.length - 1; "+jsItrName+"+=2) {"),output.indent(),output.addln('__rt.set("'+jsNames[0]+'", '+jsListName+".items["+jsItrName+"]);"),output.addln('__rt.set("'+jsNames[1]+'", '+jsListName+".items["+jsItrName+" + 1]);"),me.handleStatements(statement.statements),output.unindentln("}")}else{var me=this,output=me.output,arg=statement.variable,name=me.getVariableName(arg),jsName=me.getScopeName(name),jsListName=jsName+"__list",jsItrName=jsName+"__itr";this.currentScope[jsItrName]=jsItrName,this.currentScope[jsListName]=jsListName,this.currentScope[jsName]=jsName,output.addln("var "+jsListName+" = "),me.handleStatement(statement.list),output.add(";"),output.addln("for(var "+jsItrName+" = 0; "+jsItrName+" < "+jsListName+".items.length; "+jsItrName+"++) {"),output.indent(),output.addln('__rt.set("'+jsName+'", '+jsListName+".items["+jsItrName+"]);"),me.handleStatements(statement.statements),output.unindentln("}")}return!1},Transpiler.prototype.For=function(statement){var me=this,output=me.output,arg=statement.variable,name=me.getVariableName(arg),jsName=me.getScopeName(name),jsItrName=jsName+"__itr";return this.currentScope[jsName]=jsName,output.addln("for(var "+jsItrName+" = __rt.unbox("),me.handleStatement(statement.start),output.add("); "+jsItrName+" < (__rt.unbox("),me.handleStatement(statement.end),output.add(")"),statement.inclusive&&output.add(" + 1"),output.add("); "+jsItrName+"++){"),output.indent(),output.addln("var "+jsName+" = "+jsItrName),output.addln('__rt.set("'+jsName+'", '+jsItrName+", true);"),me.handleStatements(statement.statements),output.unindentln("};"),!1},Transpiler.prototype.While=function(statement){var output=this.output;return output.addln("while(__rt.unbox("),this.handleStatement(statement.condition),output.add(")) {"),output.indent(),this.handleStatements(statement.statements),output.unindentln("};"),!1},Transpiler.prototype.Function=function(statement){var me=this,output=me.output,func=statement.func,jsName=Fashion.getJsName(func.id||func.value);"dynamic"===jsName&&me.error("Cannot define function named 'dynamic'",statement),"require"===jsName&&me.error("Cannot define function named 'require'",statement),me.nestedDocs=!0;var scopeWas=me.currentScope;me.currentScope=me.createScope(),output.addln("function "+jsName+"__fn(");for(var args=me.loadArgsArray(func.args||[]),i=0;i<args.length;i++){var arg=args[i],varName=arg.variable||arg.name;varName=me.getScopeName(varName),i>0&&(output.add(","),output.space()),output.add(varName)}return output.add(") {"),output.indent(),output.addln("__rt.createScope(__rt.functions."+jsName+" && __rt.functions."+jsName+".createdScope);"),me.createDefaultScopeMap(func.args),this.popScope=!0,statement.statements.length&&me.handleStatements(statement.statements),me.currentScope=scopeWas,this.popScope&&(output.addln("__rt.popScope();"),this.popScope=!1),output.unindentln("};"),output.addln("__rt.functions."+jsName+" = "+jsName+"__fn;"),output.addln("__rt.functions."+jsName+".createdScope = __rt.getCurrentScope();"),me.nestedDocs=!1,!1},Transpiler.prototype.Ruleset=function(statement,fnName){fnName=fnName||"__rt.ruleset";var me=this,output=me.output,isGlobal=1===me.nodeStack.length,newScope=!1,docIdx=-1,blockDocIdx=-1,hasBlock=!!statement.statements;if(output.addln(fnName+"("),this.isSelector=statement.selectors,this.handleStatement(statement.selectors),this.isSelector=null,statement.file){var fileIdx=this.stringCache.addString(statement.file);output.add(",__rt.getString("+fileIdx+') + ":'+statement.lineNumber+'"')}else output.add(", null");if(statement.docs&&statement.docs.length?(docIdx=this.docCache.addDocs(statement.docs),output.add(",__rt.getDocs("+docIdx+")")):output.add(", null"),statement.blockDocs&&statement.blockDocs.length?(blockDocIdx=this.docCache.addDocs(statement.blockDocs),output.add(",__rt.getDocs("+blockDocIdx+")")):output.add(", null"),output.add(", "+hasBlock),output.add(");"),isGlobal&&Fashion.Runtime.uniqueScopesForGlobalRulesets&&(newScope=!0),Fashion.Runtime.uniqueScopesForAllRulesets&&(newScope=!0),newScope){var scopeWas=me.currentScope;me.currentScope=me.createScope(),output.addln("__rt.createScope();"),me.handleStatements(statement.statements),output.addln("__rt.popScope();"),me.currentScope=scopeWas}else me.handleStatements(statement.statements);output.addln("__rt.rulesetDone();"),me.nestedDocs=!1},Transpiler.prototype.Mixin=function(statement){var args,arg,varName,scopeWas,i,me=this,output=me.output,name=statement.name,jsName=Fashion.getJsName(name.id||name.value);for(me.nestedDocs=!0,me.processingMixin=!0,scopeWas=me.currentScope,me.currentScope=me.createScope(),output.addln("__rt.mixins."+jsName+"= function("),args=me.loadArgsArray(name.args||[]),output.add("$$content"),i=0;i<args.length;i++)arg=args[i],varName=arg.variable||arg.name,varName=me.getScopeName(varName),output.add(","),output.space(),output.add(varName);return output.add(") {"),output.indent(),output.addln("__rt.createScope(__rt.mixins."+jsName+" && __rt.mixins."+jsName+".createdScope);"),me.createDefaultScopeMap(name.args,!0),me.handleStatements(statement.statements),me.currentScope=scopeWas,output.addln("__rt.popScope();"),output.unindentln("};"),output.addln("__rt.mixins."+jsName+".createdScope = __rt.getCurrentScope();"),me.nestedDocs=!1,me.processingMixin=!1,!1},Transpiler.prototype.Content=function(statement){return this.processingMixin||this.error("@content may only be used within a mixin declaration"),this.output.addln("$$content && $$content();"),!1},Transpiler.prototype.Include=function(statement){var me=this,output=me.output,include=statement.include,id=include.id||include.value,jsId=Fashion.getJsName(id),args=me.loadArgsArray(include.args||[]);return me.mixinDeclarations[jsId]?(output.addln("(__rt.mixins."+jsId+" || "+jsId+"__mix).apply(__rt.mixins, __rt.applySplatArgs(["),output.indent(),statement.content?(output.addln("(function(scope) { return function(){"),output.indent(),output.addln("__rt.createScope(scope);"),me.handleStatements(statement.content.statements),output.addln("__rt.popScope();"),output.unindent(),output.addln("}})(__rt.getCurrentScope())")):output.add("__udf"),me.createCallArray(args,me.mixinDeclarations[jsId],id,!1,!0),output.unindent(),output.add("]));")):me.error("unknown definition for mixin named "+id+" : "+statement.file+":"+statement.lineNumber),!1},Transpiler.prototype.Declaration=function(statement){var i,nsRuleset,me=this,output=me.output,namespacedRulesets=[],props=[],separator=" ",docIdx=-1,val=statement.value;for("List"===val.type?(separator=val.separator,val=val.items):Array.isArray(val)||(val=[val]),i=0;i<val.length;i++){var prop=val[i];"Ruleset"!==prop.type?props.push(prop):namespacedRulesets.push(prop)}if(props.length){if(output.addln('__rt.declare("'+me.handleInlineExpressions(statement.property)+'", '),"font"===statement.property&&(me.isFontDecl=statement),me.handleStatement(new Fashion.parse.List({separator:separator,items:props})),output.add(","),output.space(),output.add(!!statement.important+""),statement.file){var fileIdx=this.stringCache.addString(statement.file);output.add(",__rt.getString("+fileIdx+') + ":'+statement.lineNumber+'"')}else output.add(", null");statement.docs&&statement.docs.length?(docIdx=this.docCache.addDocs(statement.docs),output.add(",__rt.getDocs("+docIdx+")")):output.add(", null"),output.add(");")}if(namespacedRulesets.length)for(i=0;i<namespacedRulesets.length;i++)nsRuleset=namespacedRulesets[i],nsRuleset.selectors=new Fashion.parse.SelectorList({items:[new Fashion.parse.Constant({dataType:"Literal",value:statement.property})],separator:", "}),me.Ruleset(nsRuleset,"__rt.namespacedRuleset"),delete nsRuleset.selectors;return me.isFontDecl=void 0,!1},Transpiler.prototype.VariableAssignment=function(statement){var me=this,output=me.output,name=statement.name,bangGlobal=statement.global?1:0,bangDynamic=statement.dynamic?1:0,bangDefault=statement["default"]?1:0,isGlobalVar=1===me.nodeStack.length?1:0,jsName=me.getScopeName(name),exists=jsName in me.currentScope,createLocal=me.currentScope.hasOwnProperty(jsName)?0:1,variable=me.dynamicVariables[jsName],failDynamicAssignment=!1,processed=me.processedVariables;if(bangDynamic&&!isGlobalVar&&(failDynamicAssignment=!0),bangDynamic||!variable||isGlobalVar||me.currentScope!==me.globalScope||(failDynamicAssignment=!0),bangGlobal&&!bangDynamic&&!isGlobalVar&&variable&&(failDynamicAssignment=!0),failDynamicAssignment){this.error("Dynamic variable "+name+" can only be assigned at file scope "),Fashion.error("  at ",statement);for(var v=variable;v&&v.elevationCause;)Fashion.error("	"+v.name+" elevated by "+v.elevationCause.name+" at ",v.elevationCause.getNode()),v=v.elevationCause}return isGlobalVar&&variable&&processed[jsName]?!1:(exists?bangGlobal?createLocal=0:Fashion.Runtime.allowSetScopedVariables&&!variable&&(createLocal=0):bangGlobal&&(createLocal=0),createLocal?me.currentScope[jsName]=jsName:bangGlobal&&(jsName=me.getScopeName(name,me.globalScope)),isGlobalVar&&(me.globalScope[jsName]=jsName),output.addln('__rt.set("'+jsName+'", '),me.handleStatement(statement.value),output.add(", "+createLocal+", "+bangGlobal+", "+bangDefault+", __dyn);"),variable&&(processed[jsName]=!0),!1)},Transpiler.prototype.If=function(statement){var output=this.output;return output.addln("if(__rt.unbox("),this.handleStatement(statement.condition),output.add(")) {"),output.indent(),this.handleStatements(statement.statements),output.unindentln("}"),!1},Transpiler.prototype.Else=function(statement){var output=this.output;return statement.condition?(output.addln("else if(__rt.unbox("),this.handleStatement(statement.condition),output.add(")) {"),output.indent()):output.indentln("else {"),this.handleStatements(statement.statements),output.unindentln("}"),!1},Transpiler.prototype.Return=function(statement){for(var isFunc=!1,stack=this.nodeStack,i=stack.length-1;i>=0;i--)if("Function"==stack[i].type){isFunc=!0;break}return isFunc?(this.popScope=!1,this.output.addln("var $$$r = "),this.handleStatement(statement.expr),this.output.add(";"),this.output.addln("__rt.popScope();"),this.output.addln("return $$$r;")):Fashion.warn("Ingnored @return => ",statement),!1},Transpiler.prototype.BinaryExpression=function(statement){var me=this,output=me.output,suffix="";"-"!=statement.operator&&"+"!=statement.operator||void 0!==statement.left||(statement.left=new Fashion.parse.Constant({dataType:"Number",value:0}));var divider=", ";switch(statement.operator){case"+":case"-":case"*":case"%":case"**":case"==":case"!=":case">":case"<":case">=":case"<=":output.add('__rt.operate("'+statement.operator+'", ');break;case"and":output.add("__rt.unbox("),divider=") && __rt.unbox(";break;case"or":output.add("__rt.box(__rt.unbox("),divider=") || __rt.unbox(",suffix=")";break;case"/":for(var parent,doOperator=!0,isDeclaration=!1,isParenthetical=!1,isFunctionCall=!1,stack=this.nodeStack,p=stack.length-1;p>=0;p--)switch(parent=stack[p],parent.type){case"Declaration":isDeclaration=!0;break;case"ParentheticalExpression":isParenthetical=!0;break;case"FunctionCall":isFunctionCall=!0}if(doOperator=!isDeclaration||!me.isFontDecl||isParenthetical||isFunctionCall,!doOperator)return output.add("new Fashion.Literal("),me.handleStatement(statement.left),output.add(' + "/" + '),me.handleStatement(statement.right),output.add(")"),!1;output.add('__rt.operate("'+statement.operator+'", ');break;default:Fashion.log("Unrecognized binary expression operator: "+statement.operator)}return me.handleStatement(statement.left),output.add(divider),me.handleStatement(statement.right),output.add(")"),output.add(suffix),!1},Transpiler.prototype.UnaryExpression=function(statement){var output=this.output;switch(statement.operator){case"not":output.add("__rt.not("),this.handleStatement(statement.expr),output.add(")");break;default:Fashion.log("Unrecognized unary expression operator "+statement.operator)}return!1},Transpiler.prototype.Variable=function(statement){var name=statement.name,jsName=this.getScopeName(name);return this.skipWarning||jsName in this.currentScope||jsName in this.variables||this.warn("Reference to undeclared variable "+name+" => "+statement.file+":"+statement.lineNumber),this.output.add('__rt.get("'+jsName+'")'),!1},Transpiler.prototype.Constant=function(statement){var regex,me=this,output=me.output,value=statement.value;switch(value=me.handleInlineExpressions(value),statement.dataType){case"Length":case"Time":case"Angle":regex=/([0-9\.\-]+)([\w]+)$/i,value=value.match(regex),output.add("new Fashion.Numeric("+value[1]+', "'+value[2]+'")');break;case"Number":var s=value+"";0===s.indexOf(".")&&(s="0"+s),value=s,output.add("new Fashion.Numeric("+value+")");break;case"Percentage":var s=value+"";0===s.indexOf(".")&&(s="0"+s),value=s,output.add("new Fashion.Numeric("+value.replace("%","").replace(/\\/g,"")+', "%")');break;case"String":output.add('new Fashion.Text("'+value+'", "'+me.escapeString(statement.quoteChar)+'")');break;case"Literal":me.booleans.hasOwnProperty(value.toLowerCase())?"true"===value.toLowerCase()?output.add("Fashion.True"):output.add("Fashion.False"):me.colors.hasOwnProperty(value.toLowerCase())?output.add('__rt.color("'+value+'")'):"null"==value?output.add("Fashion.Null"):"none"==value?output.add("Fashion.None"):output.add('new Fashion.Literal("'+value+'")');break;case"Color":output.add('Fashion.ColorRGBA.fromHex("'+value+'")');break;default:output.add('"'+value+'"')}return!1},Transpiler.prototype.FunctionCall=function(statement){var jsId,me=this,output=me.output,args=statement.args,id=statement.id||statement.value,reserved={"if":!0,"else":!0};if(id=reserved[id]?"__"+id:id,jsId=Fashion.getJsName(id),"__if"===jsId){var args=me.loadArgsArray(statement.args),skipWarning=this.skipWarning;output.add("(__rt.unbox("),me.handleStatement(args[0]),output.add(") ? "),this.skipWarning=!0,me.handleStatement(args[1]),output.add(" : "),me.handleStatement(args[2]),output.add(")"),this.skipWarning=skipWarning}else if(me.functionDeclarations[jsId])output.add("__rt.box((__rt.functions."+jsId+" || "+jsId+"__fn).apply(__rt.functions, __rt.applySplatArgs(["),output.indent(),me.createCallArray(statement.args,me.functionDeclarations[jsId],id),output.unindent(),output.add("])))");else if(me.registeredDeclarations[jsId])output.add("__rt.box(__rt.registered."+jsId+".apply(__rt.registered, __rt.applySplatArgs(["),output.indent(),me.createCallArray(statement.args,me.registeredDeclarations[jsId],id,!0),output.unindent(),output.add("])))");else{args=this.loadArgsArray(args),output.add('new Fashion.FunctionCall("'),output.add(me.handleInlineExpressions(id)),output.add('", new Fashion.List(['),output.indent(),output.addln();for(var a=0;a<args.length;a++){var arg=args[a];me.handleStatement(arg),a<args.length-1&&(output.add(","),output.space())}output.unindentln('], ","))')}return!1},Transpiler.prototype.Extend=function(statement){return this.output.addln("__rt.extendSelector("),this.handleStatement(statement.selector),this.output.add(");"),!1},Transpiler.prototype.ParentheticalExpression=function(statement){return this.isSelector?(this.output.addln("new Fashion.ParentheticalExpression("),this.handleStatement(statement.expr),this.output.add(")")):this.handleStatement(statement.expr),!1},Transpiler.prototype.List=function(statement){var output=this.output,isMap=!1;if(statement.items.length&&statement.items[0].isKVP&&(isMap=!0),isMap){output.add("new Fashion.Map([");for(var i=0;i<statement.items.length;i++){var item=statement.items[i];this.handleStatement(item.variable),output.add(","),output.space(),this.handleStatement(item),i<statement.items.length-1&&(output.add(","),output.space())}output.add("])")}else{output.add("new Fashion.List([");for(var i=0;i<statement.items.length;i++){var item=statement.items[i];this.handleStatement(item),i<statement.items.length-1&&(output.add(","),output.space())}output.add('], "'+statement.separator+'")')}return!1},Transpiler.prototype.Warn=function(statement){return this.output.addln("Fashion.warn(__rt.unbox("),this.handleStatement(statement.expr),this.output.add("));"),!1},Transpiler.prototype.Debugger=function(statement){return this.output.addln("debugger;"),!1},Transpiler.prototype.Import=function(statement){var _this=this,me=this,output=me.output,source=statement.source;return source="List"!==source.type&&"SelectorList"!==source.type||!source.separator||0!==source.separator.indexOf(",")?[source]:source.items,this.isSelector=statement.source,source.forEach(function(source){source&&(output.addln('__rt.addDirectiveRuleset("@import", '),"MultiPartSelector"===source.type&&1===source.items.length&&(source=source.items[0]),source&&"CompoundSelector"===source.type&&1===source.items.length&&(source=source.items[0]),source.type&&"String"!==source.dataType&&"Literal"!==source.dataType?_this.handleStatement(source):(source.type||(source=new Fashion.parse.Constant({value:source,dataType:"String",quoteChar:'"'})),0!==source.value.indexOf("http://")&&0!==source.value.indexOf("//")&&(source=new Fashion.parse.FunctionCall({id:"url",args:[new Fashion.parse.FunctionCall({id:"unquote",args:[source]})]})),_this.handleStatement(source)),output.add(");"))}),this.isSelector=null,!1},Transpiler.prototype.Require=function(statement){return!1},Transpiler.prototype.Assignment=function(statement){return this.output.addln('new Fashion.Literal(["'),this.output.add(this.handleInlineExpressions(statement.id)),this.output.add(statement.operator+'", '),this.handleStatement(statement.expr),this.output.add('].join(""))'),!1},Transpiler.prototype.Debug=function(statement){this.output.addln("Fashion.debug(__rt.unbox("),this.handleStatement(statement.expr),this.output.add("));")},Transpiler.prototype.Charset=function(statement){return!1},Transpiler.prototype.SelectorPart=function(statement){var output=this.output;return output.add("new Fashion.SelectorPart("),this.handleStatement(statement.value),output.add(', "'+statement.selectorType+'")'),!1},Transpiler.prototype.CompoundSelector=function(statement){var output=this.output;output.add("new Fashion.CompoundSelector([");for(var i=0;i<statement.items.length;i++){var item=statement.items[i];this.handleStatement(item),i<statement.items.length-1&&(output.add(","),output.space())}return output.add("], true)"),!1},Transpiler.prototype.MultiPartSelector=function(statement){var output=this.output;output.add("new Fashion.MultiPartSelector([");for(var i=0;i<statement.items.length;i++){var item=statement.items[i];this.handleStatement(item),i<statement.items.length-1&&(output.add(","),output.space())}return output.add("])"),!1},Transpiler.prototype.SelectorList=function(statement){var output=this.output;output.add("new Fashion.SelectorList([");for(var i=0;i<statement.items.length;i++){var item=statement.items[i];this.handleStatement(item),i<statement.items.length-1&&(output.add(","),output.space())}return output.add("])"),!1},Transpiler.prototype.SelectorProperty=function(statement){var output=this.output;return output.add("new Fashion.SelectorProperty("),this.handleStatement(statement.property),output.add(", "),this.handleStatement(statement.value),output.add(")"),!1},Transpiler.prototype.Default=function(statement){this.warn("Unrecognized statement type: "+statement.type+" , "+JSON.stringify(statement,null,4))},Transpiler.prototype.error=function(message,data){Fashion.error(message,data),this.errors++},Transpiler.prototype.warn=function(message,data){Fashion.warn(message,data),this.warnings++},Transpiler.prototype.transpile=function(ast,disableGetter){var sortedAst,me=this,preprocessor=this.preprocessor;return me.reset(),preprocessor||(preprocessor=new Fashion.Preprocessor,preprocessor.preprocess(ast)),me.functionDeclarations=preprocessor.functionDeclarations,me.mixinDeclarations=preprocessor.mixinDeclarations,me.registeredDeclarations=preprocessor.registeredDeclarations,me.variables=preprocessor.getVariables(),me.dynamicVariables=preprocessor.getDynamicsMap(),me.processedVariables={},sortedAst=preprocessor.getSortedDynamicAstNodes(),Array.isArray(ast)?sortedAst.push.apply(sortedAst,ast):sortedAst.push(ast),me.nestedDocs=!1,me.handleStatements(sortedAst),me.warnings&&Fashion.warn("Sass compilation encountered "+me.warnings+" warning(s)"),me.errors&&Fashion.raise("Sass compilation encountered "+me.errors+" error(s)"),me.output.get().trim()},Transpiler}(Fashion.Visitor);Fashion.Transpiler=Transpiler}(Fashion||(Fashion={}));var Fashion;!function(Fashion){function parseSelectors(selector){return(new Fashion.Builder).getContext().parseSelectors(selector)}var BaseSelector=function(_super){function BaseSelector(){_super.apply(this,arguments),this.$canUnbox=!1}return __extends(BaseSelector,_super),BaseSelector.prototype.clone=function(match,replace){if(match&&match===""+this)return replace.clone();var cloned=_super.prototype.clone.call(this);return this.parent&&cloned.setParent(this.parent.clone(match,replace)),cloned},BaseSelector.prototype.hasHash=function(hash){return""+this===hash},BaseSelector.prototype.setParent=function(parent){this.parent=parent},BaseSelector}(Fashion.Type);Fashion.BaseSelector=BaseSelector;var BaseSelectorPart=function(_super){function BaseSelectorPart(){_super.apply(this,arguments)}return __extends(BaseSelectorPart,_super),BaseSelectorPart}(BaseSelector);Fashion.BaseSelectorPart=BaseSelectorPart;var SelectorProperty=function(_super){function SelectorProperty(property,value){_super.call(this),this.property=property,this.value=value}return __extends(SelectorProperty,_super),SelectorProperty.prototype.toString=function(){return""+this.property+": "+this.value},SelectorProperty.prototype.doVisit=function(visitor){visitor.selectorproperty(this)},SelectorProperty.prototype.descend=function(visitor){this.value&&visitor.visit(this.value)},SelectorProperty}(BaseSelectorPart);Fashion.SelectorProperty=SelectorProperty,Fashion.apply(SelectorProperty.prototype,{type:"selectorproperty"});var BaseSelectorList=function(_super){function BaseSelectorList(items,separator){_super.call(this),this.items=items,this.separator=separator}return __extends(BaseSelectorList,_super),BaseSelectorList.prototype.toString=function(){return this.items.join(this.separator)},BaseSelectorList.prototype.cloneItems=function(match,replace){for(var cloned=[],i=0;i<this.items.length;i++)cloned.push(this.items[i].clone(match,replace));return cloned},BaseSelectorList.prototype.unquote=function(){for(var items=[],i=0;i<this.items.length;i++)this.items[i]&&items.push(this.items[i].unquote());return new Fashion.List(items,this.separator)},BaseSelectorList.prototype.getHash=function(){var items=[];return this.items.forEach(function(i){return items.push(i&&i.getHash()||"")}),items=items.sort(),items.join(this.separator)},BaseSelectorList}(BaseSelector);Fashion.BaseSelectorList=BaseSelectorList,Fashion.mixin(BaseSelectorList,Fashion.BaseSet),Fashion.parseSelectors=parseSelectors}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var SelectorPart=function(_super){function SelectorPart(value,type){_super.call(this),this.value=value,this.selectorType=type}return __extends(SelectorPart,_super),SelectorPart.prototype.doVisit=function(visitor){visitor.selector(this)},SelectorPart.prototype.descend=function(visitor){this.value&&visitor.visit(this.value)},SelectorPart.prototype.toString=function(){switch(this.selectorType){case"placeholder":return"%"+this.value;case"dash":return"-"+this.value;case"attribute":return"["+this.value+"]";case"pseudo":return":"+this.value;default:return""+this.value}},SelectorPart.prototype.clone=function(match,replace){if(match&&match===""+this)return replace.clone();var cloned=new SelectorPart(this.value,this.selectorType);return this.parent&&cloned.setParent(this.parent.clone(match,replace)),cloned},SelectorPart.prototype.getTypePriority=function(){switch(this.selectorType){case"class":return 0;case"id":return 1;case"pseudo":var str=""+this.value;return 0===str.indexOf(":")?21:0===str.indexOf("not")?19:20;case"attribute":return 0;case"placeholder":return-100;default:return-50}},SelectorPart}(Fashion.BaseSelector);Fashion.SelectorPart=SelectorPart,Fashion.apply(SelectorPart.prototype,{type:"selector",$isFashionSelectorPart:!0})}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var CompoundSelector=function(_super){function CompoundSelector(items,preserve){_super.call(this),this._superSelectorMap={},this.items=items,this.preserve=preserve}return __extends(CompoundSelector,_super),CompoundSelector.prototype.doVisit=function(visitor){visitor.compoundselector(this)},CompoundSelector.prototype.descend=function(visitor){for(var i=0;i<this.items.length;i++){var item=this.items[i];item&&visitor.visit(item)}},CompoundSelector.prototype.cloneItems=function(match,replace){for(var cloned=[],i=0;i<this.items.length;i++)cloned.push(this.items[i].clone(match,replace));return cloned},CompoundSelector.prototype.clone=function(match,replace){if(match&&match===""+this)return replace.clone();var cloned=new CompoundSelector(this.cloneItems(match,replace));return this.parent&&cloned.setParent(this.parent.clone(match,replace)),cloned},CompoundSelector.prototype.toString=function(){return this.items.join("")},CompoundSelector.prototype.hasPlaceholder=function(){for(var i=0;i<this.items.length;i++){var item=this.items[i];if(item instanceof Fashion.SelectorPart&&"placeholder"===item.selectorType)return!0}if(this.parent){var parent=this.parent;return parent.hasPlaceholder&&parent.hasPlaceholder()}return!1},CompoundSelector.prototype.flatten=function(){if(!this.flattened){this.flattened=!0;for(var flattened=[],map={},i=0;i<this.items.length;i++){var item=this.items[i];if(item instanceof CompoundSelector)for(var sel=item,selItems=sel.flatten()&&sel.items,s=0;s<selItems.length;s++){var sItem=selItems[s];sItem.position=flattened.length,map[""+sItem]||(flattened.push(sItem),map[""+sItem]=!0)}else if(item instanceof Fashion.BaseSelectorList){var list=item;if(1==list.items.length){var sItem=list.items[0];sItem.position=flattened.length,map[""+sItem]||(flattened.push(sItem),map[""+sItem]=!0)}else item.position=flattened.length,map[""+sItem]||(flattened.push(sItem),map[""+sItem]=!0)}else{var sItem=item;sItem.position=flattened.length,(!map[""+sItem]||item instanceof Fashion.Literal||item instanceof Fashion.Numeric)&&(flattened.push(sItem),map[""+sItem]=!0)}}this.items=flattened}return this},CompoundSelector.prototype.sort=function(){return this.sorted||(this.sorted=!0,this.flatten(),this.items.sort(function(a,b){var aPart,bPart,aIsPart=a instanceof Fashion.SelectorPart,bIsPart=b instanceof Fashion.SelectorPart,aIsSelector=a instanceof Fashion.BaseSelector,bIsSelector=b instanceof Fashion.BaseSelector,aVal=""+a,bVal=""+b;if(bIsSelector){if(!aIsSelector){if(a instanceof Fashion.Literal&&0===(""+a).indexOf("-"))return 1;if(!CompoundSelector.excludeSortOps[bVal])return-1}if(bIsPart){if(!aIsPart)return-1;aPart=a,bPart=b;var res=aPart.getTypePriority()-bPart.getTypePriority();return 0===res?aPart.position-bPart.position:res}if(aIsPart)return 1}else if(aIsSelector){if(!CompoundSelector.excludeSortOps[aVal])return 1}else b instanceof Fashion.Literal;return a.position-b.position})),this},CompoundSelector.prototype.base=function(){var first=this.first();return first instanceof Fashion.Literal?first:first instanceof Fashion.SelectorPart&&"wildcard"===first.selectorType?first:null},CompoundSelector.prototype.getHash=function(){
var base=this.base(),rest=this.rest(),parts=[];return rest.forEach(function(r){return parts.push(r.getHash())}),parts=parts.sort(),base&&parts.unshift(base.getHash()),parts.join("")},CompoundSelector.prototype.rest=function(){var base=this.base();return Fashion.filter(this.items,function(item){return base?item!==base:!0})},CompoundSelector.prototype.isSuperSelector=function(selector){var key=selector,map=this._superSelectorMap,result=map[key];return void 0===result&&(result=this.isSubset(selector),map[key]=result),result},CompoundSelector.prototype.isSubset=function(selector){var item,items=this.items,sItems=selector.items,longItemMap={},shortList=items,longList=sItems,res=1;items.length>sItems.length&&(shortList=sItems,longList=items,res=-1);for(var i=0;i<longList.length;i++)item=longList[i],longItemMap[""+item]=item;for(var i=0;i<shortList.length;i++)if(item=shortList[i],!longItemMap[""+item])return 0;return res},CompoundSelector.excludeSortOps={"&":!0,"*":!0,"~":!0,">":!0,"|":!0,"+":!0},CompoundSelector}(Fashion.BaseSelectorPart);Fashion.CompoundSelector=CompoundSelector,Fashion.mixin(CompoundSelector,Fashion.BaseSet),Fashion.apply(CompoundSelector.prototype,{type:"compoundselector",$isFashionCompoundSelector:!0,$canUnbox:!1})}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var MultiPartSelector=function(_super){function MultiPartSelector(items,parent){_super.call(this,items," "),this._superSelectorMap={},parent&&this.setParent(parent)}return __extends(MultiPartSelector,_super),MultiPartSelector.prototype.doVisit=function(visitor){visitor.multipartselector(this)},MultiPartSelector.prototype.descend=function(visitor){for(var i=0;i<this.items.length;i++){var item=this.items[i];item&&visitor.visit(item)}},MultiPartSelector.prototype.clone=function(match,replace){if(match&&match===""+this)return replace.clone();var cloned=new MultiPartSelector(this.cloneItems(match,replace));return this.parent&&cloned.setParent(this.parent.clone(match,replace)),cloned.skipParentPrepend=this.skipParentPrepend,cloned},MultiPartSelector.prototype.calcIsSuperSelector=function(selector){var tmpRes,items=this.items,sItems=selector.items,shortList=items,longList=sItems,res=1;if(items.length>sItems.length&&(shortList=sItems,longList=items,res=-1),this.parent){if(!selector.parent)return 0;if(tmpRes=this.parent.isSuperSelector(selector.parent),res!==tmpRes)return 0}else if(selector.parent)return 0;for(var i=0;i<shortList.length;i++){var tmpRes;if(0===tmpRes)return 0;if(tmpRes!==res)return 0}return res},MultiPartSelector.prototype.isSuperSelector=function(selector){var key=selector,map=this._superSelectorMap,result=map[key];return void 0===result&&(result=this.calcIsSuperSelector(selector),map[key]=result),result},MultiPartSelector.prototype.removeAtRoot=function(){var items=Fashion.filter(this.items,function(item){return""+item!="@at-root"});return items.length?(this.items=items,this):null},MultiPartSelector}(Fashion.BaseSelectorList);Fashion.MultiPartSelector=MultiPartSelector,Fashion.apply(MultiPartSelector.prototype,{type:"multipartselector"})}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var SelectorList=function(_super){function SelectorList(list){_super.call(this,list,",")}return __extends(SelectorList,_super),SelectorList.prototype.doVisit=function(visitor){visitor.selectorlist(this)},SelectorList.prototype.descend=function(visitor){for(var i=0;i<this.items.length;i++){var item=this.items[i];item&&visitor.visit(item)}},SelectorList.prototype.clone=function(match,replace){var cloned=new SelectorList(this.cloneItems());return this.parent&&cloned.setParent(this.parent.clone(match,replace)),cloned},SelectorList.prototype.applyInterpolations=function(){if(!this.interpolated){this.interpolated=!0;for(var selector,str,parsedSelectors,items,item,i,interpolated=[],selectors=this.items,s=0;s<selectors.length;s++)if(selector=selectors[s],str=""+selector,-1===str.indexOf(","))interpolated.push(selector);else for(parsedSelectors=Fashion.parseSelectors(str),items=parsedSelectors.items,i=0;i<items.length;i++)item=items[i],interpolated.push(item);this.items=interpolated}},SelectorList}(Fashion.BaseSelectorList);Fashion.SelectorList=SelectorList,Fashion.apply(SelectorList.prototype,{type:"selectorlist"}),Fashion.EmptySelectorList=new SelectorList({})}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var Ruleset=function(_super){function Ruleset(cfg){_super.call(this),this.children=[],cfg&&Fashion.apply(this,cfg),this.selectors=this.selectors||new Fashion.SelectorList([]),this.declarations=this.declarations||[]}return __extends(Ruleset,_super),Ruleset.prototype.doVisit=function(visitor){visitor.ruleset(this)},Ruleset.prototype.descend=function(visitor){visitor.visit(this.selectors),visitor.visit(this.declarations),visitor.visit(this.children)},Ruleset.prototype.addDeclaration=function(declaration,index){declaration.ruleset=this,void 0===index?this.declarations.push(declaration):this.declarations.splice(index,0,declaration)},Ruleset.prototype.getDeclarationIndex=function(decl){for(var i=0;i<this.declarations.length;i++)if(this.declarations[i]===decl)return i;return-1},Ruleset.prototype.removeDeclaration=function(decl){this.declarations=Fashion.filter(this.declarations,function(d){return d!==decl})},Ruleset.prototype.lastDeclaration=function(){return this.declarations.length&&this.declarations[this.declarations.length-1]||null},Ruleset.prototype.addChildRuleset=function(ruleset){this.children.push(ruleset)},Ruleset.prototype.removeChildRuleset=function(child){this.children=Fashion.filter(this.children,function(item){return item!==child})},Ruleset.prototype.getFirstSelector=function(){var selectors=this.selectors;return selectors instanceof Fashion.SelectorList&&(selectors=selectors.items[0]),selectors instanceof Fashion.MultiPartSelector&&(selectors=selectors.items[0]),selectors},Ruleset.prototype.getFirstSelectorStr=function(){return void 0===this._firstSelectorStr&&(this._firstSelectorStr=this.getFirstSelector()+""),this._firstSelectorStr},Ruleset.prototype.isAtRule=function(){return 0===this.getFirstSelectorStr().indexOf("@")},Ruleset.prototype.isMedia=function(){return 0===this.getFirstSelectorStr().indexOf("@media")},Ruleset.prototype.isKeyFrames=function(){return 0===this.getFirstSelectorStr().indexOf("@keyframes")||0===this.getFirstSelectorStr().indexOf("@-webkit-keyframes")},Ruleset.prototype.isPage=function(){return this.isAtRule()&&0===this.getFirstSelectorStr().indexOf("@page")},Ruleset.prototype.isAtRoot=function(){return this.isAtRule()&&0===this.getFirstSelectorStr().indexOf("@at-root")},Ruleset.prototype.isDirective=function(){return this.isAtRule()&&!this.isMedia()&&0===this.declarations.length&&0===this.children.length},Ruleset.prototype.printAtRoot=function(){return this.isMedia()||this.isAtRoot()},Ruleset}(Fashion.Type);Fashion.Ruleset=Ruleset,Fashion.apply(Ruleset.prototype,{type:"ruleset",$isFashionRuleset:!0,$canUnbox:!1})}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var CompressedOutput=function(_super){function CompressedOutput(){_super.call(this),this.isCompressed=!0}return __extends(CompressedOutput,_super),CompressedOutput.prototype.space=function(){},CompressedOutput.prototype.addComment=function(text){},CompressedOutput.prototype.indent=function(){},CompressedOutput.prototype.unindent=function(){},CompressedOutput.prototype.addln=function(ln){_super.prototype.add.call(this,ln||"")},CompressedOutput.prototype.addCommentLn=function(ln){},CompressedOutput.prototype.indentln=function(ln){this.addln(ln)},CompressedOutput.prototype.unindentln=function(ln){this.addln(ln)},CompressedOutput}(Fashion.Output);Fashion.CompressedOutput=CompressedOutput}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var TypeVisitor=function(){function TypeVisitor(cfg){cfg&&Fashion.apply(this,cfg)}return TypeVisitor.prototype.literal=function(obj){obj.descend(this)},TypeVisitor.prototype.bool=function(obj){obj.descend(this)},TypeVisitor.prototype.string=function(obj){obj.descend(this)},TypeVisitor.prototype.number=function(obj){obj.descend(this)},TypeVisitor.prototype.map=function(obj){obj.descend(this)},TypeVisitor.prototype.functioncall=function(obj){obj.descend(this)},TypeVisitor.prototype.parenthetical=function(obj){obj.descend(this)},TypeVisitor.prototype.list=function(obj){obj.descend(this)},TypeVisitor.prototype.hsla=function(obj){obj.descend(this)},TypeVisitor.prototype.rgba=function(obj){obj.descend(this)},TypeVisitor.prototype.colorstop=function(obj){obj.descend(this)},TypeVisitor.prototype.lineargradient=function(obj){obj.descend(this)},TypeVisitor.prototype.radialgradient=function(obj){obj.descend(this)},TypeVisitor.prototype.selector=function(obj){obj.descend(this)},TypeVisitor.prototype.selectorproperty=function(obj){obj.descend(this)},TypeVisitor.prototype.compoundselector=function(obj){obj.descend(this)},TypeVisitor.prototype.multipartselector=function(obj){obj.descend(this)},TypeVisitor.prototype.selectorlist=function(obj){obj.descend(this)},TypeVisitor.prototype.declaration=function(obj){obj.descend(this)},TypeVisitor.prototype.ruleset=function(obj){obj.descend(this)},TypeVisitor.prototype.visitItem=function(obj){obj.doVisit(this)},TypeVisitor.prototype.visit=function(obj){for(;obj&&void 0!==obj.visitTarget;)obj=obj.visitTarget;if(obj)if(Array.isArray(obj))for(var i=0;i<obj.length;i++)this.visit(obj[i]);else this.visitItem(obj)},TypeVisitor.prototype.execute=function(obj,context){this.visit(obj)},TypeVisitor}();Fashion.TypeVisitor=TypeVisitor}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var CssPostprocessor=function(_super){function CssPostprocessor(cfg){_super.call(this,cfg)}return __extends(CssPostprocessor,_super),CssPostprocessor.prototype.selector=function(obj){"parent"===obj.selectorType&&this.currentParentSelector&&(obj.visitTarget=this.currentParentSelector,this.parentUsed=!0)},CssPostprocessor.prototype.literal=function(obj){"&"===obj.value&&this.currentParentSelector&&(obj.visitTarget=this.currentParentSelector)},CssPostprocessor.prototype.getSelectorArray=function(selectors,applyInterpolations){if(selectors instanceof Fashion.SelectorList)applyInterpolations&&selectors.applyInterpolations(),selectors=selectors.items;else{var str=""+selectors;if(str.indexOf(",")>-1&&applyInterpolations)return this.getSelectorArray(this.context.parseSelectors(str));selectors=[selectors]}return selectors},CssPostprocessor.prototype.combineSelectors=function(parent,child){var p,c,parentSelector,childSelector,parentSelectors=this.getSelectorArray(parent.selectors),childSelectors=this.getSelectorArray(child.selectors),expandedSelectors=[],plen=parentSelectors.length,clen=childSelectors.length;for(p=0;plen>p;p++)for(parentSelector=parentSelectors[p],this.currentParentSelector=parentSelector,c=0;clen>c;c++)childSelector=childSelectors[c].clone(),this.parentUsed=!1,this.visit(childSelector),this.parentUsed||(childSelector=new Fashion.MultiPartSelector([parentSelector,childSelector])),expandedSelectors.push(childSelector);this.currentParentSelector=null,expandedSelectors=1==expandedSelectors.length?expandedSelectors[0]:new Fashion.SelectorList(expandedSelectors),child.selectors=expandedSelectors},CssPostprocessor.prototype.combineMediaSelectors=function(parent,child){for(var parentSelector,nestedSelector,expanded=[],selectors=this.getSelectorArray(parent.selectors),items=this.getSelectorArray(child.selectors),s=0;s<selectors.length;s++){parentSelector=selectors[s];for(var n=0;n<items.length;n++){nestedSelector=items[n],0===n&&(nestedSelector.items=nestedSelector.items.slice(1)),this.currentParentSelector=parentSelector,this.parentUsed=!1,this.visit(nestedSelector),this.parentUsed=!1;var newSelector=new Fashion.MultiPartSelector([parentSelector,new Fashion.Literal("and"),nestedSelector]);newSelector.skipParentPrepend=child.isAtRoot(),expanded.push(newSelector)}}expanded=1===expanded.length?expanded[0]:new Fashion.SelectorList(expanded),child.selectors=expanded},CssPostprocessor.prototype.declaration=function(obj){var declWas=this.currDeclaration;this.currDeclaration=obj,obj.descend(this),this.currDeclaration=declWas},CssPostprocessor.prototype.ruleset=function(obj){var parent,ns,d,decl,idx,prevMedia=this.prevMedia,prevAtRoot=this.prevAtRoot,prevAtRule=this.prevAtRule,prevPlain=this.prevPlain,atRoot=!1,declaration=this.currDeclaration;if(obj.isNamespaced){if(this.visit(obj.declarations),declaration){for(ns=declaration.property,parent=declaration.ruleset,idx=parent.getDeclarationIndex(declaration),-1===idx&&(idx=parent.declarations.length),d=0;d<obj.declarations.length;d++)decl=obj.declarations[d],parent.addDeclaration(new Fashion.Declaration({property:ns+"-"+decl.property,value:decl.value,docs:decl.docs,sourceInfo:decl.sourceInfo,important:decl.important}),d+idx);obj.visitTarget=null,obj.parentNode===declaration&&parent.removeDeclaration(declaration)}return!1}if(obj.selectors=this.getSelectorArray(obj.selectors,!0),1===obj.selectors.length?obj.selectors=obj.selectors[0]:obj.selectors=new Fashion.SelectorList(obj.selectors),obj.isAtRule()){if(this.prevAtRule=obj,prevPlain&&obj.declarations.length){var newRuleset=new Fashion.Ruleset({parent:obj,declarations:obj.declarations,selectors:prevPlain.selectors,isMediaRoot:!0});newRuleset.declarations.forEach(function(d){return d.ruleset=newRuleset}),obj.declarations=[],obj.children.unshift(newRuleset)}prevAtRule||(atRoot=!0)}return obj.isMedia()?(prevMedia&&this.combineMediaSelectors(prevMedia,obj),this.prevMedia=obj,atRoot=!0):obj.isAtRoot()?atRoot=!0:obj.isAtRule()||(prevPlain&&!obj.isMediaRoot&&this.combineSelectors(prevPlain,obj),this.prevPlain=obj,prevAtRule||(atRoot=!0)),atRoot&&(obj.parent&&obj.parent.removeChildRuleset(obj),(obj.isAtRule()||obj.declarations.length||obj.isAtDirective)&&this.rootCss.push(obj)),obj.descend(this),this.prevMedia=prevMedia,this.prevAtRoot=prevAtRoot,this.prevPlain=prevPlain,this.prevAtRule=prevAtRule,!1},CssPostprocessor.prototype.visitItem=function(obj){var currParent=this.currParent;obj.parentNode=currParent,this.currParent=obj,_super.prototype.visitItem.call(this,obj),this.currParent=currParent},CssPostprocessor.prototype.process=function(obj){return this.rootCss=[],this.visit(obj),this.rootCss},CssPostprocessor}(Fashion.TypeVisitor);Fashion.CssPostprocessor=CssPostprocessor}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var ExtendProcessor=function(_super){function ExtendProcessor(cfg){_super.call(this,cfg)}return __extends(ExtendProcessor,_super),ExtendProcessor.prototype.mergeCompoundSelector=function(match,extendSelector,matchKeys,targetKeys){for(var newCompoundSelector,matchIndex,compoundSelector=this.currCompoundSelector,multiPartSelector=this.currMultiPartSelector,items=[],i=0;i<compoundSelector.items.length;i++){var item=compoundSelector.items[i],hash=item.getHash();targetKeys?targetKeys.hasOwnProperty(hash)?(matchIndex=i,items.push(null)):items.push(item):hash!=match.getHash()?items.push(item):(matchIndex=i,items.push(null))}if(extendSelector instanceof Fashion.MultiPartSelector){var newSelector=extendSelector.clone(),last=newSelector.last();if(last instanceof Fashion.CompoundSelector){var cItems=last.items;items=Fashion.filter(items,function(item){return!!item}),last.items=items.concat(cItems)}else last=new Fashion.CompoundSelector([last].concat(items)),newSelector.items[newSelector.items.length-1]=last;newCompoundSelector=newSelector}else extendSelector instanceof Fashion.CompoundSelector?items.splice.apply(items,[matchIndex,1].concat(extendSelector.items)):items[matchIndex]=extendSelector;if(newCompoundSelector=newCompoundSelector||new Fashion.CompoundSelector(items),multiPartSelector){for(var newItems=[],i=0;i<multiPartSelector.items.length;i++){var item=multiPartSelector.items[i];item===compoundSelector?newItems.push(newCompoundSelector):newItems.push(item)}this.newSelectors.push(new Fashion.MultiPartSelector(newItems))}else this.newSelectors.push(newCompoundSelector)},ExtendProcessor.prototype.mergeMultiPartSelector=function(match,extendSelector){var i,item,before,after,multiPartSelector=this.currMultiPartSelector,items=multiPartSelector.items,len=items.length;for(i=0;len>i;i++)if(item=items[i],item.getHash()===match.getHash())if(before=items.slice(0,i),after=items.slice(i+1),extendSelector instanceof Fashion.MultiPartSelector){var mpExtendSelector=extendSelector,extendItems=mpExtendSelector.items,elen=extendItems.length,first=extendItems.slice(0,elen-2),last=extendItems.slice(elen-1);this.newSelectors.push(new Fashion.MultiPartSelector(before.concat(first).concat(last).concat(after))),this.newSelectors.push(new Fashion.MultiPartSelector(first.concat(before).concat(last).concat(after)))}else this.newSelectors.push(new Fashion.MultiPartSelector(before.concat(extendSelector).concat(after)))},ExtendProcessor.prototype.checkSelectorPart=function(obj){if(obj.getHash()===this.currTargetHash)if(this.currCompoundSelector)for(var e=0;e<this.extendSelectors.length;e++){var extendSelector=this.extendSelectors[e];this.mergeCompoundSelector(obj,extendSelector)}else if(this.currMultiPartSelector)for(var e=0;e<this.extendSelectors.length;e++){var extendSelector=this.extendSelectors[e];this.mergeMultiPartSelector(obj,extendSelector)}else this.appendAllExtendSelectors()},ExtendProcessor.prototype.appendAllExtendSelectors=function(){this.newSelectors.push.apply(this.newSelectors,this.extendSelectors)},ExtendProcessor.prototype.getCompoundSelectorMap=function(compoundSelector){var map={};return compoundSelector.items.forEach(function(i){return map[i.getHash()]=!0}),map},ExtendProcessor.prototype.literal=function(obj){this.checkSelectorPart(obj)},ExtendProcessor.prototype.selector=function(obj){this.checkSelectorPart(obj)},ExtendProcessor.prototype.compoundselector=function(obj){var resetCompoundSelector=this.currCompoundSelector;if(this.currCompoundSelector=obj,obj.getHash()===this.currTargetHash)this.appendAllExtendSelectors();else if(this.currTarget instanceof Fashion.CompoundSelector){for(var targetKey,objMap=this.getCompoundSelectorMap(obj),targetMap=this.getCompoundSelectorMap(this.currTarget),objKeys=Object.keys(objMap),targetKeys=Object.keys(targetMap),subset=!0,t=0;t<targetKeys.length;t++)if(targetKey=targetKeys[t],!objKeys.hasOwnProperty(targetKey)){subset=!1;break}if(subset)for(var e=0;e<this.extendSelectors.length;e++){var extendSelector=this.extendSelectors[e];this.mergeCompoundSelector(obj,extendSelector,objKeys,targetKeys)}}else obj.descend(this);return this.currCompoundSelector=resetCompoundSelector,!1},ExtendProcessor.prototype.multipartselector=function(obj){var resetMultiPartSelector=this.currMultiPartSelector;return this.currMultiPartSelector=obj,obj.getHash()===this.currTargetHash?this.appendAllExtendSelectors():obj.descend(this),this.currMultiPartSelector=resetMultiPartSelector,!1},ExtendProcessor.prototype.extend=function(ruleset,targetSelector,extendSelectors){var i,j,newSelector,hash;if(this.currTarget=targetSelector,this.currTargetHash=this.currTarget.getHash(),this.newSelectors=[],this.extendSelectors=extendSelectors,this.visit(ruleset.selectors),this.newSelectors.length){var selectors=ruleset.selectors,map={};for(selectors=selectors instanceof Fashion.SelectorList?selectors.items:[selectors],i=0;i<selectors.length;i++)map[selectors[i].getHash()]=!0;for(i=0;i<this.newSelectors.length;i++)newSelector=this.newSelectors[i],hash=newSelector.getHash(),map.hasOwnProperty(hash)||(selectors.push(newSelector),map[hash]=!0);for(i=0;i<selectors.length;i++)for(j=0;j<selectors.length;j++)if(i!=j&&selectors[i]&&selectors[j]){var comp=this.compareSelectors(selectors[i],selectors[j]);0!==comp&&(comp>1?selectors[i]=null:selectors[j]=null)}selectors=Fashion.filter(selectors,function(s){return!!s}),ruleset.selectors=new Fashion.SelectorList(selectors)}for(var c=0;c<ruleset.children.length;c++)this.extend(ruleset.children[c],targetSelector,extendSelectors)},ExtendProcessor.prototype.compareSelectors=function(sel1,sel2){if(sel1 instanceof Fashion.MultiPartSelector)return sel2 instanceof Fashion.MultiPartSelector||(sel2=new Fashion.MultiPartSelector([sel2])),this.isSuperSelector(sel1,sel2);if(sel2 instanceof Fashion.MultiPartSelector)return sel1=new Fashion.MultiPartSelector([sel1]),this.isSuperSelector(sel1,sel2);if(sel1 instanceof Fashion.CompoundSelector)return sel2 instanceof Fashion.CompoundSelector||(sel2=new Fashion.CompoundSelector([sel2])),this.isSubset(sel1,sel2);if(sel2 instanceof Fashion.CompoundSelector)return sel1=new Fashion.CompoundSelector([sel1]),this.isSubset(sel1,sel2);var h1=sel1.getHash(),h2=sel2.getHash();return h1==h2?1:0},ExtendProcessor.prototype.isSuperSelector=function(sel1,sel2){var tmpRes,items=sel1.items,sItems=sel2.items,shortList=items,longList=sItems,res=1;items.length>sItems.length&&(shortList=sItems,longList=items,res=-1);for(var i=0;i<shortList.length;i++){tmpRes=this.compareSelectors(shortList[i],longList[i]);var tmpRes;if(0===tmpRes)return 0;if(tmpRes!==res)return 0}return res},ExtendProcessor.prototype.isSubset=function(sel1,sel2){var item,items=sel1.items,sItems=sel2.items,longItemMap={},shortList=items,longList=sItems,res=1;items.length>sItems.length&&(shortList=sItems,longList=items,res=-1);for(var i=0;i<longList.length;i++)item=longList[i],longItemMap[item.getHash()]=item;for(var i=0;i<shortList.length;i++)if(item=shortList[i],!longItemMap[item.getHash()])return 0;return res},ExtendProcessor.prototype.extendRulesets=function(rulesets,extenders){var _this=this;extenders.forEach(function(extender){extender.extend.forEach(function(extend){rulesets.forEach(function(ruleset){var extendSelectors=extender.selectors;extendSelectors=extendSelectors instanceof Fashion.SelectorList?extendSelectors.items:[extendSelectors],_this.extend(ruleset,extend,extendSelectors)})})})},ExtendProcessor}(Fashion.TypeVisitor);Fashion.ExtendProcessor=ExtendProcessor}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var SourceBuilder=function(_super){function SourceBuilder(cfg){_super.call(this,cfg),this.selectorCount=0}return __extends(SourceBuilder,_super),SourceBuilder.prototype.list=function(obj){for(var delta,output=this.output,items=obj.items,len=output.output.length,sep=obj.separator,sepLen=sep&&sep.length,hasSpace=sep&&sep.indexOf(" ")>-1,prev=output.output,i=0;i<items.length;i++)items[i]&&(this.visit(items[i]),delta=output.output.length-len,!delta&&sepLen&&i>0&&(output.output=prev),prev=output.output,i<items.length-1&&sepLen&&(output.add(sep),hasSpace||output.space()),len=output.output.length)},SourceBuilder.prototype.map=function(obj){var key,value,output=this.output,items=obj.items;this.currDeclaration&&Fashion.raise("("+obj+") isn't a valid CSS value.");for(var i=0;i<items.length-1;i+=2)key=items[i],value=items[i+1],key&&value&&(i>0&&(output.add(","),output.space()),this.visit(key),output.add(": "),this.visit(value))},SourceBuilder.prototype.literal=function(obj){obj.value&&this.output.add(obj.value)},SourceBuilder.prototype.string=function(obj){var output=this.output;output.add(obj.quoteChar),output.add(obj.value),output.add(obj.quoteChar)},SourceBuilder.prototype.functioncall=function(obj){var output=this.output;output.add(obj.name),output.add("("),this.visit(obj.args),output.add(")")},SourceBuilder.prototype.parenthetical=function(obj){this.output.add("("),this.visit(obj.value),this.output.add(")")},SourceBuilder.prototype.number=function(obj){var val=obj.stringify();"."!==val.indexOf(".")||this.output.isCompressed||(val="0"+val),this.output.add(val)},SourceBuilder.prototype.bool=function(obj){this.output.add(obj.value?"true":"false")},SourceBuilder.prototype.hsla=function(obj){this.output.add(""+obj)},SourceBuilder.prototype.rgba=function(obj){this.output.add(""+obj)},SourceBuilder.prototype.colorstop=function(obj){var output=this.output,stop=obj.stop;this.visit(obj.color),stop&&(stop=stop.clone(),output.add(" "),stop.unit||(stop.value*=100,stop.unit="%"),this.visit(stop))},SourceBuilder.prototype.lineargradient=function(obj){var output=this.output;output.add("linear-gradient("),obj.position&&(this.visit(obj.position),output.add(","),output.space()),this.visit(obj.stops),output.add(")")},SourceBuilder.prototype.radialgradient=function(obj){var output=this.output;output.add("linear-gradient("),obj.position&&(this.visit(obj.position),output.add(","),output.space()),obj.shape&&(this.visit(obj.shape),output.add(","),output.space()),this.visit(obj.stops),output.add(")")},SourceBuilder.prototype.selectorlist=function(obj){var i,items=obj.items,len=items.length,output=this.output;for(i=0;len>i;i++)this.visit(items[i]),len-1>i&&(output.add(","),output.addln(),this.selectorCount++)},SourceBuilder.prototype.selectorproperty=function(obj){this.visit(obj.property),this.output.add(": "),this.visit(obj.value)},SourceBuilder.prototype.multipartselector=function(obj){this.list(obj)},SourceBuilder.prototype.compoundselector=function(obj){this.list(obj.sort())},SourceBuilder.prototype.selector=function(obj){var parentSelector=obj.parent,output=this.output;switch(obj.selectorType){case"parent":if(parentSelector)return this.visit(parent),!1;this.visit(obj.value);break;case"placeholder":output.add("%"),this.visit(obj.value);break;case"dash":output.add("-"),this.visit(obj.value);break;case"attribute":output.add("["),this.visit(obj.value),output.add("]");break;case"pseudo":output.add(":"),this.visit(obj.value);break;default:this.visit(obj.value)}},SourceBuilder.prototype.declaration=function(obj){var output=this.output,currDeclarationWas=this.currDeclaration;if(obj.docs&&obj.docs.length)for(var d=0;d<obj.docs.length;d++)output.addCommentLn(obj.docs[d]);this.currDeclaration=obj,output.addln(),output.add(obj.property),output.add(":"),output.space(),this.visit(obj.value),obj.important&&output.add(" !important"),output.isCompressed?obj!==obj.ruleset.lastDeclaration()&&output.add(";"):output.add(";"),this.currDeclaration=currDeclarationWas},SourceBuilder.prototype.ruleset=function(obj){var output=this.output;if(output.addln(),obj.isAtDirective)return output.add(obj.atDirectiveName),output.add(" "),void(obj.atDirectiveValue?(this.visit(obj.atDirectiveValue),output.add(";")):output.add("{}"));if(obj.sourceInfo&&(output.addComment("/* "+obj.sourceInfo+" */"),output.addln()),obj.docs&&obj.docs.length)for(var d=0;d<obj.docs.length;d++)output.addCommentLn(obj.docs[d]);return obj.selectors&&this.selectorCount++,this.visit(obj.selectors),obj.isAtRule()&&0===obj.declarations.length&&0===obj.children.length&&!obj.hasBlock?void output.add(";"):(output.space(),output.add("{"),output.indent(),this.visit(obj.declarations),void(obj.isAtRule()&&!obj.isAtRoot()?(this.visit(obj.children),output.unindent(),output.addln("}")):(output.unindent(),output.addln("}"),this.visit(obj.children))))},SourceBuilder.prototype.toSource=function(obj,output){return this.output=output||new Fashion.Output,this.visit(obj),this.output.get()},SourceBuilder.toSource=function(obj,output){var sb=new SourceBuilder;return sb.toSource(obj,output)},SourceBuilder}(Fashion.TypeVisitor);Fashion.SourceBuilder=SourceBuilder}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var PlaceholderProcessor=function(_super){function PlaceholderProcessor(cfg){_super.call(this,cfg),this.hasPlaceholder=!1}return __extends(PlaceholderProcessor,_super),PlaceholderProcessor.prototype.literal=function(obj){"%"===obj.getHash()&&(this.hasPlaceholder=!0)},PlaceholderProcessor.prototype.selector=function(obj){"placeholder"===obj.selectorType&&(this.hasPlaceholder=!0)},PlaceholderProcessor.prototype.selectorlist=function(obj){var i,item,items=obj.items,len=items.length,newItems=[];for(i=0;len>i;i++)item=items[i],this.hasPlaceholder=!1,this.visit(item),this.hasPlaceholder||newItems.push(item);return obj.items=newItems,!1},PlaceholderProcessor.prototype.ruleset=function(obj){return this.hasPlaceholder=!1,this.visit(obj.selectors),this.hasPlaceholder&&(obj.selectors=null),this.visit(obj.children),!1},PlaceholderProcessor.prototype.process=function(css){this.visit(css),css.selectors&&0!==css.selectors.length&&this.outCss.push(css)},PlaceholderProcessor.prototype.processRulesets=function(css){this.outCss=[];for(var i=0;i<css.length;i++)this.process(css[i]);return this.outCss},PlaceholderProcessor}(Fashion.TypeVisitor);Fashion.PlaceholderProcessor=PlaceholderProcessor}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var Ready=function(){function Ready(){this.blocks=0,this.listeners=[]}return Ready.prototype.block=function(){this.blocks++},Ready.prototype.unblock=function(){this.blocks&&!--this.blocks&&this.fireReady()},Ready.prototype.fireReady=function(){for(var i=0;i<this.listeners.length;i++){var listener=this.listeners[i];listener(),this.listeners[i]=null}this.listeners=Fashion.filter(this.listeners,function(l){return!!l})},Ready.prototype.onReady=function(callback){this.blocks?this.listeners.push(callback):callback()},Ready}();Fashion.Ready=Ready}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var CSS=function(_super){function CSS(config){_super.call(this,config),this.css=[],this.extenders=[],this.outputs=[]}return __extends(CSS,_super),CSS.prototype.reset=function(){this.css=[]},CSS.prototype.resetOutputs=function(){this.outputs=[],this.output=null},CSS.prototype.addRuleset=function(ruleset){this.css.push(ruleset)},CSS.prototype.createOutput=function(compressed,indent,skipComments,split){var output=compressed?new Fashion.CompressedOutput:new Fashion.Output;return indent&&(output.indentstr=indent),!compressed&&skipComments&&(output.addComment=function(text){},output.addCommentLn=function(text){this.addln()}),split&&(output.splitThreshold=split),this.output=output,this.outputs.push(output),output},CSS.prototype.getOutputs=function(){var out=[];return this.outputs.forEach(function(output){out.push(output.get().trim())}),out},CSS.prototype.getText=function(callBack,compressed,indent,skipComments,split){function postProcess(){var ready,proc=processors.shift();if(proc)ready=new Fashion.Ready,me.ready=ready,proc.execute(css,me),ready.onReady(function(){postProcess()});else{for(var output=me.createOutput(compressed,indent,skipComments,split),c=0;c<css.length;c++){var newCount,newOutput,count=sourceBuilder.selectorCount,len=output.output.length,prevOutput=output.output;sourceBuilder.toSource(css[c],output),newCount=sourceBuilder.selectorCount,newCount>split&&(newOutput=me.createOutput(compressed,indent,skipComments,split),newOutput.output=output.output.substring(len),output.output=prevOutput,sourceBuilder.selectorCount=newCount-count,output=newOutput)}callBack(me.getOutputs())}}this.resetOutputs();var proc,extendProc,placeholderProc,css=this.css,sourceBuilder=new Fashion.SourceBuilder;proc=new Fashion.CssPostprocessor({context:this.context}),css=proc.process(css),extendProc=new Fashion.ExtendProcessor,extendProc.extendRulesets(css,this.extenders),placeholderProc=new Fashion.PlaceholderProcessor,css=placeholderProc.processRulesets(css);var hostDirectives={"@charset":!0,"@import":!0};css.forEach(function(r,i){return r.index=i}),css.sort(function(r1,r2){var d1=!!hostDirectives[r1.atDirectiveName],d2=!!hostDirectives[r2.atDirectiveName];return d1&&!d2?-1:d2&&!d1?1:d1&&d2&&r1.atDirectiveName!=r2.atDirectiveName?"@charset"===r1.atDirectiveName?-1:1:r1.index-r2.index});var me=this,processors=this.processors||[];postProcess()},CSS.prototype.getJSON=function(){var ans={};return ans},CSS}(Fashion.Base);Fashion.CSS=CSS}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var functions;!function(functions){var Color;!function(Color){function init(runtime){runtime.register({adjust_color:function(color,red,green,blue,hue,saturation,lightness,alpha){var adjusted=color.getRGBA().clone(),adjust=Fashion.Color.adjust,comps=Fashion.Color.comps;return red&&(adjusted[comps.red]+=red.value),blue&&(adjusted[comps.blue]+=blue.value),green&&(adjusted[comps.green]+=green.value),alpha&&(adjusted[comps.alpha]=Math.max(0,Math.min(1,adjusted[comps.alpha]+alpha.value))),hue&&(adjusted=adjust(adjusted,"hue",hue)),
lightness&&(adjusted=adjust(adjusted,"lightness",lightness)),saturation&&(adjusted=adjust(adjusted,"saturation",saturation)),adjusted},scale_color:function(){},change_color:function(color,red,green,blue,hue,saturation,lightness,alpha){var adjusted=color.getRGBA().clone(),comps=(Fashion.Color.adjust,Fashion.Color.comps);return red&&(adjusted[comps.red]=red.value),blue&&(adjusted[comps.blue]=blue.value),green&&(adjusted[comps.green]=green.value),alpha&&(adjusted[comps.alpha]=Math.max(0,Math.min(1,alpha.value))),hue&&(adjusted=adjusted.getHSLA())&&(adjusted.h=hue.value),lightness&&(adjusted=adjusted.getHSLA())&&(adjusted.l=lightness.value),saturation&&(adjusted=adjusted.getHSLA())&&(adjusted.s=saturation.value),adjusted},ie_hex_str:function(color){if("hsla"!==color.type&&"rgba"!==color.type)throw color+" is not a color for 'ie-hex-str'";return color.toIeHexStr()}})}Color.init=init}(Color=functions.Color||(functions.Color={}))}(functions=Fashion.functions||(Fashion.functions={}))}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var LinearGradient=function(_super){function LinearGradient(position,stops){_super.call(this),this.vendorPrefixes={webkit:!0,moz:!0,svg:!0,pie:!0,css2:!0,o:!0,owg:!0},this.position=position,this.stops=stops}return __extends(LinearGradient,_super),LinearGradient.prototype.doVisit=function(visitor){visitor.lineargradient(this)},LinearGradient.prototype.descend=function(visitor){visitor.visit(this.position),visitor.visit(this.stops)},LinearGradient.prototype.clone=function(){return new Fashion.LinearGradient(this.position,this.stops)},LinearGradient.prototype.gradientPoints=function(position){},LinearGradient.prototype.operate=function(operation,right){switch(operation){case"!=":if("literal"==right.type&&("null"==right.value||"none"==right.value))return!0;case"==":if("literal"==right.type&&("null"==right.value||"none"==right.value))return!1}return Fashion.Type.operate(operation,this,right)},LinearGradient.prototype.supports=function(prefix){return!!this.vendorPrefixes[prefix.toLowerCase()]},LinearGradient.prototype.toString=function(){var string="linear-gradient(";return this.position&&(string+=this.position+", "),string+this.stops+")"},LinearGradient.prototype.toOriginalWebkitString=function(){var i,args=[],stops=this.stops.items,ln=stops.length;for(args.push("top"),args.push("bottom"),i=0;ln>i;i++)args.push(stops[i].toOriginalWebkitString());return"-webkit-gradient(linear, "+args.join(", ")+")"},LinearGradient.prototype.toPrefixedString=function(prefix){return"owg"===prefix?this.toOriginalWebkitString():prefix+(""+this)},LinearGradient}(Fashion.Type);Fashion.LinearGradient=LinearGradient,Fashion.apply(LinearGradient.prototype,{type:"lineargradient",$isFashionLinearGradient:!0,$canUnbox:!1})}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var RadialGradient=function(_super){function RadialGradient(position,shape,stops){_super.call(this),this.position=position,this.stops=stops,this.shape=shape}return __extends(RadialGradient,_super),RadialGradient.prototype.doVisit=function(visitor){visitor.radialgradient(this)},RadialGradient.prototype.descend=function(visitor){visitor.visit(this.position),visitor.visit(this.stops),visitor.visit(this.shape)},RadialGradient.prototype.clone=function(){return new Fashion.RadialGradient(this.position,this.shape,this.stops)},RadialGradient.prototype.toString=function(){var string="radial-gradient(";return this.position&&(string+=this.position+", "),this.shape&&(string+=this.shape+", "),string+this.stops+")"},RadialGradient.prototype.toOriginalWebkitString=function(){var i,args=[],stops=this.stops.items,ln=stops.length;for(args.push("center 0%"),args.push("center 100%"),i=0;ln>i;i++)args.push(stops[i].toOriginalWebkitString());return"-webkit-gradient(radial, "+args.join(", ")+")"},RadialGradient.prototype.supports=function(prefix){return-1!==["owg","webkit"].indexOf(prefix.toLowerCase())},RadialGradient.prototype.toPrefixedString=function(prefix){return"owg"===prefix?this.toOriginalWebkitString():prefix+(""+this)},RadialGradient.prototype.gradientPoints=function(position){},RadialGradient}(Fashion.Type);Fashion.RadialGradient=RadialGradient,Fashion.apply(RadialGradient.prototype,{type:"radialgradient",$isFashionRadialGradient:!0,$canUnbox:!1})}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var ColorStop=function(_super){function ColorStop(color,stop){_super.call(this),this.color=color,this.stop=stop}return __extends(ColorStop,_super),ColorStop.prototype.doVisit=function(visitor){visitor.colorstop(this)},ColorStop.prototype.descend=function(visitor){visitor.visit(this.color),visitor.visit(this.stop)},ColorStop.prototype.toString=function(){var string=""+this.color,stop=this.stop;return stop&&(stop=stop.clone(),string+=" ",stop.unit||(stop.value*=100,stop.unit="%"),string+=""+stop),string},ColorStop.prototype.toOriginalWebkitString=function(){var stop=this.stop;return stop||(stop=new Fashion.Numeric(0,"%")),stop=stop.clone(),stop.unit||(stop.value*=100,stop.unit="%"),"color-stop("+stop+", "+this.color+")"},ColorStop.prototype.clone=function(){return new Fashion.ColorStop(this.color,this.stop)},ColorStop}(Fashion.Type);Fashion.ColorStop=ColorStop,Fashion.apply(ColorStop.prototype,{type:"colorstop",$isFashionColorStop:!0,$canUnbox:!1})}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var functions;!function(functions){var Gradients;!function(Gradients){function init(runtime){runtime.register({linear_gradient:function(position,stops){return stops=this.tailArgs(1,arguments),stops&&1===stops.length&&(stops=stops[0]),"list"===position.type&&("rgba"===position.get(1).type||"hsla"===position.get(1).type)||"hsla"===position.type||"rgba"===position.type?(stops=this.color_stops.apply(this,arguments),position=null):"list"==position.type&&"colorstop"==position.get(1).type?(stops=position,position=null):stops="hsla"===stops.type||"rgba"===stops.type?this.color_stops.call(this,new Fashion.List([stops])):this.color_stops.call(this,stops),new Fashion.LinearGradient(position,stops)},radial_gradient:function(position,shape,stops){return stops=this.tailArgs(2,arguments),stops&&1===stops.length&&(stops=stops[0]),"list"===position.type&&("rgba"===position.get(1).type||"hsla"===position.get(1).type)||"hsla"===position.type||"rgba"===position.type?(stops=this.color_stops.apply(this,arguments),position=null):"list"==position.type&&"colorstop"==position.get(1).type?(stops=position,position=null):"list"===shape.type&&("rgba"===shape.get(1).type||"hsla"===shape.get(1).type)||"hsla"===shape.type||"rgba"===shape.type?(stops=this.color_stops.apply(this,arguments),shape=null):"list"==shape.type&&"colorstop"==shape.get(1).type?(stops=shape,shape=null):stops="hsla"===stops.type||"rgba"===stops.type?this.color_stops.call(this,new Fashion.List([stops])):this.color_stops.call(this,stops),new Fashion.RadialGradient(position,shape,stops)},color_stops:function(){var i,arg,args=this.tailArgs(0,arguments),mapped=this.handleArgs(args&&args.items||args,[["stops"]]),stops=mapped.stops.items,ln=stops.length,list=new Fashion.List(null,", ");for(i=0;ln>i;i++)arg=stops[i],"list"===arg.type?2===arg.items.length?list.add(new Fashion.ColorStop(arg.get(1),arg.get(2))):list.items.push.apply(list.items,arg.items):"rgba"===arg.type||"hsla"===arg.type?list.add(new Fashion.ColorStop(arg)):Array.isArray(arg)?list.items.push.apply(list.items,arg):list.add(arg);return list}})}Gradients.init=init}(Gradients=functions.Gradients||(functions.Gradients={}))}(functions=Fashion.functions||(Fashion.functions={}))}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var functions;!function(functions_1){var Introspection;!function(Introspection){function init(runtime){runtime.register({type_of:function(value){return value===!0||value===!1?new Fashion.Literal("bool"):value===Fashion.Null?new Fashion.Literal("null"):"hsla"==value.type||"rgba"==value.type?new Fashion.Literal("color"):"literal"==value.type||"string"==value.type?new Fashion.Literal("string"):new Fashion.Literal(value.type)},unit:function(number){return number.$isFashionNumber||Fashion.raise(number+" is not a number for 'unit'"),new Fashion.Text(number.getUnitStr()||"")},unitless:function(number){return"number"!=number.type&&Fashion.raise(number+" is not a number for 'unitless'"),new Fashion.Bool(!number.unit)},comparable:function(number_1,number_2){return"number"!=number_1.type&&Fashion.raise(number_1+" is not a number for 'comparable'"),"number"!=number_2.type&&Fashion.raise(number_2+" is not a number for 'comparable'"),new Fashion.Bool(!!number_1.comparable(number_2))},variable_exists:function(name){var nameStr=name;(name.$isFashionString||name.$isFashionLiteral)&&(nameStr=name.value),nameStr=Fashion.getJsName(nameStr),0!==nameStr.indexOf("$")&&(nameStr="$"+nameStr);var scope=this.getRuntime().getCurrentScope();return!!scope.get(nameStr)},global_variable_exists:function(name){var nameStr=name;(name.$isFashionString||name.$isFashionLiteral)&&(nameStr=name.value),nameStr=Fashion.getJsName(nameStr),0!==nameStr.indexOf("$")&&(nameStr="$"+nameStr);var scope=this.getRuntime().getGlobalScope();return!!scope.get(nameStr)},function_exists:function(name){var nameStr=name;(name.$isFashionString||name.$isFashionLiteral)&&(nameStr=name.value),nameStr=Fashion.getJsName(nameStr);var extensions=this.getRuntime().getRegisteredFunctions(),functions=this.getRuntime().getFunctions();return nameStr in extensions||nameStr in functions},mixin_exists:function(name){var nameStr=name;(name.$isFashionString||name.$isFashionLiteral)&&(nameStr=name.value),nameStr=Fashion.getJsName(nameStr);var mixins=this.getRuntime().getMixins();return nameStr in mixins},call:function(name){name&&name.$isFashionLiteral||Fashion.raise(name+" is not a string or literal for 'call'");var args=this.sliceArgs(arguments,1),runtime=this.getRuntime(),functions=runtime.getFunctions(),extensions=runtime.getRegisteredFunctions(),funcName=Fashion.getJsName(name.value);return functions[funcName]?functions[funcName].apply(functions,args):extensions[funcName]?extensions[funcName].apply(this,args):Fashion.Null}})}Introspection.init=init}(Introspection=functions_1.Introspection||(functions_1.Introspection={}))}(functions=Fashion.functions||(Fashion.functions={}))}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var functions;!function(functions){var List;!function(List){function init(runtime){runtime.register({length:function(list){return"list"!==list.type?new Fashion.Numeric(arguments.length):new Fashion.Numeric(list.items.length)},nth:function(list,index){"list"!==list.type&&(list=new Fashion.List([list])),"number"==index.type&&index.value.toFixed(0)==index.value||Fashion.raise("List index "+index+" must be an integer for 'nth'");var value=index.value;return 0>value&&(value=Math.max(1,list.items.length+value+1)),0===value&&Fashion.raise("List index "+value+" must be greater than or equal to 1 for 'nth'"),value-1>=list.items.length&&Fashion.raise("List index is "+value+" but list is only "+list.items.length+" item"+(1===list.items.length?"":"s")+" long for 'nth'"),list.get(value)},first_value_of:function(list){return"list"!==list.type&&(list=new Fashion.List([list])),this.nth(list,new Fashion.Numeric(1))},last_value_of:function(list){return"list"!==list.type&&(list=new Fashion.List(list)),this.nth(list,new Fashion.Numeric(list.items.length))},compact:function(){var items,list=arguments,sep=", ";"list"!==list.type&&(list=new Fashion.List(list)),items=list.items,1==items.length&&"list"==items[0].type&&(list=items[0],items=list.items,sep=list.separator),list=new Fashion.List(null,sep);for(var i=0;i<items.length;i++){var item=items[i];this.unbox(item)&&list.add(item)}return list},_compass_list_size:function(){var list=arguments;return"list"!==list.type&&(list=new Fashion.List(list)),new Fashion.Numeric(list.items.length)},join:function(list1,list2,separator){if("list"!==list1.type&&(list1=new Fashion.List([list1]),list1.separator=null),"list"!==list2.type&&(list2=new Fashion.List([list2]),list2.separator=null),separator||(separator=list1.items.length&&list1.separator||list2.items.length&&list2.separator||" "),"literal"===separator.type)switch(separator.value){case"comma":separator=", ";break;case"space":separator=" ";break;case"auto":separator=list1.separator||list2.separator||" ";break;default:Fashion.raise("Separator name must be space, comma, or auto for 'join'")}return"string"===separator.type&&(separator=separator.value),new Fashion.List(list1.items.concat(list2.items),separator)},append:function(){return this.join.apply(this,arguments)},box:function(list,index){if(list instanceof Fashion.List||(list=new Fashion.List([list])),list=list.items.slice(),index>=list.length)switch(list.length){case 1:list[1]=list[2]=list[3]=list[0];break;case 2:list[2]=list[0],list[3]=list[1];break;case 3:list[3]=list[1]}return list[index-1]},zip:function(){for(var list,lists=this.sliceArgs(arguments),output=[],minLen=-1,i=0;i<lists.length;i++)list=lists[i].items,-1===minLen?minLen=list.length:list.length<minLen&&(minLen=list.length);for(var i=0;minLen>i;i++){for(var newList=[],j=0;j<lists.length;j++)newList.push(lists[j].items[i]);output.push(new Fashion.List(newList," "))}return new Fashion.List(output,", ")}})}List.init=init}(List=functions.List||(functions.List={}))}(functions=Fashion.functions||(Fashion.functions={}))}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var functions;!function(functions){var Misc;!function(Misc){function init(runtime){runtime.register({__if:function(condition,if_true,if_false){return this.unbox(condition)?if_true:if_false},theme_image:function(theme,file){return new Fashion.Literal('url("resources/images/'+theme.value+"/"+file.value+'")')},prefixed:function(prefix,items){if(arguments.length>2&&(items=Array.prototype.slice.call(arguments,1)),prefix=this.unbox(prefix),0===prefix.indexOf("-")&&(prefix=prefix.substring(1)),Array.isArray(items)){var i,arg,ln=items.length;for(i=0;ln>i;i++)if(arg=items[i],arg.supports&&arg.supports(prefix))return Fashion.True}else if(items.supports&&items.supports(prefix))return Fashion.True;return Fashion.False},_owg:function(value){return new Fashion.Literal(value.toPrefixedString("owg"))},_webkit:function(value){return new Fashion.Literal(value.toPrefixedString("-webkit-"))},_o:function(value){return new Fashion.Literal(value.toPrefixedString("-o-"))},_moz:function(value){return new Fashion.Literal(value.toPrefixedString("-moz-"))}})}Misc.init=init}(Misc=functions.Misc||(functions.Misc={}))}(functions=Fashion.functions||(Fashion.functions={}))}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var functions;!function(functions){var Numeric;!function(Numeric){function init(runtime){runtime.register({percentage:function(value){return("number"!=value.type||value.getUnitStr())&&Fashion.raise(value+" is not a unitless number for 'percentage'"),new Fashion.Numeric(100*value.value,"%")},round:function(value){return"number"!==value.type&&Fashion.raise(value+" is not a number for 'round'"),new Fashion.Numeric(Math.round(value.value),value.unit)},ceil:function(value){return"number"!==value.type&&Fashion.raise(value+" is not a number for 'ceil'"),new Fashion.Numeric(Math.ceil(value.value),value.unit)},floor:function(value){return"number"!==value.type&&Fashion.raise(value+" is not a number for 'floor'"),new Fashion.Numeric(Math.floor(value.value),value.unit)},abs:function(value){return"number"!==value.type&&Fashion.raise(value+" is not a number for 'abs'"),new Fashion.Numeric(Math.abs(value.value),value.unit)},min:function(){var arg,i,min,args=this.sliceArgs(arguments);for(i=0;i<args.length;i++)arg=args[i],arg&&arg.$isFashionNumber||Fashion.raise(arg+" is not a number for 'min'"),min&&!this.unbox(arg.operate("<",min))||(min=arg);return min&&min.clone()},max:function(a,b){var arg,i,max,args=this.sliceArgs(arguments);for(i=0;i<args.length;i++)arg=args[i],arg&&arg.$isFashionNumber||Fashion.raise(arg+" is not a number for 'max'"),max&&!this.unbox(arg.operate(">",max))||(max=arg);return max&&max.clone()}})}Numeric.init=init}(Numeric=functions.Numeric||(functions.Numeric={}))}(functions=Fashion.functions||(Fashion.functions={}))}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var functions;!function(functions){var Opacity;!function(Opacity){function init(runtime){runtime.register({alpha:function(color){return color&&color.$isFashionNumber?new Fashion.Literal("alpha("+color+")"):(color=Array.isArray(color)?color[0]:color,color&&color.$isFashionLiteral?color:("hsla"!==color.type&&"rgba"!==color.type&&Fashion.raise(color+" is not a color for 'alpha'"),Fashion.Color.component(color,"alpha")))},opacity:function(color){return color&&color.$isFashionNumber?new Fashion.Literal("opacity("+color+")"):(color=Array.isArray(color)?color[0]:color,color&&color.$isFashionLiteral?color:("hsla"!==color.type&&"rgba"!==color.type&&Fashion.raise(color+" is not a color for 'opacity'"),Fashion.Color.component(color,"alpha")))},opacify:function(color,amount){"hsla"!==color.type&&"rgba"!==color.type&&Fashion.raise(color+" is not a color for 'opacify'"),"number"!==amount.type&&Fashion.raise(amount+" is not a number for 'opacify'"),"%"==amount.unit?(amount.value!==Fashion.Color.constrainPercentage(amount.value)&&Fashion.raise("Amount "+amount+" must be between 0% and 100% for 'opacify'"),amount=new Fashion.Numeric(amount.value/100)):amount.value!==Fashion.Color.constrainAlpha(amount.value)&&Fashion.raise("Amount "+amount+" must be between 0 and 1 for 'opacify'");var rgba=color.getRGBA().clone();return rgba.a=Math.min((100*rgba.a+100*amount.value)/100,1),rgba},transparentize:function(color,amount){"hsla"!==color.type&&"rgba"!==color.type&&Fashion.raise(color+" is not a color for 'transparentize'"),"number"!==amount.type&&Fashion.raise(amount+" is not a number for 'transparentize'"),"%"==amount.unit?(amount.value!==Fashion.Color.constrainPercentage(amount.value)&&Fashion.raise("Amount "+amount+" must be between 0% and 100% for 'transparentize'"),amount=new Fashion.Numeric(amount.value/100)):amount.value!==Fashion.Color.constrainAlpha(amount.value)&&Fashion.raise("Amount "+amount+" must be between 0 and 1 for 'transparentize'");var rgba=color.getRGBA().clone();return rgba.a=Math.max((100*rgba.a-100*amount.value)/100,0),rgba},fade_in:function(color,amount){return this.opacify(color,amount)},fade_out:function(color,amount){return this.transparentize(color,amount)}})}Opacity.init=init}(Opacity=functions.Opacity||(functions.Opacity={}))}(functions=Fashion.functions||(Fashion.functions={}))}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var functions;!function(functions){var RGB;!function(RGB){function init(runtime){runtime.register({rgba:function(red,green,blue,alpha,color){var colorInst;return red&&color&&Fashion.raise("Unsupported arguments to RGBA"),color&&!red?color.$isFashionColor?colorInst=color:Fashion.raise("Unsupported arguments to RGBA"):red&&red.$isFashionColor&&(colorInst=red),colorInst&&(alpha=green||alpha,colorInst=colorInst.getRGBA(),red=new Fashion.Numeric(colorInst.r),green=new Fashion.Numeric(colorInst.g),blue=new Fashion.Numeric(colorInst.b)),red&&red.$isFashionNumber||Fashion.raise(red+" is not a number for 'rgba' red"),green&&green.$isFashionNumber||Fashion.raise(green+" is not a number for 'rgba' green"),blue&&blue.$isFashionNumber||Fashion.raise(blue+" is not a number for 'rgba' blue"),alpha&&alpha.$isFashionNumber||Fashion.raise(alpha+" is not a number for 'rgba' alpha"),"%"==red.unit?red=new Fashion.Numeric(Fashion.Color.constrainPercentage(red.value)/100*255):red.value!==Fashion.Color.constrainChannel(red.value)&&Fashion.raise("Color value "+red+" must be between 0 and 255 inclusive for 'rgba'"),"%"==green.unit?green=new Fashion.Numeric(Fashion.Color.constrainPercentage(green.value)/100*255):green.value!==Fashion.Color.constrainChannel(green.value)&&Fashion.raise("Color value "+green+" must be between 0 and 255 inclusive for 'rgba'"),"%"==blue.unit?blue=new Fashion.Numeric(Fashion.Color.constrainPercentage(blue.value)/100*255):blue.value!==Fashion.Color.constrainChannel(blue.value)&&Fashion.raise("Color value "+blue+" must be between 0 and 255 inclusive for 'rgba'"),"%"==alpha.unit?alpha=new Fashion.Numeric(Fashion.Color.constrainPercentage(alpha.value)/100):alpha.value!==Fashion.Color.constrainAlpha(alpha.value)&&Fashion.raise("Alpha channel "+alpha+" must be between 0 and 1 inclusive for 'rgba'"),new Fashion.ColorRGBA(red.value,green.value,blue.value,alpha.value)},rgb:function(red,green,blue,color){return this.rgba(red,green,blue,new Fashion.Numeric(1),color)},red:function(color){return"hsla"!==color.type&&"rgba"!==color.type&&Fashion.raise(color+" is not a color for 'red'"),Fashion.Color.component(color,"red")},green:function(color){return"hsla"!==color.type&&"rgba"!==color.type&&Fashion.raise(color+" is not a color for 'green'"),Fashion.Color.component(color,"green")},blue:function(color){return"hsla"!==color.type&&"rgba"!==color.type&&Fashion.raise(color+" is not a color for 'blue'"),Fashion.Color.component(color,"blue")},mix:function(color_1,color_2,weight){weight=void 0!==weight?weight:new Fashion.Numeric(50,"%"),"hsla"!==color_1.type&&"rgba"!==color_1.type&&Fashion.raise("arg 1 "+color_1+" is not a color for 'mix'"),"hsla"!==color_2.type&&"rgba"!==color_2.type&&Fashion.raise("arg 2 "+color_2+" is not a color for 'mix'"),"number"!==weight.type&&Fashion.raise("arg 3 "+weight+" is not a number for 'mix'"),weight.value!==Fashion.Color.constrainPercentage(weight.value)&&Fashion.raise("Weight "+weight+" must be between 0% and 100% for 'mix'"),color_1=color_1.getRGBA(),color_2=color_2.getRGBA(),weight=weight.value/100;var factor=2*weight-1,alpha=color_1.a-color_2.a,weight1=((factor*alpha==-1?factor:(factor+alpha)/(1+factor*alpha))+1)/2,weight2=1-weight1;return new Fashion.ColorRGBA(weight1*color_1.r+weight2*color_2.r,weight1*color_1.g+weight2*color_2.g,weight1*color_1.b+weight2*color_2.b,weight*color_1.a+(1-weight)*color_2.a)}})}RGB.init=init}(RGB=functions.RGB||(functions.RGB={}))}(functions=Fashion.functions||(Fashion.functions={}))}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var functions;!function(functions){var Selectors;!function(Selectors){function init(runtime){runtime.register({headers:function(from,to){var fromVal,toVal,h,headers=[];for(from.$isFashionLiteral&&"all"==from.value?(fromVal=1,toVal=6):(fromVal=this.unbox(from),toVal=this.unbox(to)),h=fromVal;toVal+1>h;h++)headers.push("h"+h);return new Fashion.Text(headers.join(", "))},headings:function(from,to){return this.headers(from,to)}})}Selectors.init=init}(Selectors=functions.Selectors||(functions.Selectors={}))}(functions=Fashion.functions||(Fashion.functions={}))}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var functions;!function(functions){var Text;!function(Text){function init(runtime){runtime.register({quote:function(string){return string.$isFashionString||string.$isFashionLiteral||Fashion.raise(string+" is not a string or literal for 'quote'"),new Fashion.Text(string.value)},unquote:function(string){return string.$isFashionString?new Fashion.Literal(Fashion.Literal.deEscape(string.value)):string},str_slice:function(string,start_at,end_at){return string.$isFashionLiteral||string.$isFashionString||Fashion.raise(string+" is not a string or literal for 'str-slice'"),string.slice(start_at,end_at)},str_length:function(string){return string.$isFashionLiteral||string.$isFashionString||Fashion.raise(string+" is not a string or literal for 'str-slice'"),new Fashion.Numeric(string.value.length)},to_upper_case:function(string){return string.$isFashionLiteral||string.$isFashionString||Fashion.raise(string+" is not a string or literal for 'to-lower-case'"),string.toUpperCase()},to_lower_case:function(string){return string.$isFashionLiteral||string.$isFashionString||Fashion.raise(string+" is not a string or literal for 'to-lower-case'"),string.toLowerCase()},str_index:function(string,substring){return string.$isFashionLiteral||string.$isFashionString||Fashion.raise(string+" is not a string or literal for 'str-insert'"),substring.$isFashionLiteral||substring.$isFashionString||Fashion.raise(substring+" is not a string or literal for 'str-insert'"),string.indexOf(substring)},str_insert:function(string,insert,index){return string.$isFashionLiteral||string.$isFashionString||Fashion.raise(string+" is not a string or literal for 'str-insert'"),insert.$isFashionLiteral||insert.$isFashionString||Fashion.raise(insert+" is not a string or literal for 'str-insert'"),string.insert(insert,index)}})}Text.init=init}(Text=functions.Text||(functions.Text={}))}(functions=Fashion.functions||(Fashion.functions={}))}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var Map=function(_super){function Map(pairs){if(_super.call(this,pairs),this.map={},pairs)for(var i=0;i<pairs.length-1;i+=2){var key=this.toKey(pairs[i]);pairs[i+1];this.map[key]=i+1}}return __extends(Map,_super),Map.prototype.doVisit=function(visitor){visitor.map(this)},Map.prototype.descend=function(visitor){for(var i=0;i<this.items.length;i++)visitor.visit(this.items[i])},Map.prototype.get=function(key){return key instanceof Fashion.Numeric&&(key=Fashion.Type.unbox(key)),"number"==typeof key?new Fashion.List([this.items[2*key-2],this.items[2*key-1]]," "):(key=this.toKey(key),this.items[this.map[key]]||Fashion.Null)},Map.prototype.getItems=function(){for(var values=[],i=0;i<this.items.length-1;i+=2){var key=this.toKey(this.items[i]);values.push(this.map[key])}return values},Map.prototype.put=function(key,value){var keyStr=this.toKey(key);this.map.hasOwnProperty(keyStr)?this.items[this.map[keyStr]]=value:(this.items.push(key,value),this.map[keyStr]=this.items.length-1)},Map.prototype.toString=function(){for(var str="",count=0,i=0;i<this.items.length-1;i+=2){var key=this.toKey(this.items[i]),value=this.map[key];value&&(count>0&&(str+=", "),str+=key+": "+value,count++)}return str},Map.prototype.toKey=function(key){return""+this.unquoteKey(key)},Map.prototype.unquoteKey=function(string){return string.$isFashionType?string.unquote():string},Map}(Fashion.List);Fashion.Map=Map,Fashion.apply(Map.prototype,{type:"map",$isFashionMap:!0,$canUnbox:!1})}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var functions;!function(functions){var Util;!function(Util){function init(runtime){runtime.register({map_create:function(){return new Fashion.Map},map_put:function(map,key,value){map.put(key,value)},map_get:function(map,key){return map.get(key)},parsebox:function(list,num){var ret,size,i,actual=[];for(num=this.unbox(num),"list"===list.type&&(list=list.items),this.isArray(list)||(list=[list]),size=list.length,i=0;size>i;i++)actual.push(list[i]);return num>=size&&(1===size?(actual.push(list[0]),actual.push(list[0]),actual.push(list[0])):2===size?(actual.push(list[0]),actual.push(list[1])):3===size&&actual.push(list[1])),ret=actual[num-1]},is_null:function(value){if(value===Fashion.Null)return!0;switch(value.type){case"string":case"literal":return value=value.value,"null"==value||"none"==value||null===value;default:return!1}},file_join:function(value1,value2){value1=this.unbox(value1),value2=this.unbox(value2);var joined=value1?value1+"/"+value2:value2;return new Fashion.Text(joined,"")},theme_image_exists:function(directory,path){directory=directory.value,path=path.value;var fullPath=Fashion.Env.join(directory,path);return Fashion.Env.isBrowser?!0:Fashion.Env.exists(fullPath)}})}Util.init=init}(Util=functions.Util||(functions.Util={}))}(functions=Fashion.functions||(Fashion.functions={}))}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var FunctionCall=function(_super){function FunctionCall(name,args){_super.call(this),this.name=name,this.args=args}return __extends(FunctionCall,_super),FunctionCall.prototype.toString=function(){var argsStr,args=this.args;return argsStr=Array.isArray(args)?args.join(", "):""+args,this.name+"("+argsStr+")"},FunctionCall.prototype.doVisit=function(visitor){visitor.functioncall(this)},FunctionCall.prototype.descend=function(visitor){this.args&&visitor.visit(this.args)},FunctionCall}(Fashion.Type);Fashion.FunctionCall=FunctionCall,Fashion.apply(FunctionCall.prototype,{type:"functioncall",$isFashionFunctionCall:!0,$canUnbox:!1})}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var processors;!function(processors){var NameRegistrations;!function(NameRegistrations){function init(runtime){function register(){registered||(registered=!0,runtime.registerProcessor({runHooks:function(obj,hooks){if(hooks)for(var h=0;h<hooks.length;h++)hooks[h].call(this,obj,this.context)},functioncall:function(obj){this.runHooks(obj,functionCallHooks[obj.name])},declaration:function(obj){this.runHooks(obj,styleHooks[obj.property]),obj.descend(this)},ruleset:function(obj){var selectors=obj.selectors;selectors=selectors instanceof Fashion.SelectorList?selectors.items:[selectors];for(var s=0;s<selectors.length;s++)selectors[s]&&this.runHooks(obj,selectorHooks[""+selectors[s]]);obj.isAtRule()&&this.runHooks(obj,atRuleHooks[obj.getFirstSelectorStr()]),this.visit(obj.declarations),this.visit(obj.children)},execute:function(obj,ctx){this.context=ctx,this.visit(obj),this.context=null}}))}function registerHooks(map,obj){register();var hooks;for(var key in obj)hooks=map[key],hooks||(hooks=map[key]=[]),hooks.push(obj[key])}var selectorHooks={},styleHooks={},atRuleHooks={},functionCallHooks={},registered=!1;runtime.registerSelectorHooks=function(obj){registerHooks(selectorHooks,obj)},runtime.registerAtRuleHook=function(obj){registerHooks(atRuleHooks,obj)},runtime.registerStyleHooks=function(obj){registerHooks(styleHooks,obj)},runtime.registerFunctionCallHooks=function(obj){registerHooks(functionCallHooks,obj)}}NameRegistrations.init=init}(NameRegistrations=processors.NameRegistrations||(processors.NameRegistrations={}))}(processors=Fashion.processors||(Fashion.processors={}))}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var functions;!function(functions){var HSL;!function(HSL){function init(runtime){runtime.register({hsla:function(hue,saturation,lightness,alpha){return 4!=arguments.length&&Fashion.raise("Wrong number of arguments ("+arguments.length+" for 4) for 'hsla'"),hue.$isFashionNumber||Fashion.raise(hue+" is not a number for 'hsla'"),saturation.$isFashionNumber||Fashion.raise(saturation+" is not a number for 'hsla'"),lightness.$isFashionNumber||Fashion.raise(lightness+" is not a number for 'hsla'"),alpha.$isFashionNumber||Fashion.raise(alpha+" is not a number for 'hsla'"),saturation.value!==Fashion.Color.constrainPercentage(saturation.value)&&Fashion.raise("Saturation "+saturation+" must be between 0% and 100% for 'hsla'"),lightness.value!==Fashion.Color.constrainPercentage(lightness.value)&&Fashion.raise("Lightness "+lightness+" must be between 0% and 100% for 'hsla'"),alpha.value!==Fashion.Color.constrainAlpha(alpha.value)&&Fashion.raise("Alpha channel "+alpha+" must be between 0 and 1 for 'hsla'"),new Fashion.ColorHSLA(hue.value,saturation.value,lightness.value,alpha.value)},hsl:function(hue,saturation,lightness){var len=arguments.length;return 3!=len&&Fashion.raise("Wrong number of arguments ("+len+" for 3) for 'hsl'"),this.hsla(hue,saturation,lightness,new Fashion.Numeric(1))},hue:function(color){return"hsla"!==color.type&&"rgba"!==color.type&&Fashion.raise(color+" is not a color for 'hue'"),Fashion.Color.component(color,"hue")},saturation:function(color){return"hsla"!==color.type&&"rgba"!==color.type&&Fashion.raise(color+" is not a color for 'saturation'"),Fashion.Color.component(color,"saturation")},lightness:function(color){return"hsla"!==color.type&&"rgba"!==color.type&&Fashion.raise(color+" is not a color for 'lightness'"),Fashion.Color.component(color,"lightness")},adjust_hue:function(color,degrees){return"hsla"!==color.type&&"rgba"!==color.type&&Fashion.raise(color+" is not a color for 'adjust-hue'"),"number"!==degrees.type&&Fashion.raise(degrees+" is not a number for 'adjust-hue'"),
Fashion.Color.adjust(color,"hue",degrees)},lighten:function(color,amount){return"hsla"!==color.type&&"rgba"!==color.type&&Fashion.raise(color+" is not a color for 'lighten'"),"number"!==amount.type&&Fashion.raise(amount+" is not a number for 'lighten'"),amount.value!==Fashion.Color.constrainPercentage(amount.value)&&Fashion.raise("Amount "+amount+" must be between 0% and 100% for 'lighten'"),Fashion.Color.adjust(color,"lightness",amount)},darken:function(color,amount){return"hsla"!==color.type&&"rgba"!==color.type&&Fashion.raise(color+" is not a color for 'darken'"),"number"!==amount.type&&Fashion.raise(amount+" is not a number for 'darken'"),amount.value!==Fashion.Color.constrainPercentage(amount.value)&&Fashion.raise("Amount "+amount+" must be between 0% and 100% for 'darken'"),amount=amount.clone(),amount.value*=-1,Fashion.Color.adjust(color,"lightness",amount)},saturate:function(color,amount){return amount?("hsla"!==color.type&&"rgba"!==color.type&&Fashion.raise(color+" is not a color for 'saturate'"),"number"!==amount.type&&Fashion.raise(amount+" is not a number for 'saturate'"),amount.value!==Fashion.Color.constrainPercentage(amount.value)&&Fashion.raise("Amount "+amount+" must be between 0% and 100% for 'saturate'"),Fashion.Color.adjust(color,"saturation",amount)):new Fashion.Literal("saturate("+color+")")},desaturate:function(color,amount){return"hsla"!==color.type&&"rgba"!==color.type&&Fashion.raise(color+" is not a color for 'desaturate'"),"number"!==amount.type&&Fashion.raise(amount+" is not a number for 'desaturate'"),amount.value!==Fashion.Color.constrainPercentage(amount.value)&&Fashion.raise("Amount "+amount+" must be between 0% and 100% for 'desaturate'"),amount.value*=-1,Fashion.Color.adjust(color,"saturation",amount)},grayscale:function(color){return color.$isFashionNumber?new Fashion.Literal("grayscale("+color+")"):("hsla"!==color.type&&"rgba"!==color.type&&Fashion.raise(color+" is not a color for 'grayscale'"),this.desaturate(color,new Fashion.Numeric(100,"%")))},complement:function(color){return"hsla"!==color.type&&"rgba"!==color.type&&Fashion.raise(color+" is not a color for 'complement'"),this.adjust_hue(color,new Fashion.Numeric(180,"deg"))},invert:function(color){return color.$isFashionNumber?new Fashion.Literal("invert("+color+")"):("hsla"!==color.type&&"rgba"!==color.type&&Fashion.raise(color+" is not a color for 'invert'"),color=color.getRGBA(),new Fashion.ColorRGBA(255-color.r,255-color.g,255-color.b,color.a))}})}HSL.init=init}(HSL=functions.HSL||(functions.HSL={}))}(functions=Fashion.functions||(Fashion.functions={}))}(Fashion||(Fashion={}));var Fashion;!function(Fashion){function unboxType(expression){var val=expression;return val&&val.$isFashionType&&val.$canUnbox&&(val=val.value,expression.$isFashionString?"none"!==val&&"null"!==val||(val=null):expression.$isFashionLiteral?"null"===val&&(val=null):expression.$isFashionList&&(val=expression.items)),val}function boxType(expression){if(expression&&expression.$isFashionType)return expression;if(null==expression)return Fashion.Null;if(expression===!0)return Fashion.True;if(expression===!1)return Fashion.False;var typeOf=typeof expression;switch(typeOf){case"string":return new Fashion.Text(expression);case"number":return new Fashion.Numeric(expression)}return expression}function operateType(operation,left,right){return left.performOperation(operation,right)}Fashion.unboxType=unboxType,Fashion.boxType=boxType,Fashion.operateType=operateType,Fashion.Type.operate=operateType,Fashion.Type.unbox=unboxType,Fashion.Type.box=boxType}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var processors;!function(processors){var DataInline;!function(DataInline){function init(runtime){var mimeTypeMap={otf:"font-opentype",eot:"application/vnd.ms-fontobject",ttf:"font/truetype",svg:"image/svg+xml",woff:"application/x-font-woff",woff2:"application/x-font-woff2",gif:"image/gif",png:"image/png"},report=!1,excludes=[],includes=[],maxItemSize=-1;runtime.registerProcessor({getSourceFromCall:function(obj){var source,args=obj.args;return args.items&&(args=args.items),Array.isArray(args)||(args=[args]),1===args.length&&(source=args[0]),source=source.value?source.value:""+source},getSubstring:function(source,char){var idx=source.indexOf(char);return idx>-1&&(source=source.substring(0,idx)),source},detectExtension:function(source){source=this.getSubstring(source,"#"),source=this.getSubstring(source,"?");var idx=source.lastIndexOf("."),extension=source.substring(idx+1);return extension},detectMimeType:function(source){var extension=this.detectExtension(source),mapped=mimeTypeMap[extension];return mapped||"application/octet-stream"},encodeBytes:function(bytes){for(var str="",i=0;i<bytes.length;i++)str+=String.fromCharCode(bytes[i]);return btoa(str)},isMatch:function(source,filters){for(var f=0;f<filters.length;f++)if(filters[f].test(source))return!0;return!1},isExcluded:function(source){return this.isMatch(source,excludes)},isIncluded:function(source){return this.isMatch(source,includes)},inlineUrl:function(obj,mimeType,charset){var url,queue,extension,inlineTag,inlineExtensionTag,skip,me=this,context=me.context,cache=context.cache||(context.cache={}),source=me.getSourceFromCall(obj);source&&(mimeType=mimeType||me.detectMimeType(source),charset=charset||"UTF-8",url=me.basePath+"/"+source,extension=this.detectExtension(url),inlineTag=obj.hasTag("inline"),inlineExtensionTag=obj.hasTag("inline\\:"+extension),skip=!1,this.isExcluded(source)?skip=!0:this.isIncluded(source)?skip=!1:inlineExtensionTag===!1?skip=!0:null===inlineExtensionTag&&inlineTag===!1&&(skip=!0),skip||(queue=cache[url]||function(){var token={nodes:[],url:url};return Fashion.Env.doRequest({url:url,async:!0,binary:!0,params:{_dc:(new Date).getTime()},onComplete:function(options,xhr){var bytes,data,arg,optNode;try{bytes=xhr.getBinaryData(),data=me.encodeBytes(bytes),arg=new Fashion.Literal(encodeURI("data:"+mimeType+(charset?";charset="+charset:"")+";base64,"+data)),Fashion.debug("creating inline data node for : "+url),optNode=new Fashion.FunctionCall("url",[arg])}catch(e){Fashion.error(e)}if(maxItemSize>-1&&arg.value.length>maxItemSize&&(optNode=null),optNode&&report){var size=data.length,num=token.nodes.length;Fashion.log(num+" * "+size+" bytes for "+url+".")}for(var n=0;n<token.nodes.length;n++){if(optNode){var node=token.nodes[n];node.visitTarget=optNode}context.ready.unblock()}},onError:function(options,xhr){for(var n=0;n<token.nodes.length;n++)context.ready.unblock()}}),token}(),queue.nodes.push(obj),context.ready.block()))},functioncall:function(obj){var name=obj.name;if("url"===name)if(this.fontFace)this.inlineUrl(obj);else if(this.currDeclaration){var name=this.currDeclaration.property;"background-image"===name&&this.inlineUrl(obj)}},declaration:function(obj){var declWas=this.declaration;this.currDeclaration=obj,obj.descend(this),this.currDeclaration=declWas},ruleset:function(obj){var ffWas=this.fontFace,rulesetWas=this.currRuleset;this.currRuleset=obj,obj.isAtRule()&&"@font-face"===obj.getFirstSelectorStr()&&(this.fontFace=obj),obj.descend(this),this.currRuleset=rulesetWas,this.fontFace=ffWas},execute:function(obj,ctx){this.context=ctx,this.basePath=runtime.context.getConfig("basePath");var config=runtime.context.getConfig("inliner");if(config&&config.enable){if(config.report&&(report=config.report),config.excludes)for(var i=0;i<config.excludes.length;i++)excludes.push(RegExp(config.excludes[i]));if(config.includes)for(var i=0;i<config.includes.length;i++)includes.push(RegExp(config.includes[i]));maxItemSize=config.maxItemSize||-1,this.visit(obj)}}})}DataInline.init=init}(DataInline=processors.DataInline||(processors.DataInline={}))}(processors=Fashion.processors||(Fashion.processors={}))}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var ChainScope=function(){function ChainScope(prev){this.$isScope=!0,this.prev=prev,this.map=prev?Fashion.chain(prev.map):{}}return ChainScope.prototype.get=function(name){return this.map[name]},ChainScope.prototype.has=function(name){return name in this.map},ChainScope.prototype.put=function(name,value){return this.map[name]=value,value},ChainScope.prototype.addEntries=function(names){for(var name in this.map)names[name]=this.map[name]},ChainScope.prototype.getEntries=function(entries){return entries=entries||{},this.addEntries(entries),entries},ChainScope}();Fashion.ChainScope=ChainScope;var Scope=function(){function Scope(prev){this.$isScope=!0,this.prev=prev,this.map={}}return Scope.prototype.get=function(name){for(var value,map=this.map,prev=this;map;){if(value=map[name])return value;prev=prev.prev,map=prev&&prev.map}return value},Scope.prototype.has=function(name){for(var map=this.map,prev=this;map;){if(name in map)return!0;prev=prev.prev,map=prev&&prev.map}return!1},Scope.prototype.put=function(name,value){return this.map[name]=value,value},Scope.prototype.addEntries=function(names){this.prev&&this.prev.addEntries(names);for(var name in this.map)names[name]=this.map[name]},Scope.prototype.getEntries=function(entries){return entries=entries||{},this.addEntries(entries),entries},Scope}();Fashion.Scope=Scope;var ValueWrapper=function(){function ValueWrapper(scope,name,value){this.$isWrapper=!0,this.scope=scope,name&&(this.name=name,scope.put(name,this)),value&&(this.value=value)}return ValueWrapper.prototype.toString=function(){return this.value+""},ValueWrapper}();Fashion.ValueWrapper=ValueWrapper;var Runtime=function(_super){function Runtime(config){_super.call(this,config),this.isFashionRuntime=!0,this.mediaTest=/@media/,this.keyframesTest=/@.*?keyframes/,this.reserved={"if":!0,"else":!0},this.processors=[],this.registered={unbox:Fashion.unboxType,isArray:Array.isArray,handleArgs:function(args,keys){for(var key,scope={},index=0,a=0;a<args.length;a++){var arg=args[a];if(void 0!==arg)if(arg===!0||arg===!1)scope[keys[index]]=arg,index++;else if(void 0===arg.type)for(key in arg)scope[key.replace(/^\$/,"")]=arg[key];else key=keys[index],key instanceof Array?(key=key[0],scope[key]=scope[key]||new Fashion.List,scope[key].add(arg)):(scope[key]=arg,index++)}return scope},sliceArgs:function(args,start,end){return this.getRuntime().sliceArgs(args,start,end).items},tailArgs:function(start,args){var tail=Array.prototype.slice.call(args,start);return 1==tail.length&&this.isArray(tail)&&(tail=tail[0]),tail}},this.mixins={},this.functions={},Fashion.functions.Color.init(this),Fashion.functions.Gradients.init(this),Fashion.functions.HSL.init(this),Fashion.functions.Introspection.init(this),Fashion.functions.List.init(this),Fashion.functions.Misc.init(this),Fashion.functions.Numeric.init(this),Fashion.functions.Opacity.init(this),Fashion.functions.RGB.init(this),Fashion.functions.Selectors.init(this),Fashion.functions.Text.init(this),Fashion.functions.Util.init(this),Fashion.processors.NameRegistrations.init(this),Fashion.processors.DataInline.init(this);var me=this;this.registered.getRuntime=function(){return me}}return __extends(Runtime,_super),Runtime.prototype.bool=function(value){return new Fashion.Bool(value)},Runtime.prototype.color=function(name){var rgb=Fashion.Color.map[name],color=new Fashion.ColorRGBA(rgb[0],rgb[1],rgb[2],rgb[3]);return color.stringified=name,color},Runtime.prototype.quote=function(value){return"string"===value.type?value:new Fashion.Text(""+value)},Runtime.prototype.unquote=function(value){return value.$isFashionType?value.unquote():new Fashion.Literal(""+value)},Runtime.prototype.ruleset=function(selectors,sourceInfo,docs,blockDocs,hasBlock){var ruleset=this.openRuleset(selectors);return ruleset.sourceInfo=sourceInfo,ruleset.docs=docs,ruleset.blockDocs=blockDocs,ruleset.hasBlock=hasBlock,ruleset},Runtime.prototype.rulesetDone=function(){var current=this.closeRuleset();return this.printRuleset(current),current},Runtime.prototype.namespacedRuleset=function(ns){var ruleset=this.openRuleset(new Fashion.SelectorList([]));ruleset.isNamespaced=!0,ruleset.parent.removeChildRuleset(ruleset),ruleset.parent=null,ns=""+ns,this.rulesets.pop(),this.declare(ns,ruleset),this.rulesets.push(ruleset)},Runtime.prototype.declare=function(property,value,important,sourceInfo,docs){var isNull=!1;value.$isFashionList&&1===value.items.length&&(value=value.items[0]),void 0!==value&&null!==value&&value!==Fashion.Null||(isNull=!0),isNull&&!important||this.getCurrentRuleset().addDeclaration(new Fashion.Declaration({property:property,value:value,important:important,sourceInfo:sourceInfo,docs:docs}))},Runtime.prototype.extendSelector=function(selector){var current=this.getCurrentRuleset();current.extend||(this.extenders.push(current),current.extend=[]),current.extend.push(selector)},Runtime.prototype.operate=function(operation,left,right){return this.box(left).operate(operation,this.box(right))},Runtime.prototype.not=function(expression){return this.box(0==this.unbox(expression))},Runtime.prototype.unbox=function(val){return Fashion.Type.unbox(val)},Runtime.prototype.box=function(val){return Fashion.Type.box(val)},Runtime.prototype.getDefault=function(val){if(null!=val&&void 0!==val){if(val!==Fashion.Null)return this.box(val);if(Fashion.Runtime.allowNullDefaults)return val}},Runtime.prototype.openRuleset=function(selectors){var current=this.getCurrentRuleset(),ruleset=new Fashion.Ruleset({selectors:selectors,parent:current});return current&&current.addChildRuleset(ruleset),this.rulesets.push(ruleset),ruleset},Runtime.prototype.closeRuleset=function(){return this.rulesets.pop()},Runtime.prototype.getCurrentRuleset=function(){var rulesets=this.rulesets;return rulesets[rulesets.length-1]},Runtime.prototype.getCurrentRulesets=function(){return this.rulesets},Runtime.prototype.addDirectiveRuleset=function(name,value){this.printRuleset(new Fashion.Ruleset({isAtDirective:!0,atDirectiveName:name,atDirectiveValue:value}))},Runtime.prototype.printRuleset=function(ruleset){ruleset.parent||ruleset.isNamespaced||this.css.addRuleset(ruleset)},Runtime.prototype.reset=function(){this.css=new Fashion.CSS({context:this.context}),this.css.processors=this.processors.slice(),this._currentScope=null,this._globalScope=this.createScope(),this._dynamics={},this.rulesets=[],this.extenders=[]},Runtime.prototype.run=function(code,metadata){return this.load(code),this.compile(code),this.execute(metadata)},Runtime.prototype.createWrappedFn=function(code){return Function("Fashion","__rt","__gs","__udf","__dyn",code)},Runtime.prototype.callWrappedFn=function(fn,dynamics){return fn(Fashion,this,this._globalScope,void 0,dynamics||{})},Runtime.prototype.compile=function(code){var theFn,me=this;return this.code=code,theFn=this.createWrappedFn(code),this.fn=function(rt,overrides,dyn){var runtime=rt||me,dynamics=dyn||{};return runtime.reset(),overrides&&(overrides.$isScope?runtime._globalScope=overrides:runtime._globalScope.map=overrides),runtime._currentScope=runtime._globalScope,runtime._scopeStack=[runtime._currentScope],theFn(Fashion,runtime,runtime._globalScope,void 0,dynamics),runtime.css.extenders=runtime.extenders,runtime.css},this.fn},Runtime.prototype.execute=function(metadata){return this.fn(this,metadata)},Runtime.prototype.load=function(code){return this.code=code,this},Runtime.prototype.registerProcessor=function(proc){this.processors.push(new Fashion.TypeVisitor(proc))},Runtime.prototype.register=function(methods){methods.dynamic&&(Fashion.error('Cannot register javascript function named "dynamic"'),delete methods.dynamic),methods.require&&(Fashion.error('Cannot register javascript function named "require"'),delete methods.require),Fashion.apply(this.registered,methods)},Runtime.prototype.isRegistered=function(name){return name=this.reserved[name]?"__"+name:name,!!this.registered[name]},Runtime.prototype.getGlobalScope=function(){return this._globalScope},Runtime.prototype.getCurrentScope=function(){return this._currentScope},Runtime.prototype.getRegisteredFunctions=function(){return this.registered},Runtime.prototype.getFunctions=function(){return this.functions},Runtime.prototype.getMixins=function(){return this.mixins},Runtime.prototype.createScope=function(scope){var currScope=scope||this._currentScope,newScope=new Scope(currScope);return this.pushScope(newScope)},Runtime.prototype.pushScope=function(scope){return scope.resetScope=this._currentScope,this._currentScope=scope,scope},Runtime.prototype.popScope=function(){return this._currentScope=this._currentScope.resetScope,this._currentScope},Runtime.prototype.get=function(name){var res=this._currentScope.get(name);return res&&res.$isWrapper?this.box(res.value):(void 0===res&&(this._currentScope.has(name)||Fashion.raise("Reference to undeclared variable : "+name)),this.box(res))},Runtime.prototype.set=function(name,value,createLocal,isGlobal,isDefault,dynamics){var currScope=isGlobal?this._globalScope:this._currentScope,obj=currScope.get(name)||new ValueWrapper(currScope,name);return createLocal&&obj.scope!==currScope&&(obj=new ValueWrapper(currScope,name)),dynamics&&(isDefault=isDefault||name in dynamics&&this._globalScope.has(name)),obj.value=isDefault?this.getDefault(obj.value)||value:value,value},Runtime.prototype.getDocs=function(id){return this.docCache?this.docCache.get(id):void 0},Runtime.prototype.getString=function(id){return this.stringCache?this.stringCache.get(id):void 0},Runtime.prototype.applySplat=function(arg){return arg.splat=!0,arg},Runtime.prototype.sliceArgs=function(args,start,end){start=start||0,end=end||args.length;var splat,a,arg,filtered=[],newArgs=[],separator=", ";for(a=start;end>a;a++)arg=args[a],arg?arg.splat&&arg.$isFashionList?(splat&&filtered.push(splat),splat=arg,separator=splat.separator||separator):filtered.push(arg):splat||filtered.push(arg);for(a=0;a<filtered.length;a++)arg=filtered[a],separator=arg&&arg.splatSeparator||separator,newArgs.push(filtered[a]);return splat&&newArgs.push.apply(newArgs,splat.items),new Fashion.List(newArgs,separator)},Runtime.prototype.applySplatArgs=function(args){var arg,a,item,i,items,newArgs=[];for(a=0;a<args.length;a++){if(arg=args[a],arg&&arg.splat&&arg.$isFashionList)for(items=arg.getItems(),i=0;i<items.length;i++)item=items[i],item&&(item.splatSeparator=arg.separator),newArgs.push(item);else newArgs.push(arg);arg&&(arg.splat=void 0)}return newArgs},Runtime.uniqueScopesForGlobalRulesets=!0,Runtime.uniqueScopesForAllRulesets=!0,Runtime.allowSetScopedVariables=!0,Runtime.allowMultipleImports=!0,Runtime.allowNullDefaults=!0,Runtime.allowEmptyRulesets=!1,Runtime.fullExtendWeave=!1,Runtime.compactSuperSelectors=!1,Runtime}(Fashion.Base);Fashion.Runtime=Runtime}(Fashion||(Fashion={}));var Fashion;!function(Fashion){"undefined"!=typeof System||"undefined"==typeof require||Fashion.Env.isPhantom||(System=require("systemjs")),Fashion.currentFile=void 0;var SassFile=function(_super){function SassFile(cfg){_super.call(this,cfg),this.$isSassFile=!0,this.expanding=!1,this.readyListeners=[],this.state=0,this.imports={},this.importedBy={},this.isJsExtension()?this.loadExtension():this.loadSass()}return __extends(SassFile,_super),SassFile.prototype.getLoadPath=function(){var loadPath=this.loadPath;return loadPath||(loadPath=this.loadPath=this.path),loadPath},SassFile.prototype.loadExtension=function(){var me=this,loadPath=me.getLoadPath();if(me.state<5&&(me.state=5,me.state<9))if(me.state=9,Fashion.Env.isRhino){/\.js$/.test(loadPath)||(loadPath+=".js");var extension=require(loadPath);extension.init(me.builder.context.runtime),me.state=10,me.content="",me.info("file "+loadPath+" is loaded"),me.checkImports()}else System["import"](me.originalSource,{name:me.importer.getLoadPath()}).then(function(extension){extension.init(me.builder.context.runtime),me.state=10,me.content="",me.info("file "+loadPath+" is loaded"),me.checkImports()},function(err){me.error("file "+loadPath+" failed to load"),me.error((err.stack||err)+""),me.checkImports()})},SassFile.prototype.loadSass=function(){var loadPath,me=this;me.state<5&&(me.state=5,me.state<10&&(loadPath=me.getLoadPath(),me.info("loading file "+loadPath),Fashion.Env.loadFile(loadPath,function(content){me.state=10,me.info("file "+loadPath+" is loaded"),me.content=content,me.checkImports()},function(){var idx=loadPath.lastIndexOf("/"),attempt=loadPath;idx>-1&&(attempt=attempt.substring(0,idx+1)+"_"+attempt.substring(idx+1)),loadPath=me.loadPath=attempt,me.info("retrying with "+loadPath),Fashion.Env.loadFile(loadPath,function(content){me.state=10,me.info("file "+loadPath+" is loaded"),me.content=content,me.checkImports()},function(){Fashion.error("failed to download path : "+loadPath),me.content="",me.checkImports()})})))},SassFile.prototype.getAst=function(){var parser,me=this,ast=me.ast,content=me.content,loadPath=me.getLoadPath();if(!me.isJsExtension()){if(!ast&&content){parser=me.builder.getParser(),me.debug("parsing file "+loadPath);try{ast=me.ast=parser.parse(content,loadPath)}catch(err){return void Fashion.error(err)}}return ast}},SassFile.prototype.getSassFile=function(basePath,targetPath,origSource,importer){return this.builder.getSassFile(basePath,targetPath,origSource,importer)},SassFile.prototype.isJsExtension=function(){var loadPath=this.getLoadPath();return loadPath.indexOf(".js")>0},SassFile.prototype.getImportSource=function(source){var imports=[];return"List"!==source.type&&"SelectorList"!==source.type||!source.separator||0!==source.separator.indexOf(",")?imports.push(source):imports=source.items,imports=Fashion.convert(imports,function(source){return source&&"MultiPartSelector"===source.type&&1===source.items.length&&(source=source.items[0]),source&&"CompoundSelector"===source.type&&1===source.items.length&&(source=source.items[0]),source&&source.value?source.value:source}),imports=Fashion.filter(imports,function(source){if(!source)return!1;if(!source.indexOf)return!1;var idx=source.indexOf(".css");return idx>-1&&idx===source.length-4?!1:(idx=source.indexOf("http://"),0===idx?!1:(idx=source.indexOf("//"),0!==idx))})},SassFile.prototype.trimComment=function(comment){return 0===comment.indexOf("//#")&&(comment=comment.substring(3)),0===comment.indexOf("//")&&(comment=comment.substring(2)),0===comment.indexOf("/*")&&(comment=comment.substring(2,comment.length-3)),comment.trim()},SassFile.prototype.checkImports=function(){var me=this,loadPath=me.getLoadPath(),sassFiles=[],missing,i;if(me.state<15){if(me.info("checking Imports for file "+loadPath),me.state=15,me.isJsExtension()){if(Fashion&&Fashion.Env&&Fashion.Env.isRhino){var content=me.content+"\n//# sourceURL="+loadPath;eval(content)}}else{var vis=new Fashion.Visitor({skipBranching:!0,loadJsExtension:function(source){source=source.replace(/;$/,"").replace(/^'/,"").replace(/'$/,"").replace(/\.js$/,""),0!==source.indexOf(".")&&(source="./"+source);var sassFile=me.getSassFile(me.path,source+".js",source,me);sassFile===me&&Fashion.raise("file "+loadPath+" should not import itself"),me.imports[sassFile.getLoadPath()]=sassFile,sassFile.importedBy[loadPath]=me,sassFile.state<20&&sassFiles.push(sassFile)},FunctionCall:function(node){var funcName=node.id||node.value,handlers=this;if("require"===funcName){var sources=me.getImportSource(node.args);sources.forEach(function(source){handlers.loadJsExtension(source)}),node.visitTarget=null}},Require:function(node){var source=me.getImportSource(node.source)[0],isGlobal=1==this.nodeStack.length;source.indexOf&&(isGlobal||Fashion.raise('Cannot use require() "'+source+'" from non-file-scope location',node),Fashion.warn("Use of '@require' has been deprecated",node),Fashion.warn("Use require() function call instead"),delete node.visitTarget,this.loadJsExtension(source))},Import:function(node){var _this=this;delete node.visitTarget,delete node.nodeFiles;var source=me.getImportSource(node.source);source.forEach(function(source){var sassFile=me.getSassFile(me.path,source,source);sassFile===_this&&Fashion.raise("file "+loadPath+" should not import itself"),me.imports[sassFile.getLoadPath()]=sassFile,sassFile.importedBy[loadPath]=me,sassFile.state<20&&sassFiles.push(sassFile)})}});vis.visit(me.getAst())}if(missing=sassFiles.length,!missing)return void me.fireReady();for(i=0;i<sassFiles.length;i++)sassFiles[i].onReady(function(){missing--,0===missing?me.fireReady():me.debug("file "+loadPath+" still waiting for "+missing+" other files")})}},SassFile.prototype.onReady=function(listener){var me=this;me.state>=20?listener(me):(me.readyListeners.push(listener),10==me.state&&me.checkImports())},SassFile.prototype.fireReady=function(){var me=this;if(me.state<20){me.info("file "+me.getLoadPath()+" is ready"),me.state=20;for(var listener;null!=(listener=me.readyListeners.shift());)listener(me)}},SassFile.prototype.getExpandedAst=function(stamp){stamp=stamp||(new Date).getTime();var me=this,ast=me.getAst();if(me.imported!=stamp&&(me.imported=stamp,!me.isJsExtension())){me.debug("expanding ast for file "+me.getLoadPath());var vis=new Fashion.Visitor({skipBranching:!0,Import:function(node){delete node.visitTarget;var source=me.getImportSource(node.source),visitTarget=[];source.forEach(function(source){if(source&&source.indexOf&&!node.skipSassImport){var sassFile=me.getSassFile(me.path,source),importAst=sassFile.getExpandedAst(stamp);visitTarget.push(importAst)}}),visitTarget.length&&(node.visitTarget=visitTarget)}});return vis.visit(ast),ast}return Fashion.Runtime.allowMultipleImports?ast:void 0},SassFile.prototype.invalidate=function(){var me=this;if(me.state>=10){me.info("invalidating file "+me.getLoadPath()),me.state=0,delete me.ast,delete me.content,delete me.imported;for(var name in me.importedBy)me.importedBy[name].unready();var loadPath=me.getLoadPath();for(name in me.imports)delete me.imports[name].importedBy[loadPath];me.imports={},me.isJsExtension()?me.loadExtension():me.loadSass()}},SassFile.prototype.unready=function(){this.state=10,delete this.ast;for(var name in this.importedBy)this.importedBy[name].unready()},SassFile.prototype.debug=function(message){},SassFile.prototype.info=function(message){},SassFile.prototype.error=function(message){},SassFile}(Fashion.Base);Fashion.SassFile=SassFile}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var parse;!function(parse){function isAlpha(ch){return ch>="a"&&"z">=ch||ch>="A"&&"Z">=ch}function isDigit(ch){return ch>="0"&&"9">=ch}function isNameChar(ch){var c=ch.charCodeAt(0);return ch>="a"&&"z">=ch||ch>="A"&&"Z">=ch||ch>="0"&&"9">=ch||"-"===ch||"_"===ch||c>=128&&255>=c&&215!==c&&247!==c||"\\"===ch}function isHexDigit(ch){return ch>="0"&&"9">=ch||ch>="a"&&"f">=ch||ch>="A"&&"F">=ch}function isLength(unit){var ch1=unit.charAt(0).toLowerCase(),ch2=unit.charAt(1).toLowerCase(),ch3=unit.charAt(2)&&unit.charAt(2).toLowerCase();if("p"===ch1)return"x"===ch2||"t"===ch2||"c"===ch2;if("m"===ch2)return"c"===ch1||"m"===ch1||"e"===ch1;if("x"===ch2)return"e"===ch1;if("m"===ch3&&"r"===ch1&&"e"===ch2)return 3;if("x"===ch1&&isHexDigit(ch2)){for(var len=1;isHexDigit(unit.charAt(len));)len++;return len}return"i"===ch1&&"n"===ch2}function isTime(unit){return 1===unit.length?"s"===unit:2===unit.length?"ms"===unit:!1}function isAngle(unit){var ch=unit.charAt(0);return"d"===ch||"D"===ch?"deg"===unit.toLowerCase():"r"===ch||"R"===ch?"rad"===unit.toLowerCase():!1}parse.isAlpha=isAlpha,parse.isNameChar=isNameChar;var Scanner=function(_super){function Scanner(style,file){_super.call(this),this.isFashionScanner=!0,this.directives={"@charset":!0,"@import":!0,"@extend":!0,"@debug":!0,"@warn":!0,"@if":!0,"@else":!0,"@for":!0,"@each":!0,"@while":!0,"@mixin":!0,"@include":!0,"@function":!0,"@return":!0,"@debugger":!0,"@elseif":!0,"@content":!0,"@require":!0},this.index=0,this.style=style,this.lineNumber=this.style.length?1:0,this.currentFile=file||Fashion.currentFile,this.docs=[]}return __extends(Scanner,_super),Scanner.prototype.next=function(isPeek){var me=this,start=me.index,startLine=me.lineNumber,token=me._next(isPeek);return token&&(token.idx=me.index,token.lineNumber=me.lineNumber,token.startIdx=start,token.startLine=startLine),token},Scanner.prototype._next=function(isPeek){for(var ch,ch2,ch3,start,str,level,negate,charOffset,value,style=this.style,length=style.length;;){for(ch=style.charAt(this.index);this.index<length&&(" ">=ch||ch>=128);)"\n"===ch&&(this.lineNumber+=1,this.start=this.index),this.index+=1,ch=style.charAt(this.index);if(ch2=style.charAt(this.index+1),"/"!==ch||"*"!==ch2){if("/"!==ch||"/"!==ch2)break;for(this.index+=1,start=this.index;this.index<length&&(ch=style.charAt(this.index),"\r"!==ch&&"\n"!==ch);)this.index+=1;isPeek||this.docs.push(style.substring(start-1,this.index))}else{for(this.index+=1,start=this.index+1;this.index<length;){if(ch=style.charAt(this.index),ch2=style.charAt(this.index+1),"\n"===ch&&(this.lineNumber+=1,this.start=this.index),"*"===ch&&"/"===ch2){this.index+=2;break}this.index+=1}isPeek||this.docs.push(style.substring(start-2,this.index))}}if(start=this.index,!(start>=length)){if(ch=style.charAt(this.index),ch2=style.charAt(this.index+1),ch3=style.charAt(this.index+2),isNameChar(ch)&&!isDigit(ch)&&"-"!==ch||"-"===ch&&isNameChar(ch2)&&!isDigit(ch2)||"#"===ch&&"{"===ch2){for(level=0,this.index+=1,"#"===ch&&"{"===ch2&&(level+=1,this.index+=1),"\\"===ch&&(this.index+=1);this.index<length;)if(ch=style.charAt(this.index),ch2=style.charAt(this.index+1),isNameChar(ch))this.index+=1;else if("\\"!==ch)if(">"!=ch)if("#"!==ch||"{"!==ch2){if(!(level>0))break;this.index+=1,"}"===ch&&(level-=1)}else level+=1,this.index+=2;else this.index+=1;else this.index+=2;return str=style.substring(start,this.index).toLowerCase(),"or"===str||"and"===str||"not"===str?{type:"operator",isOperator:!0,value:str,lineNumber:this.lineNumber}:{type:"ident",value:style.substring(start,this.index),lineNumber:this.lineNumber}}if("'"===ch||'"'===ch||"\\"===ch&&("'"===ch2||'"'===ch2)){charOffset="\\"===ch?2:1,this.index+=charOffset,start=this.index;var openCh="\\"===ch?ch2:ch;level=0;for(var buff="";this.index<length;){if(ch=style.charAt(this.index),this.index++,"\\"===ch){if(ch2=style.charAt(this.index),"\n"===ch2||"\r"===ch2){this.index++;continue}if(buff+=ch,ch=style.charAt(this.index),this.index++,!level&&2===charOffset&&openCh===style.charAt(this.index))break}else if("#"===ch)"{"===style.charAt(this.index)&&level++;else if("}"===ch)level&&level--;else if(!level&&ch===openCh)break;buff+=ch}return{type:"string",value:buff,quoteChar:style.charAt(start-1),lineNumber:this.lineNumber}}if(isDigit(ch)||"."===ch&&isDigit(ch2)||"-"===ch&&isDigit(ch2)||"-"===ch&&"."===ch2&&isDigit(ch3)){for("-"===ch&&(this.index+=1),this.index+=1;this.index<length&&(ch=style.charAt(this.index),!("0">ch||ch>"9"));)this.index+=1;if("\\"===ch&&(this.index+=1,ch=style.charAt(this.index)),"."===ch)for(this.index+=1;this.index<length&&(ch=style.charAt(this.index),!("0">ch||ch>"9"));)this.index+=1;if("%"===ch)return this.index+=1,{type:"percentage",value:style.substring(start,this.index),start:start,end:this.index,lineNumber:this.lineNumber};if(" "!==ch){var unitLen=isLength(style.substr(this.index,10));if(unitLen)return this.index+=unitLen===!0?2:unitLen,{type:"length",value:style.substring(start,this.index),lineNumber:this.lineNumber};if(isTime(style.substr(this.index,1)))return this.index+=1,{type:"time",value:style.substring(start,this.index),lineNumber:this.lineNumber};if(isTime(style.substr(this.index,2)))return this.index+=2,{type:"time",value:style.substring(start,this.index),lineNumber:this.lineNumber};if(isAngle(style.substr(this.index,3)))return this.index+=3,{type:"angle",value:style.substring(start,this.index),lineNumber:this.lineNumber}}return{type:"number",value:style.substring(start,this.index),lineNumber:this.lineNumber}}if("."===ch){for(level=0,this.index+=1,ch=style.charAt(this.index),"{"===ch&&(level+=1,this.index+=1);this.index<length;)if(ch=style.charAt(this.index),ch2=style.charAt(this.index+1),isNameChar(ch))this.index+=1;else if("#"!==ch||"{"!==ch2){if(!(level>0))break;this.index+=1,"}"===ch&&(level-=1)}else level+=1,this.index+=2;return{type:"class",value:style.substring(start,this.index),lineNumber:this.lineNumber
}}if("#"===ch){for(level=0,this.index+=1,ch=style.charAt(this.index),"{"===ch&&(level+=1,this.index+=1);this.index<length;)if(ch=style.charAt(this.index),ch2=style.charAt(this.index+1),isNameChar(ch))this.index+=1;else if("#"!==ch||"{"!==ch2){if(!(level>0))break;this.index+=1,"}"===ch&&(level-=1)}else level+=1,this.index+=2;return{type:"hash",value:style.substring(start,this.index),lineNumber:this.lineNumber}}if("$"===ch||"-"===ch&&"$"===ch2){for("-"===ch&&(negate=!0,start+=1,this.index+=1),this.index+=1;this.index<length&&(ch=style.charAt(this.index),isNameChar(ch));)this.index+=1;return{type:"variable",value:style.substring(start,this.index),negate:negate,lineNumber:this.lineNumber}}if("@"===ch){for(this.index+=1;this.index<length&&(ch=style.charAt(this.index),isAlpha(ch)||"-"===ch);)this.index+=1;return value=style.substring(start,this.index),{type:this.directives[value]?"directive":"ident",value:value,lineNumber:this.lineNumber}}return this.index+=1,str=ch,"="===ch&&"="===ch2&&(str="==",this.index+=1),"~"===ch&&"="===ch2&&(str="~=",this.index+=1),"|"===ch&&"="===ch2&&(str="|=",this.index+=1),"^"===ch&&"="===ch2&&(str="^=",this.index+=1),"$"===ch&&"="===ch2&&(str="$=",this.index+=1),"*"===ch&&"="===ch2&&(str="*=",this.index+=1),"!"===ch&&"="===ch2&&(str="!=",this.index+=1),"<"===ch&&"="===ch2&&(str="<=",this.index+=1),">"===ch&&"="===ch2&&(str=">=",this.index+=1),{type:"operator",isOperator:!0,value:str,lineNumber:this.lineNumber}}},Scanner.prototype.flushDocs=function(){if(this.docs.length>0){var docs=this.docs;return this.docs=[],docs}return null},Scanner.prototype.peek=function(i){var token,start=this.index,lineNo=this.lineNumber;for(i=i||1;i>0;)token=this.next(!0),i-=1;return token&&(token.idx=this.index),this.index=start,this.lineNumber=lineNo,token},Scanner.prototype.expect=function(op){var token=this.next(),lineNo=this.lineNumber-1,fileName=this.currentFile||"sass-content",message="Expected '"+op+"' but saw '"+(token?token.value:"(null token)")+"' => "+fileName+":"+lineNo+":"+(this.index-this.start);if(!token)throw Fashion.error(message),message;if(!token.isOperator||token.value!==op)throw Fashion.error(message),message},Scanner}(Fashion.Base);parse.Scanner=Scanner}(parse=Fashion.parse||(Fashion.parse={}))}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var parse;!function(parse){var Tokenizer=function(_super){function Tokenizer(){_super.apply(this,arguments)}return __extends(Tokenizer,_super),Tokenizer.prototype.tokenize=function(config){var token,scanner=new Fashion.parse.Scanner(config),tokens=this.tokens;if(!tokens)for(this.tokens=tokens=[];void 0!==(token=scanner.next());)tokens.push(token);return tokens},Tokenizer}(Fashion.Base);parse.Tokenizer=Tokenizer}(parse=Fashion.parse||(Fashion.parse={}))}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var parse;!function(parse){function debug(message){}var Parser=function(_super){function Parser(lax){void 0===lax&&(lax=!1),_super.call(this),this.lax=lax,this.keywords={"no-repeat":!0},this.isSelector=!1,this.isParenthetical=!1,this.isSelectorParen=!1}return __extends(Parser,_super),Parser.prototype.parseConstant=function(){var scanner=this.scanner,t=scanner.peek();if(!t||!t.isOperator){if("number"===t.type){if(t=scanner.next(),t.value.indexOf("\\")>-1){var t2=scanner.peek();if("number"===t2.type)return scanner.next(),new parse.Constant({value:t.value+t2.value,dataType:"Literal",lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})}return new parse.Constant({value:t.value,dataType:"Number",lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})}return"string"===t.type?(t=scanner.next(),new parse.Constant({value:t.value,quoteChar:t.quoteChar,dataType:"String",lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})):"length"===t.type?(t=scanner.next(),new parse.Constant({value:t.value,dataType:"Length",lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})):"time"===t.type?(t=scanner.next(),new parse.Constant({value:t.value,dataType:"Time",lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})):"angle"===t.type?(t=scanner.next(),new parse.Constant({value:t.value,dataType:"Angle",lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})):"percentage"===t.type?(t=scanner.next(),new parse.Constant({value:t.value,dataType:"Percentage",lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})):"hash"===t.type?(t=scanner.next(),new parse.Constant({value:t.value,dataType:"Color",lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})):void 0}},Parser.prototype.parseStylesheet=function(){for(var stat,statements=[];;){if(stat=this.parseStatement(),void 0===stat)break;this.scanner.flushDocs(),statements.push(stat)}return statements},Parser.prototype.parseStatement=function(){var stat,me=this,scanner=me.scanner,t=scanner.peek();if(void 0!==t){if("variable"===t.type)return me.parseVariableAssignment();if("directive"===t.type&&"-"!==t.value[1])return stat=me.parseDirective(),t=scanner.peek(),t&&t.isOperator&&";"===t.value&&scanner.next(),stat;if("ident"===t.type){var start=scanner.index,fn=me.parseFunctionCall();if(t=scanner.peek(),fn&&";"===t.value)return scanner.next(),fn;scanner.index=start}return me.parseRuleset()}},Parser.prototype.parseDirective=function(){var me=this,scanner=me.scanner,t=scanner.peek();return"@charset"===t.value?me.parseCharset():"@debug"===t.value?me.parseDebug():"@each"===t.value?me.parseEach():"@for"===t.value?me.parseFor():"@function"===t.value?me.parseFunction():"@if"===t.value?me.parseIf():"@elseif"===t.value?me.parseElse():"@else"===t.value?me.parseElse():"@extend"===t.value?me.parseExtend():"@import"===t.value?me.parseImport():"@require"===t.value?me.parseRequire():"@debugger"===t.value?me.parseDebugger():"@content"===t.value?me.parseContent():"@mixin"===t.value?me.parseMixin():"@include"===t.value?me.parseInclude():"@return"===t.value?me.parseReturn():"@while"===t.value?me.parseWhile():"@warn"===t.value?me.parseWarn():void Fashion.raiseAt("Unknown directive "+t.value,scanner)},Parser.prototype.parseFunction=function(){var t,func,statements,me=this,scanner=me.scanner;return t=scanner.next(),t&&"directive"===t.type&&"@function"===t.value?(func=me.parseFunctionCall(!0),statements=me.parseBlock().statements,new parse.Function({func:func,statements:statements,lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})):void 0},Parser.prototype.parseCharset=function(){var t,charset,me=this,scanner=me.scanner;if(t=scanner.next(),t&&"directive"===t.type&&"@charset"===t.value){if(t=scanner.next(),t&&"string"===t.type)return charset=t.value,new parse.Charset({charset:charset,lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile});Fashion.raiseAt("Expected a string after @charset",scanner)}},Parser.prototype.parseDebug=function(){var t,expr,me=this,scanner=me.scanner;if(t=scanner.next(),t&&"directive"===t.type&&"@debug"===t.value){if(expr=me.parseExpression(),void 0!==expr)return new parse.Debug({expr:expr,lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile});Fashion.raiseAt("Expected an expression after @debug",scanner)}},Parser.prototype.parseWarn=function(){var t,expr,me=this,scanner=me.scanner;if(t=scanner.next(),t&&"directive"===t.type&&"@warn"===t.value){if(expr=me.parseExpression(),void 0!==expr)return new parse.Warn({expr:expr,lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile});Fashion.raiseAt("Expected an expression after @debug",scanner)}},Parser.prototype.parseEach=function(){var t,id,seq,stat,isMap,me=this,scanner=me.scanner,statements=[];if(t=scanner.next(),t&&"directive"===t.type&&"@each"===t.value){for(t=scanner.next(),void 0!==t&&"variable"===t.type||Fashion.raiseAt("Expected variable name after @each",scanner),id=t.value,t=scanner.next(),t&&","===t.value&&(t=scanner.next(),void 0!==t&&"variable"===t.type||Fashion.raiseAt('Expected variable name after "," in @each',scanner),id=new parse.List({items:[id,t.value],separator:", "}),isMap=!0,t=scanner.next()),void 0!==t&&"ident"===t.type&&"in"===t.value||Fashion.raiseAt('Expected "in" after variable in @each',scanner),seq=me.parseSequence(),seq.items&&(seq=seq.items),void 0===seq&&Fashion.raiseAt('Expected value sequence after "in" in @each',scanner),scanner.expect("{");;){if(debug("parsing each"),t=scanner.peek(),t&&t.isOperator&&"}"===t.value)break;if(stat=me.parseScopedStatement(),void 0===stat)break;statements.push(stat)}return scanner.expect("}"),new parse.Each({variable:id,list:seq,statements:statements,lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile,isMap:isMap})}},Parser.prototype.parseFor=function(){var t,id,start,end,inclusive,stat,me=this,scanner=me.scanner,statements=[];if(t=scanner.next(),t&&"directive"===t.type&&"@for"===t.value){for(t=scanner.next(),void 0!==t&&"variable"===t.type||Fashion.raiseAt("Expected variable name after @for",scanner),id=t.value,t=scanner.next(),void 0!==t&&"ident"===t.type&&"from"===t.value||Fashion.raiseAt('Expected "from" after variable in @for',scanner),start=me.parseExpression(),void 0===start&&Fashion.raiseAt('Expected an expression after "from" in @for',scanner),t=scanner.next(),(void 0===t||"ident"!==t.type||"to"!==t.value&&"through"!==t.value)&&Fashion.raiseAt('Expected "to" or "through" in @for',scanner),inclusive="through"===t.value,end=me.parseExpression(),void 0===start&&Fashion.raiseAt("Expected a terminating expression in @for",scanner),scanner.expect("{");;){if(debug("parse for"),t=scanner.peek(),t&&t.isOperator&&"}"===t.value)break;if(stat=me.parseScopedStatement(),void 0===stat)break;statements.push(stat)}return scanner.expect("}"),new parse.For({variable:id,start:start,end:end,inclusive:inclusive,statements:statements,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})}},Parser.prototype.parseWhile=function(){var t,condition,stat,me=this,scanner=me.scanner,statements=[];if(t=scanner.next(),t&&"directive"===t.type&&"@while"===t.value){for(condition=me.parseExpression(),scanner.expect("{");;){if(debug("parse while"),t=scanner.peek(),t&&t.isOperator&&"}"===t.value)break;if(stat=me.parseScopedStatement(),void 0===stat)break;statements.push(stat)}return scanner.expect("}"),new parse.While({condition:condition,statements:statements,lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})}},Parser.prototype.parseIf=function(){var t,condition,stat,me=this,scanner=me.scanner,statements=[];if(t=scanner.next(),t&&"directive"===t.type&&"@if"===t.value){for(condition=me.parseSequence(),scanner.expect("{");;){if(debug("parse if"),t=scanner.peek(),t&&t.isOperator&&"}"===t.value)break;if(stat=me.parseScopedStatement(),void 0===stat)break;statements.push(stat)}return scanner.expect("}"),new parse.If({condition:condition,statements:statements,lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})}},Parser.prototype.parseElse=function(){var t,condition,stat,isElseIf,me=this,scanner=me.scanner,statements=[];if(t=scanner.next(),t&&"directive"===t.type&&("@else"===t.value||"@elseif"==t.value)){for(isElseIf="@elseif"==t.value,t=scanner.peek(),isElseIf?condition=me.parseExpression():"ident"===t.type&&"if"===t.value&&(scanner.next(),condition=me.parseExpression()),scanner.expect("{");;){if(debug("parse else"),t=scanner.peek(),t&&t.isOperator&&"}"===t.value)break;if(void 0===typeof t)break;if(stat=me.parseScopedStatement(),!stat)break;statements.push(stat)}return scanner.expect("}"),new parse.Else({condition:condition,statements:statements,lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})}},Parser.prototype.parseExtend=function(){var t,selector,me=this,scanner=me.scanner;if(t=scanner.next(),t&&"directive"===t.type&&"@extend"===t.value){if(selector=me.parseSelectors(),void 0!==selector)return new parse.Extend({selector:selector,lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile});Fashion.raiseAt("Expecting attribute name",scanner)}},Parser.prototype.parseImport=function(){var expr,t2,scanner=this.scanner,t=scanner.next();return t&&"directive"===t.type&&"@import"===t.value?(t=scanner.peek(),t2=scanner.peek(2),"string"===t.type&&";"==t2.value?(scanner.next(),new parse.Import({source:new parse.Constant({value:t.value,dataType:"Literal"}),lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})):(expr=this.parseSelectorSequence(),new parse.Import({source:expr,lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile}))):void 0},Parser.prototype.parseRequire=function(){var expr,t2,scanner=this.scanner,t=scanner.next();return t&&"directive"===t.type&&"@require"===t.value?(t=scanner.peek(),t2=scanner.peek(2),"string"===t.type&&";"==t2.value?(scanner.next(),new parse.Require({source:new parse.Constant({value:t.value,dataType:"Literal"}),lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})):(expr=this.parseSequence(),new parse.Require({source:expr,lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile}))):void 0},Parser.prototype.parseDebugger=function(){var scanner=this.scanner,t=scanner.next();return new parse.Debugger({lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})},Parser.prototype.parseContent=function(){var scanner=this.scanner,t=scanner.next();return new parse.Content({type:"Content",lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})},Parser.prototype.parseMixin=function(){var t,mixin,scanner=this.scanner;return t=scanner.next(),t&&"directive"===t.type&&"@mixin"===t.value&&(mixin=new parse.Mixin({name:this.parseFunctionCall(!0),statements:[],docs:scanner.flushDocs(),token:t,file:scanner.currentFile}),mixin.statements=this.parseBlock().statements,t=scanner.peek(),t&&t.isOperator&&";"===t.value&&scanner.next()),mixin},Parser.prototype.parseInclude=function(){var t,inc,block,scanner=this.scanner;return t=scanner.next(),t&&"directive"===t.type&&"@include"===t.value?(inc=this.parseFunctionCall(!0),"{"==scanner.peek().value&&(block=this.parseBlock()),new parse.Include({include:inc,lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile,content:block})):void 0},Parser.prototype.parseBlock=function(){var t,stat,scanner=this.scanner,statements=[];if(t=scanner.peek()){if(";"===t.value)return void scanner.next();for(scanner.expect("{");;){if(debug("parse block"),t=scanner.peek(),null===t||void 0===t)break;if(";"!==t.value){if(null===t||void 0===t)break;if(t&&t.isOperator&&"}"===t.value)break;if(stat=this.parseScopedStatement(),!stat)break;statements.push(stat)}else scanner.next()}return debug("done parsing block"),scanner.expect("}"),new parse.Block({statements:statements,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})}},Parser.prototype.parseReturn=function(){var t,expr,scanner=this.scanner;return t=scanner.next(),t&&"directive"===t.type&&"@return"===t.value?(expr=this.parseSequence(),new parse.Return({expr:expr,lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})):void 0},Parser.prototype.parseVariableAssignment=function(){var t,assignment,scanner=this.scanner;t=scanner.next(),assignment=new parse.VariableAssignment({name:t.value,docs:scanner.flushDocs(),token:t,file:scanner.currentFile,lineNumber:t.lineNumber});try{scanner.expect(":");var start=scanner.index;for(assignment.value=this.parseValue(),t=scanner.peek();t&&t.isOperator&&"!"===t.value;)t=scanner.next(),t=scanner.next(),"default"===t.value?assignment["default"]=!0:"global"===t.value?assignment.global=!0:"dynamic"===t.value&&(assignment.dynamic=!0),t=scanner.peek();if(t=scanner.peek(),t&&";"===t.value){scanner.expect(";");var end=t.idx;assignment.valueText=scanner.style.substring(start,end)}}catch(e){if(!this.lax)throw e}return assignment},Parser.prototype.parseRuleset=function(){var t,selectors,statements,block,scanner=this.scanner;return t=scanner.peek(),selectors=this.parseSelectors(),block=this.parseBlock(),statements=block&&block.statements,new parse.Ruleset({selectors:selectors,statements:statements,blockDocs:block&&block.docs,lineNumber:t.lineNumber,docs:(selectors&&selectors.docs||[]).concat(scanner.flushDocs()||[]),token:t,file:scanner.currentFile})},Parser.prototype.parseSelectors=function(){var selectors;this.scanner;return selectors=this.parseSelectorSequence()},Parser.prototype.tryParseSelectors=function(){var token,scanner=this.scanner,lineNo=scanner.lineNumber,index=scanner.index,docs=scanner.docs;try{this.parseSelectors()}catch(e){this.isSelector=!1}return token=scanner.peek(),scanner.lineNumber=lineNo,scanner.index=index,scanner.docs=docs,token},Parser.prototype.parseScopedStatement=function(){var stat,me=this,scanner=me.scanner,t=scanner.peek();return"hash"===t.type||"class"===t.type?me.parseRuleset():t&&t.isOperator&&("&"===t.value||">"===t.value||"~"===t.value||":"===t.value||"%"===t.value)?me.parseRuleset():"variable"===t.type?me.parseVariableAssignment():"directive"===t.type?(stat=me.parseDirective(),t=scanner.peek(),t&&t.isOperator&&";"===t.value&&scanner.next(),stat):t&&t.isOperator&&"-"===t.value?me.parseDeclaration():"ident"===t.type||"number"===t.type||"percentage"===t.type||t.isOperator&&"}"!==t.value?(t=me.tryParseSelectors(),t&&t.isOperator&&"{"===t.value?me.parseRuleset():me.parseDeclaration()):void 0},Parser.prototype.parseDeclaration=function(){var t,me=this,scanner=me.scanner,decl=new parse.Declaration({property:"",docs:scanner.flushDocs(),lineNumber:scanner.lineNumber,token:t,file:scanner.currentFile});if(t=scanner.next(),t&&t.isOperator&&("*"===t.value||"-"===t.value)&&(decl.property=t.value,t=scanner.next(),t&&"hash"===t.type&&(t.type="ident")),t&&"ident"===t.type)return decl.property+=t.value,scanner.expect(":"),"filter"===decl.property||"-ms-filter"===decl.property||"_filter"===decl.property?decl.value=me.parseFilterValue():decl.value=me.parseValue(),t=scanner.peek(),void 0!==t&&t.isOperator&&"!"===t.value&&(scanner.next(),t=scanner.next(),"ident"===t.type&&"important"===t.value&&(decl.important=!0)),t=scanner.peek(),void 0!==t&&t.isOperator&&";"===t.value&&scanner.next(),decl;var message="Property declaration: expected identifier but saw "+JSON.stringify(t)+" instead : "+scanner.lineNumber+":"+(scanner.index-scanner.start);Fashion.error(message),Fashion.raiseAt(message,scanner)},Parser.prototype.parseValue=function(){var t,stat,sequence,ruleset,scanner=this.scanner,statements=[];if(sequence=this.parseSequence(),t=scanner.peek(),t&&t.isOperator&&"{"==t.value){for(scanner.next();null!=(stat=this.parseScopedStatement());)statements.push(stat);scanner.expect("}"),ruleset=new parse.Ruleset({statements:statements,selectors:[],lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})}return ruleset&&(sequence.items?sequence.items.push(ruleset):sequence=sequence?new parse.List({items:[sequence,ruleset],separator:" "}):ruleset),sequence},Parser.prototype.parseFilterFunctionCall=function(){var t,pos,scanner=this.scanner;if(t=scanner.peek(),void 0!==t&&"ident"==t.type&&("progid"==t.value||"chroma"==t.value)){for(pos=scanner.index;;)if(t=scanner.next(),t&&t.isOperator&&")"===t.value)break;return new parse.Constant({value:this.style.substring(pos,scanner.index).replace(/\r/g,"").replace(/\n/g,"").replace(/\s+/g," ").trim(),dataType:"Literal",lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})}},Parser.prototype.parseFilterValue=function(){for(var t,args,scanner=this.scanner,value=[],separator=" ";;)if(debug("parse filter value"),t=scanner.peek(),","!=t.value){if(void 0===t)break;if("ident"!=t.type||"progid"!=t.value&&"chroma"!=t.value){if(t.isOperator&&(";"===t.value||"{"===t.value||"!"===t.value||"}"===t.value))break;if(args=this.parseSequence(),args.items?(separator=args.separator,args=args.items):args=[args],0===args.length)break;1===args.length?value.push(args[0]):value.push.apply(value,args)}else value.push(this.parseFilterFunctionCall())}else separator=",",scanner.next();if(0===value.length)return null;for(;1===value.length;)value=value[0];return value.length&&(value=new parse.List({items:value,separator:separator})),value},Parser.prototype.parseExpression=function(){var id,scanner=this.scanner,t=scanner.peek();if("ident"===t.type){if(t=scanner.peek(2),t&&t.isOperator)switch(t.value){case"=":case"~=":case"|=":case"^=":case"$=":case"*=":return id=scanner.next().value,scanner.expect(t.value),new parse.Assignment({id:id,expr:this.parseRelational(),operator:t.value,lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})}}else if(t&&t.isOperator&&"!"===t.value){var t2=scanner.peek(2);if(t2&&"important"===t2.value)return t=scanner.next(),t=scanner.next(),new parse.Constant({value:"!important",dataType:"Literal",lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})}return this.parseDisjunction()},Parser.prototype.parseDisjunction=function(){var factor,or,t,scanner=this.scanner;for(or=this.parseConjunction(),factor=or;;){if(debug("parse disjunction"),t=scanner.peek(),!t||!t.isOperator||"or"!==t.value||this.isSelector)break;if(t=scanner.next(),or=this.parseConjunction(),void 0===or)break;factor=new parse.BinaryExpression({operator:"or",left:factor,right:or,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})}return factor},Parser.prototype.parseConjunction=function(){var or,and,t,scanner=this.scanner;for(and=this.parseComplement(),or=and;;){if(debug("parse conjunction"),t=scanner.peek(),!t||!t.isOperator||"and"!==t.value||this.isSelector)break;if(t=scanner.next(),and=this.parseComplement(),void 0===and)break;or=new parse.BinaryExpression({operator:"and",left:or,right:and,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})}return or},Parser.prototype.parseComplement=function(){var t,scanner=this.scanner;if(t=scanner.peek(),t&&t.isOperator&&"not"===t.value){if(this.isSelectorParen)return scanner.next(),new parse.Constant({dataType:"Literal",value:"not",lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile});if(!this.isSelector)return scanner.next(),new parse.UnaryExpression({operator:"not",expr:this.parseRelational(),lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})}return this.parseRelational()},Parser.prototype.parseRelational=function(){var cmp,expr,t,scanner=this.scanner;for(cmp=this.parseAdditive(),expr=cmp;;){if(debug("parse relational"),t=scanner.peek(),!t||!t.isOperator||"=="!==t.value&&"!="!==t.value&&"<"!==t.value&&"<="!==t.value&&">="!==t.value&&(">"!==t.value||this.isSelector))break;if(t=scanner.next(),cmp=this.parseAdditive(),void 0===cmp)break;expr=new parse.BinaryExpression({operator:t.value,left:expr,right:cmp,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})}return expr},Parser.prototype.parseAdditive=function(){var term,cmp,t,scanner=this.scanner;for(term=this.parseMultiplicative(),cmp=term;;){if(debug("parse additive"),t=scanner.peek(),!t||!t.isOperator||"+"!==t.value&&"-"!==t.value||this.isSelector)break;if(t=scanner.next(),term=this.parseMultiplicative(),void 0===term)break;cmp=new parse.BinaryExpression({operator:t.value,left:cmp,right:term,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})}return cmp},Parser.prototype.parseMultiplicative=function(){var term,factor,t;for(factor=this.parsePrimary(),term=factor;;){if(debug("parse multiplicative"),t=this.scanner.peek(),!t||!t.isOperator||"*"!==t.value&&"/"!==t.value&&("%"!==t.value||this.isSelector))break;if(t=this.scanner.next(),factor=this.parsePrimary(),void 0===factor)break;term=new parse.BinaryExpression({operator:t.value,left:term,right:factor,docs:this.scanner.flushDocs()})}return term},Parser.prototype.parsePrimary=function(){var t,t2,scanner=this.scanner;return t=scanner.peek(),t2=scanner.peek(2),void 0!==t?t&&t.isOperator&&"("===t.value?this.parseParenthetical():"ident"===t.type?this.keywords[t.value]?(scanner.next(),new parse.Constant({value:t.value,dataType:"Literal",lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})):"progid"===t.value&&":"===t2.value?this.parseFilterFunctionCall():this.parseFunctionCall():"variable"===t.type?(t=scanner.next(),t.negate?new parse.BinaryExpression({operator:"-",right:new parse.Variable({name:t.value,lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile}),docs:scanner.flushDocs(),token:t,file:scanner.currentFile}):new parse.Variable({name:t.value,lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})):t=this.parseConstant():void 0},Parser.prototype.parseParenthetical=function(){var expr,scanner=this.scanner,t=scanner.next(),selWas=this.isSelector,parWas=this.isParenthetical,selParWas=this.isSelectorParen;return this.isSelector=!1,this.isParenthetical=!0,this.isSelectorParen=selWas,expr=this.isSelector?this.parseSelectorSequence(!0):this.parseSequence(),this.isSelector=selWas,this.isParenthetical=parWas,this.isSelectorParen=selParWas,scanner.expect(")"),expr&&expr.isKVP&&(expr=new parse.List({items:[expr],separator:", "})),new parse.Parenthetical({expr:expr,lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})},Parser.prototype.parseFunctionCall=function(allowSpaceBeforeParen){var end,prev,temp,scanner=this.scanner,t=scanner.next(),id=t.value,start=scanner.index,ch="",args=[],passThroughNames={expression:1,calc:1,"-moz-calc":1,"-webkit-calc":1,"-ms-calc":1};if(t=scanner.peek(),void 0!==t&&(prev=scanner.style.charAt(start),t.isOperator&&"("===t.value&&(" "!==prev||allowSpaceBeforeParen))){if(scanner.next(),t=scanner.peek(),id in passThroughNames){start=scanner.index,end=start;for(var parenCount=0;;){if(debug("parsing function call"),ch=scanner.style.charAt(end),end+=1,"("===ch&&parenCount++,void 0===ch||!ch){end=start;break}if(")"===ch){if(0===parenCount)break;parenCount--}}if(debug("done parsing function call"),end!=start)return scanner.index=end,args.push(new parse.Constant({value:scanner.style.substring(start,end-1),dataType:"Literal"})),new parse.FunctionCall({id:id,args:args,lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})}else if(("url"===id||"url-prefix"===id)&&t&&(!t.isOperator||"/"===t.value)&&"string"!==t.type){start=scanner.index,end=start;for(var ch2,tpl=0;;){if(ch=scanner.style.charAt(end),ch2=scanner.style.charAt(end+1),"#"===ch&&"{"===ch2&&tpl++,"}"===ch){if(!tpl){end=start;break}tpl--}if(("("===ch||"$"==ch)&&!tpl){end=start;break}if("+"===ch&&!tpl&&scanner.style.indexOf("data:",start)!=start&&scanner.style.indexOf("http:",start)!=start){end=start;break}if(void 0===ch||")"===ch)break;if(!ch){end=start;break}end+=1}if(end!=start)return scanner.index=end,args.push(new parse.Constant({value:scanner.style.substring(start,end),dataType:"String",quoteChar:""})),scanner.next(),new parse.FunctionCall({id:id,args:args,lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})}return temp=!t||"operator"===t.type&&")"===t.value?args:this.isSelector?this.parseSelectorSequence():this.parseArguments(),t=scanner.peek(),scanner.expect(")"),new parse.FunctionCall({id:id,args:temp,lineNumber:t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})}return new parse.Constant({value:id,dataType:"Literal",lineNumber:t&&t.lineNumber,docs:scanner.flushDocs(),token:t,file:scanner.currentFile})},Parser.prototype.parseSelectorPart=function(){var t,scanner=this.scanner;if(t=scanner.peek()){if("class"===t.type)return t=scanner.next(),new parse.SelectorPart({selectorType:"class",value:new parse.Constant({dataType:"Literal",value:t.value})});if("hash"===t.type)return t=scanner.next(),new parse.SelectorPart({selectorType:"id",value:new parse.Constant({dataType:"Literal",value:t.value})});if(t.isOperator)switch(t.value){case"and":return scanner.next(),new parse.SelectorPart({selectorType:"and",value:new parse.Constant({type:"Constant",dataType:"Literal",value:t.value})});case"or":return scanner.next(),new parse.SelectorPart({selectorType:"or",value:new parse.Constant({dataType:"Literal",value:t.value})});case"*":return scanner.next(),new parse.SelectorPart({selectorType:"wildcard",value:new parse.Constant({dataType:"Literal",value:t.value})});case"!":return scanner.next(),new parse.SelectorPart({selectorType:"bang",value:new parse.Constant({dataType:"Literal",value:t.value})});case"|":return scanner.next(),new parse.SelectorPart({selectorType:"pipe",value:new parse.Constant({dataType:"Literal",value:t.value})});case">":return scanner.next(),new parse.SelectorPart({selectorType:"direct",value:new parse.Constant({dataType:"Literal",value:t.value})});case"+":return scanner.next(),new parse.SelectorPart({selectorType:"after",value:new parse.Constant({dataType:"Literal",value:t.value})});case"~":return scanner.next(),new parse.SelectorPart({selectorType:"before",value:new parse.Constant({dataType:"Literal",value:t.value})});case"&":return scanner.next(),new parse.SelectorPart({selectorType:"parent",value:new parse.Constant({dataType:"Literal",value:t.value})});case"-":scanner.next();var expr=this.parseSelectorPart();return new parse.SelectorPart({selectorType:"dash",value:expr});case"%":scanner.next();var expr=this.parseSelectorPart();return new parse.SelectorPart({selectorType:"placeholder",value:expr});case"[":scanner.next();var expr=this.parseSelectorPart();return scanner.expect("]"),new parse.SelectorPart({selectorType:"attribute",value:expr});case":":t=scanner.next();var idx=scanner.index;if(t=scanner.peek(),t&&"{"===t.value||" "===scanner.style.charAt(idx))return;return new parse.SelectorPart({selectorType:"pseudo",value:this.parseSelectorPart()});case"not":return new parse.SelectorPart({selectorType:"not",value:this.parseFunctionCall()})}}return this.parseExpression()},Parser.prototype.parseSequence=function(){for(var arg,t,scanner=this.scanner,args=[];;){if(debug("parse sequence"),arg=this.parseTuple(),void 0===arg)break;if(args.push(arg),t=scanner.peek(),void 0===t)break;if(":"===t.value&&(scanner.next(),arg=this.parseTuple(),arg.variable=args.pop(),arg.isKVP=!0,args.push(arg),t=scanner.peek()),"operator"!==t.type||","!==t.value)break;scanner.next()}return 1===args.length?args[0]:new parse.List({items:args,separator:", ",docs:scanner.flushDocs(),token:t,file:scanner.currentFile})},Parser.prototype.parseSelectorSequence=function(isParenthetical){for(var arg,t,t2,scanner=this.scanner,args=[],sequence=new parse.SelectorList({items:args,separator:", "});;){if(debug("parse sequence"),arg=this.parseSelectorTuple(),void 0===arg)break;if(!arg||arg.items&&!arg.items.length||args.push(arg),t=scanner.peek(),void 0===t)break;if(":"===t.value&&isParenthetical&&(t2=scanner.peek(2),t&&"{"!==t.value&&";"!==t.value&&(scanner.next(),arg=new parse.SelectorProperty({property:args.pop(),value:this.parseSelectorTuple()}),args.push(arg),t=scanner.peek())),"operator"!==t.type||","!==t.value)break;scanner.next()}return 1===args.length?args[0]:sequence},Parser.prototype.parseSelectorTuple=function(){var expr,t,idx,ch,last,scanner=this.scanner,separator=" ",exprs=[],selectorWas=this.isSelector;for(this.isSelector=!0;;){if(debug("parse selector tuple"),t=scanner.peek(),void 0===t)break;if(idx=scanner.index,last=exprs[exprs.length-1],expr=this.parseSelectorPart(),void 0===expr){scanner.index=idx;break}if(ch=scanner.style.charAt(idx)," "!==ch&&"	"!==ch&&"\r"!==ch&&"\n"!==ch)if(last)if("CompoundSelector"!==last.type)last=new parse.CompoundSelector({separator:"",items:[last,expr]}),exprs[exprs.length-1]=last;else{var items=last.items;items.push(expr)}else exprs.push(expr);else exprs.push(expr)}return this.isSelector=selectorWas,1===exprs.length?exprs[0]:new parse.MultiPartSelector({
items:exprs,separator:separator})},Parser.prototype.parseTuple=function(){for(var expr,t,idx,ch,last,scanner=this.scanner,separator=" ",exprs=[];;){if(debug("parse tuple"),t=scanner.peek(),void 0===t)break;if(idx=scanner.index,last=exprs[exprs.length-1],expr=this.parseExpression(),void 0===expr)break;if(ch=scanner.style.charAt(idx)," "!==ch&&"	"!==ch&&"\r"!==ch&&"\n"!==ch)if(last)if("List"!==last.type)last=new parse.List({separator:"",items:[exprs.pop(),expr]}),exprs.push(last);else{var items=last.items;items.push(expr)}else exprs.push(new parse.List({separator:"",items:[expr]}));else exprs.push(expr)}return 1===exprs.length?(exprs=exprs[0],exprs.items&&1===exprs.items.length?exprs.items[0]:exprs):exprs.length?new parse.List({items:exprs,separator:separator}):void 0},Parser.prototype.parseArguments=function(){for(var arg,t,scanner=this.scanner,args=[];;){if(debug("parse arguments"),arg=this.parseArgument(),void 0===arg)break;if(args.push(arg),t=scanner.peek(),void 0===t)break;if("operator"!==t.type||","!==t.value)break;scanner.next()}return new parse.List({items:args,separator:", ",docs:scanner.flushDocs(),token:t,file:scanner.currentFile})},Parser.prototype.parseVarArgs=function(expr){var t,t2,t3,scanner=this.scanner;return t=scanner.peek(),t&&"."===t.value&&(t2=scanner.peek(2),t3=scanner.peek(3),t2&&"."===t2.value&&t3&&"."===t3.value&&(expr.varArgs=!0,scanner.next(),scanner.next(),scanner.next())),expr},Parser.prototype.parseArgument=function(){for(var expr,t,scanner=this.scanner,arg=[];;){if(debug("parse argument"),t=scanner.peek(),void 0===t)break;if("variable"!==t.type&&"identifier"!==t.type||(t=scanner.peek(2),!t||!t.isOperator||":"!==t.value)){if(expr=this.parseExpression(),void 0===expr)break;this.parseVarArgs(expr),arg.push(expr)}else t=scanner.next(),scanner.next(),expr=this.parseTuple(),expr&&(expr.variable=t.value),arg.push(expr)}return 1==arg.length?arg[0]:new parse.List({items:arg,separator:" "})},Parser.prototype.parse=function(content,file){var scanner,me=this;me.scanner=scanner=new Fashion.parse.Scanner(content,file),me.style=scanner.style;var result=me.parseStylesheet();return me.scanner=me.style=null,result},Parser}(Fashion.Base);parse.Parser=Parser}(parse=Fashion.parse||(Fashion.parse={}))}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var Context=function(_super){function Context(config){_super.call(this,config),this._fnMap={},this.runtime=this.runtime||new Fashion.Runtime({context:this}),this.preprocessor=this.preprocessor||new Fashion.Preprocessor({runtime:this.runtime}),this.transpiler=this.transpiler||new Fashion.Transpiler({preprocessor:this.preprocessor})}return __extends(Context,_super),Context.prototype.convert=function(ast,file){var node,parser,jsCode,transpiler=this.transpiler;return"string"==typeof ast?(parser=new Fashion.parse.Parser,node=parser.parse(ast,file)):node=ast,this.preprocessor.preprocess(node),jsCode=this.transpiler.transpile(node),this.runtime.docCache=this.transpiler.docCache,this.runtime.stringCache=this.transpiler.stringCache,this.lastVariables=transpiler.variables,jsCode},Context.prototype.getVariables=function(){return this.lastVariables},Context.prototype.compile=function(jsCode){return this.func=this.runtime.compile(jsCode)},Context.prototype.getFunc=function(){return this.func},Context.prototype.run=function(code){return this.runtime.run(code)},Context.prototype.parseSelectors=function(selector){var fn=this._fnMap[selector],runtime=this.runtime;if(!fn){var ast,jsCode,parsedSelectors,parser=new Fashion.parse.Parser,transpiler=new Fashion.Transpiler;parser.scanner=new Fashion.parse.Scanner(selector),parser.style=parser.scanner.style,ast=parser.parseSelectors(),jsCode=transpiler.transpile(ast,!0),jsCode="return "+jsCode+";",fn=runtime.createWrappedFn(jsCode),this._fnMap[selector]=fn}return parsedSelectors=runtime.callWrappedFn(fn,{})},Context.prototype.getConfig=function(name){return this[name]},Context.prototype.setConfig=function(name,value){if("string"==typeof name){var prev=this[name];return this[name]=value,prev}return Fashion.apply(this,name),null},Context}(Fashion.Base);Fashion.Context=Context}(Fashion||(Fashion={}));var Fashion;!function(Fashion){var Builder=function(_super){function Builder(config){_super.call(this,config),this.scripts={},Fashion.lastBuilder=this,this.context=new Fashion.Context(this.context),this.context.libraries=this.context.libraries||{compass:"../lib/compass/stylesheets/",blueprint:"../lib/blueprint/stylesheets/"}}return __extends(Builder,_super),Builder.prototype.getContext=function(){return this.context},Builder.prototype.compile=function(scss){var context=this.getContext(),jsCode=context.convert(scss),fn=context.compile(jsCode),css=fn();return css},Builder.prototype.createSetters=function(vars){var varName,setters="";if("string"==typeof vars)setters=vars;else for(varName in vars)setters+=varName+": dynamic("+vars[varName]+");\n";return setters},Builder.prototype.createVarsScope=function(vars){var setterAst,setterVariables,sortedAst,settersCode,settersFunc,newGlobals,context=this.context,parser=new Fashion.parse.Parser,preprocessor=new Fashion.Preprocessor({runtime:context.runtime}),newContext=new Fashion.Context({runtime:context.runtime,preprocessor:preprocessor}),setters=this.createSetters(vars),allVariables=Fashion.chain(context.getVariables());return setterAst=parser.parse(setters),preprocessor.preprocess(setterAst,!0),preprocessor.loadPreprocessorCache(context.preprocessor),setterVariables=preprocessor.getVariables(),Fashion.apply(allVariables,setterVariables),preprocessor.variables=allVariables,context.dynamicsMap=preprocessor.getDynamicsMap(),sortedAst=preprocessor.getSortedDynamicAstNodes(),settersCode=newContext.convert(sortedAst),settersFunc=newContext.compile(settersCode),settersFunc(context.runtime,null,context.dynamicsMap),newGlobals=context.runtime.getGlobalScope()},Builder.prototype.rebuildCss=function(vars){var css,context=this.context,func=context.getFunc();return css=func(context.runtime,vars,context.dynamicsMap)},Builder.prototype.build=function(file,callback){var context,sassFile,split,vars,me=this;"string"!=typeof file&&(split=file.split,me.compressed=file.compress,vars=file.variables,file=file.path),context=me.getContext(),sassFile=me.getSassFile(file),sassFile.invalidate(),sassFile.onReady(function(){Fashion.log("Building "+file);try{var ast=sassFile.getExpandedAst(),converted=context.convert(ast),func=context.compile(converted),css=func();if(vars){var scope=me.createVarsScope(vars);css=me.rebuildCss(scope)}css.getText(function(cssContent){callback&&callback(cssContent),Fashion.log("Build complete for "+file)},me.compressed,me.indent,me.skipComments,split)}catch(error){Fashion.log("Build error for "+file);var message=error+"";console.trace(),Fashion.error(message),callback&&callback(["/* "+message+" */"],message)}})},Builder.prototype.getSassFile=function(path,relPath,origSource,importer){var script,scripts=this.scripts;return path=this.getSassFilePath(path,relPath),script=scripts[path],script||(script=new Fashion.SassFile({path:path,builder:this,originalSource:origSource,importer:importer}),scripts[path]=script),script},Builder.prototype.getSassFilePath=function(path,relPath){return relPath&&(path=this.getPath(path,relPath)),path=path.replace(/\\/g,"/"),path=this.resolveUrl(path)},Builder.prototype.getParser=function(){return new Fashion.parse.Parser},Builder.prototype.getPath=function(baseFile,relPath){if(relPath){var root,libpath,separatorIndex=relPath.indexOf("/"),libraryPaths=this.context.libraries;if(0!==separatorIndex&&(root=-1===separatorIndex?relPath:relPath.substring(0,-1!==separatorIndex?separatorIndex:relPath.length),libpath=libraryPaths[root]))return this.calcPath(libpath,relPath)}return this.calcPath(baseFile,relPath)},Builder.prototype.calcPath=function(baseFile,relPath){var path,sep=baseFile.lastIndexOf("/");return path=sep>-1?baseFile.substring(0,sep+1)+relPath:baseFile+"/"+relPath,-1===path.indexOf(".scss")&&-1===path.indexOf(".js")&&(path+=".scss"),path},Builder.prototype.getResolverEl=function(){return this.resolverEl||(this.resolverEl=document.createElement("a")),this.resolverEl},Builder.prototype.getCanonicalPath=function(path){var part,p,parts=path.split("/"),out=[];for(p=0;p<parts.length;p++)part=parts[p],"."!=part&&(".."==part?(0===out.length&&Fashion.raise("bad path for getCanonicalPath : "+path),out.pop()):out.push(part));return out.join("/")},Builder.prototype.resolveUrl=function(path){if(path=path.replace(/\\/g,"/"),Fashion.Env.isBrowser){var resolverEl=this.getResolverEl();return resolverEl.href=path,resolverEl.href}return path=this.getCanonicalPath(path)},Builder.prototype.createStyleEl=function(href,content,before){var styleEl,ieMode,head=document.getElementsByTagName("head")[0],base=document.createElement("base");return Fashion.log("Using base href : "+href),base.href=href,head.firstChild?head.insertBefore(base,head.firstChild):head.appendChild(base),base.href=base.href,styleEl=document.createElement("style"),styleEl.type="text/css",ieMode="styleSheet"in styleEl,ieMode?(before?head.insertBefore(styleEl,before):head.appendChild(styleEl),styleEl.styleSheet.cssText=content):(styleEl.textContent=content,before?head.insertBefore(styleEl,before):head.appendChild(styleEl)),head.removeChild(base),styleEl},Builder.prototype.injectCss=function(cssPath,cssContent){var _this=this;this.lastCssPath=cssPath,Array.isArray(cssContent)||(cssContent=[cssContent]),cssPath=this.resolveUrl(cssPath);var me=this,currEls=me.styleEls||[],href=cssPath.substring(0,cssPath.lastIndexOf("/")+1);me.styleEls=[],cssContent.forEach(function(content,idx){content+="\n/*# sourceURL="+cssPath+"_"+idx+" */";var before=currEls.length&&currEls[0]||null,styleEl=_this.createStyleEl(href,content,before);me.styleEls.push(styleEl)});var head=document.getElementsByTagName("head")[0];currEls.forEach(function(el){head.removeChild(el)})},Builder}(Fashion.Base);Fashion.Builder=Builder}(Fashion||(Fashion={}));
//# sourceMappingURL=fashion-min.js.map
